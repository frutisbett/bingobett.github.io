<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BingoBett</title>
  <style>
    body {
      font-family: sans-serif;
      background: #111;
      color: #fff;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    .replenish-buttons {
      margin: 15px 0;
      display: flex;
      justify-content: center;
      gap: 10px;
      flex-wrap: wrap;
    }
    .replenish-btn {
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      background: #f9c74f;
      color: #000;
      cursor: pointer;
    }
    #freeSpinsDisplay {
      font-size: 18px;
      margin: 10px;
    }
    #balanceDisplay {
      font-size: 24px;
      margin: 10px;
    }
    .slot-machine {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 10px;
      justify-content: center;
      margin: 20px auto;
      width: fit-content;
    }
    .slot {
      font-size: 40px;
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #222;
      border: 2px solid #444;
      border-radius: 10px;
      transition: all 0.3s;
    }
    .win {
      background: gold;
      color: black;
      box-shadow: 0 0 15px 5px gold;
    }
    .big-win {
      animation: bigWin 1s infinite;
    }
    @keyframes bigWin {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }
    .controls {
      margin: 20px;
    }
    .controls button {
      margin: 5px;
    }
    #miniGameOverlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.9);
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    #miniGameOverlay .box {
      width: 80px;
      height: 80px;
      font-size: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #444;
      margin: 10px;
      cursor: pointer;
      transition: 0.3s;
    }
    #miniGameOverlay .win {
      background: #f9c74f;
    }
    #miniGameOverlay .lose {
      background: #e55;
    }
    #miniGameOverlay .selected {
      transform: scale(1.2);
    }
    #botChat {
      max-height: 150px;
      overflow-y: auto;
      border-top: 1px solid #444;
      margin: 10px;
    }
    .bot-message {
      margin: 5px 0;
    }
  </style>
</head>
<body>

  <!-- Ğ¡Ñ‡Ñ‘Ñ‚Ñ‡Ğ¸Ğº Ñ„Ñ€Ğ¸ÑĞ¿Ğ¸Ğ½Ğ¾Ğ² -->
  <div id="freeSpinsDisplay">Ğ¤Ñ€Ğ¸ÑĞ¿Ğ¸Ğ½Ñ‹: 55</div>

  <!-- Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ -->
  <div id="balanceDisplay">100.00 â‚½</div>

  <!-- ĞšĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ¿Ğ¾Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ -->
  <div class="replenish-buttons">
    <button class="replenish-btn" data-amount="50">50 â‚½</button>
    <button class="replenish-btn" data-amount="300">300 â‚½</button>
    <button class="replenish-btn" data-amount="500">500 â‚½</button>
    <button class="replenish-btn" data-amount="800">800 â‚½</button>
    <a id="replenishLink" href="#" target="_blank" style="display: none;">ĞĞ¿Ğ»Ğ°Ñ‚Ğ¸Ñ‚ÑŒ</a>
  </div>

  <!-- Ğ¡Ğ»Ğ¾Ñ‚Ñ‹ -->
  <div class="slot-machine" id="slotMachine"></div>

  <!-- ĞšĞ½Ğ¾Ğ¿ĞºĞ¸ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ -->
  <div class="controls">
    <button id="spinButton">Ğ’Ñ€Ğ°Ñ‰Ğ°Ñ‚ÑŒ ğŸ°</button>
    <button id="autoSpinButton">ĞĞ²Ñ‚Ğ¾ÑĞ¿Ğ¸Ğ½ â–¶ï¸</button>
    <button id="stopAutoSpinButton" style="display:none;">Ğ¡Ñ‚Ğ¾Ğ¿ Ğ°Ğ²Ñ‚Ğ¾ÑĞ¿Ğ¸Ğ½ â¹</button>
  </div>

  <!-- ĞœĞ¸Ğ½Ğ¸-Ğ¸Ğ³Ñ€Ğ° -->
  <div id="miniGameOverlay">
    <div class="box" data-box="1">ğŸ</div>
    <div class="box" data-box="2">ğŸ</div>
    <div class="box" data-box="3">ğŸ</div>
    <div id="miniGameMsg"></div>
    <button id="closeMiniGame" style="margin-top: 10px; display: none;">Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚ÑŒ</button>
  </div>

  <!-- Ğ‘Ğ¾Ñ‚-Ñ‡Ğ°Ñ‚ -->
  <div id="botChat"></div>

  <script src="https://telegram.org/js/telegram-web-app.js "></script>
  <script>
    const Telegram = window.Telegram.WebApp;
    Telegram.ready();

    // --- ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¸Ğ³Ñ€Ñ‹ ---
    let balance = 100;
    let betAmount = 10;
    let lastWin = 0;
    let autoSpinActive = false;
    let autoSpinTimer = null;
    let miniGameActive = false;

    const balanceDisplay = document.getElementById('balanceDisplay');
    const slotMachine = document.getElementById('slotMachine');
    const botChat = document.getElementById('botChat');
    const spinButton = document.getElementById('spinButton');
    const autoSpinButton = document.getElementById('autoSpinButton');
    const stopAutoSpinButton = document.getElementById('stopAutoSpinButton');
    const freeSpinsDisplay = document.getElementById('freeSpinsDisplay');

    // --- ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° URL Ğ½Ğ° Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ğµ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ° ---
    const urlParams = new URLSearchParams(window.location.search);
    const amountToReplenish = urlParams.get('replenish');

    if (amountToReplenish && !localStorage.getItem('processedReplenish')) {
      balance += parseFloat(amountToReplenish);
      updateUI();
      localStorage.setItem('processedReplenish', 'true');
      alert(`Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ Ğ¿Ğ¾Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½ Ğ½Ğ° ${amountToReplenish} â‚½`);
    }

    window.addEventListener('beforeunload', () => {
      localStorage.removeItem('processedReplenish');
    });

    // --- Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ñ„Ñ€Ğ¸ÑĞ¿Ğ¸Ğ½Ğ¾Ğ² ---
    const registrationTimestamp = localStorage.getItem('registrationTimestamp');
    if (!registrationTimestamp) {
      localStorage.setItem('registrationTimestamp', Date.now());
      localStorage.setItem('freeSpins', 55);
    }

    function isFreeSpinsExpired() {
      const registrationTime = Number(localStorage.getItem('registrationTimestamp'));
      const currentTime = Date.now();
      const expirationPeriod = 23 * 60 * 60 * 1000;
      return (currentTime - registrationTime) > expirationPeriod;
    }

    function hasAvailableFreeSpins() {
      const remainingSpins = Number(localStorage.getItem('freeSpins')) || 55;
      return remainingSpins > 0 && !isFreeSpinsExpired();
    }

    // --- ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑÑ‡Ñ‘Ñ‚Ñ‡Ğ¸ĞºĞ° Ñ„Ñ€Ğ¸ÑĞ¿Ğ¸Ğ½Ğ¾Ğ² ---
    function updateFreeSpinsDisplay() {
      const remainingSpins = Number(localStorage.getItem('freeSpins')) || 55;
      if (freeSpinsDisplay) {
        freeSpinsDisplay.textContent = `Ğ¤Ñ€Ğ¸ÑĞ¿Ğ¸Ğ½Ñ‹: ${remainingSpins}`;
      }
    }

    updateFreeSpinsDisplay();

    // --- ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ¸ Ğ¿Ğ¾Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ ---
    document.querySelectorAll('.replenish-btn').forEach(btn => {
      btn.onclick = function () {
        const amount = this.dataset.amount;
        const receiver = '4100118182998706'; // Ğ²Ğ°Ñˆ ĞºĞ¾ÑˆĞµĞ»Ñ‘Ğº
        const redirectUrl = encodeURIComponent(`https://t.me/frutis_bingo_bett_bot/startapp?replenish=${amount}`);
        const paymentUrl = ` https://yoomoney.ru/quickpay/confirm.xml?receiver=${receiver}&quickpay-form=small&sum=${amount}&paymentType=AC&successURL=${redirectUrl}`;

        const link = document.getElementById('replenishLink');
        link.href = paymentUrl;
        link.click();
      };
    });

    // --- ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ° ---
    function updateUI() {
      balanceDisplay.textContent = `${balance.toFixed(2)} â‚½`;
      localStorage.setItem('slotBalance', balance);
    }

    // --- Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ÑĞ»Ğ¾Ñ‚Ğ¾Ğ² ---
    const rows = 1;
    const columns = 5;
    const reels = [
      ["ğŸ’", "ğŸ‹", "ğŸŠ", "ğŸ‰", "ğŸ‡", "ğŸ“", "ğŸ", "ğŸ¥", "ğŸŒ", "ğŸ¥¥", "ğŸ", "ğŸ’"],
      ["ğŸ‹", "ğŸŠ", "ğŸ‰", "ğŸ‡", "ğŸ“", "ğŸ", "ğŸ¥", "ğŸŒ", "ğŸ¥¥", "ğŸ", "ğŸ’", "ğŸ’"],
      ["ğŸŠ", "ğŸ‰", "ğŸ‡", "ğŸ“", "ğŸ", "ğŸ¥", "ğŸŒ", "ğŸ¥¥", "ğŸ", "ğŸ’", "ğŸ’", "ğŸ‹"],
      ["ğŸ‰", "ğŸ‡", "ğŸ“", "ğŸ", "ğŸ¥", "ğŸŒ", "ğŸ¥¥", "ğŸ", "ğŸ’", "ğŸ’", "ğŸ‹", "ğŸŠ"],
      ["ğŸ‡", "ğŸ“", "ğŸ", "ğŸ¥", "ğŸŒ", "ğŸ¥¥", "ğŸ", "ğŸ’", "ğŸ’", "ğŸ‹", "ğŸŠ", "ğŸ‰"]
    ];

    function createSlots() {
      slotMachine.innerHTML = '';
      for (let row = 0; row < rows; row++) {
        for (let col = 0; col < columns; col++) {
          const slot = document.createElement('div');
          slot.classList.add('slot');
          slot.textContent = "â“";
          slotMachine.appendChild(slot);
        }
      }
    }

    createSlots();

    // --- ĞĞ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ²Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ñ ---
    function spinWithAnimation(callback) {
      if (miniGameActive) {
        if (callback) callback();
        return;
      }

      if (balance < betAmount) {
        alert('ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ ÑÑ€ĞµĞ´ÑÑ‚Ğ² Ğ´Ğ»Ñ ÑĞ¿Ğ¸Ğ½Ğ°!');
        stopAutoSpin();
        if (callback) callback();
        return;
      }

      balance -= betAmount;
      updateUI();

      const slots = document.querySelectorAll('.slot');
      const stopPositions = [];
      for (let col = 0; col < columns; col++) {
        stopPositions[col] = Math.floor(Math.random() * reels[col].length);
      }

      let spinDuration = 1200;
      let startTime = performance.now();

      function animate(currentTime) {
        let elapsed = currentTime - startTime;
        let progress = Math.min(elapsed / spinDuration, 1);

        slots.forEach((s, i) => {
          let reel = reels[i];
          let index = Math.floor((progress * reel.length) % reel.length);
          s.textContent = reel[index];
        });

        if (progress < 1) {
          requestAnimationFrame(animate);
        } else {
          // ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ½Ğ° Ğ²Ñ‹Ğ¸Ğ³Ñ€Ñ‹ÑˆĞ½Ğ¾Ğ¹ ĞºĞ¾Ğ¼Ğ±Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸
          let winChance = Math.random();
          let totalWin = 0;

          // Ğ˜Ğ¼Ğ¸Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ²Ñ‹Ğ¸Ğ³Ñ€Ñ‹ÑˆĞ°
          if (winChance < 0.3) {
            totalWin = betAmount * (Math.random() * 5 + 1); // Ğ²Ñ‹Ğ¸Ğ³Ñ€Ñ‹Ñˆ Ğ¾Ñ‚ x1 Ğ´Ğ¾ x6
            if (totalWin > 500) totalWin = 500; // Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ğµ Ğ½Ğ° 500
            balance += totalWin;
            updateUI();
            alert(`Ğ’Ñ‹ Ğ²Ñ‹Ğ¸Ğ³Ñ€Ğ°Ğ»Ğ¸ ${totalWin.toFixed(0)} â‚½`);
          } else {
            updateUI();
            alert('ĞĞµÑ‚ Ğ²Ñ‹Ğ¸Ğ³Ñ€Ñ‹ÑˆĞ°. ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ ĞµÑ‰Ñ‘!');
          }
        }
      }

      requestAnimationFrame(animate);
    }

    // --- ĞšĞ½Ğ¾Ğ¿ĞºĞ° "Ğ’Ñ€Ğ°Ñ‰Ğ°Ñ‚ÑŒ" ---
    spinButton.onclick = function () {
      if (!hasAvailableFreeSpins()) {
        alert('Ğ’ÑĞµ Ñ„Ñ€Ğ¸ÑĞ¿Ğ¸Ğ½Ñ‹ Ğ¸ÑÑ‚ĞµĞºĞ»Ğ¸. ĞŸĞ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚Ğµ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ.');
        return;
      }

      const remainingSpins = Number(localStorage.getItem('freeSpins')) - 1;
      localStorage.setItem('freeSpins', remainingSpins);
      updateFreeSpinsDisplay();

      spinWithAnimation();
    };

    // --- ĞĞ²Ñ‚Ğ¾ÑĞ¿Ğ¸Ğ½ ---
    autoSpinButton.onclick = () => {
      autoSpinActive = true;
      autoSpinTimer = setInterval(() => {
        if (hasAvailableFreeSpins()) {
          spinWithAnimation();
          const remainingSpins = Number(localStorage.getItem('freeSpins')) - 1;
          localStorage.setItem('freeSpins', remainingSpins);
          updateFreeSpinsDisplay();
        }
      }, 2000);
      stopAutoSpinButton.style.display = '';
      autoSpinButton.style.display = 'none';
    };

    stopAutoSpinButton.onclick = () => {
      clearInterval(autoSpinTimer);
      autoSpinActive = false;
      stopAutoSpinButton.style.display = 'none';
      autoSpinButton.style.display = '';
    };

    // --- ĞœĞ¸Ğ½Ğ¸-Ğ¸Ğ³Ñ€Ğ° Ñ Ğ¿Ğ¾Ğ´Ğ°Ñ€ĞºĞ°Ğ¼Ğ¸ ---
    function showMiniGame(winAmount, callback) {
      const overlay = document.getElementById('miniGameOverlay');
      const boxes = overlay.querySelectorAll('.box');
      const msg = document.getElementById('miniGameMsg');
      const closeBtn = document.getElementById('closeMiniGame');

      overlay.style.display = 'flex';
      miniGameActive = true;
      msg.textContent = "Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¾Ğ´Ğ½Ñƒ Ğ¸Ğ· ĞºĞ¾Ñ€Ğ¾Ğ±Ğ¾Ğº:";
      closeBtn.style.display = 'none';

      boxes.forEach(box => {
        box.classList.remove('win', 'lose', 'selected');
        box.onclick = null;
        box.onclick = () => {
          box.classList.add('selected');
          const winBox = Math.floor(Math.random() * 3) + 1;
          if (parseInt(box.dataset.box) === winBox) {
            msg.textContent = `ĞŸĞ¾Ğ·Ğ´Ñ€Ğ°Ğ²Ğ»ÑĞµĞ¼! Ğ’Ñ‹ Ğ²Ñ‹Ğ¸Ğ³Ñ€Ğ°Ğ»Ğ¸: +${winAmount} â‚½`;
            balance += winAmount;
          } else {
            msg.textContent = `Ğ£Ğ²Ñ‹! Ğ’Ñ‹ Ğ¿Ğ¾Ñ‚ĞµÑ€ÑĞ»Ğ¸ Ğ¿Ğ¾Ğ»Ğ¾Ğ²Ğ¸Ğ½Ñƒ Ğ²Ñ‹Ğ¸Ğ³Ñ€Ñ‹ÑˆĞ° (-${Math.floor(winAmount / 2)} â‚½)`;
            balance -= Math.floor(winAmount / 2);
          }
          updateUI();
          closeBtn.style.display = '';
        };
      });

      closeBtn.onclick = () => {
        overlay.style.display = 'none';
        miniGameActive = false;
        if (callback) callback();
        if (autoSpinActive) spinWithAnimation();
      };
    }

    // --- Ğ‘Ğ¾Ñ‚-Ñ‡Ğ°Ñ‚ ---
    const botNames = ["ĞÑ€Ñ‚Ñ‘Ğ¼", "Ğ˜Ñ€Ğ¸Ğ½Ğ°", "ĞœĞ°ĞºÑĞ¸Ğ¼", "ĞĞ»ÑŒĞ³Ğ°", "Ğ’Ğ»Ğ°Ğ´Ğ¸Ğ¼Ğ¸Ñ€", "Ğ¡Ğ²ĞµÑ‚Ğ»Ğ°Ğ½Ğ°"];
    const botMessages = [
      "Ğ²Ñ‹Ğ¸Ğ³Ñ€Ğ°Ğ»(Ğ°) 120 â‚½!", "Ğ¿Ğ¾Ğ¹Ğ¼Ğ°Ğ»(Ğ°) Ğ±Ğ¾Ğ½ÑƒÑ!", "ÑĞ¾Ñ€Ğ²Ğ°Ğ»(Ğ°) Ğ´Ğ¶ĞµĞºĞ¿Ğ¾Ñ‚!", "Ğ¿Ñ€Ğ¾Ğ¸Ğ³Ñ€Ğ°Ğ»(Ğ°) 40 â‚½",
      "Ğ²Ñ‹Ğ¸Ğ³Ñ€Ğ°Ğ»(Ğ°) 200 â‚½!", "Ğ¿Ğ¾Ğ¿Ñ€Ğ¾Ğ±Ğ¾Ğ²Ğ°Ğ»(Ğ°) Ğ°Ğ²Ñ‚Ğ¾ÑĞ¿Ğ¸Ğ½", "Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ğ»(Ğ°) Ğ¼Ğ¸Ğ½Ğ¸-Ğ¸Ğ³Ñ€Ñƒ", "Ğ²Ñ‹Ğ¸Ğ³Ñ€Ğ°Ğ»(Ğ°) 70 â‚½",
      "ÑĞ¾Ñ€Ğ²Ğ°Ğ»(Ğ°) Ğ±Ğ°Ğ½Ğº!", "Ğ¿Ñ€Ğ¾Ğ¸Ğ³Ñ€Ğ°Ğ»(Ğ°) 20 â‚½", "Ğ²Ñ‹Ğ¸Ğ³Ñ€Ğ°Ğ»(Ğ°) 250 â‚½!", "Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ğ»(Ğ°) Ñ„Ñ€Ğ¸ÑĞ¿Ğ¸Ğ½Ñ‹",
      "Ğ²Ñ‹Ğ¸Ğ³Ñ€Ğ°Ğ»(Ğ°) 80 â‚½", "ÑĞ¾Ñ€Ğ²Ğ°Ğ»(Ğ°) ÑÑƒĞ¿ĞµÑ€-Ğ²Ñ‹Ğ¸Ğ³Ñ€Ñ‹Ñˆ!", "Ğ¿Ñ€Ğ¾Ğ¸Ğ³Ñ€Ğ°Ğ»(Ğ°) 60 â‚½",
      "Ğ²Ñ‹Ğ¸Ğ³Ñ€Ğ°Ğ»(Ğ°) 250 â‚½!", "Ğ²Ñ‹Ğ¸Ğ³Ñ€Ğ°Ğ»(Ğ°) 90 â‚½", "Ğ²Ñ‹Ğ¸Ğ³Ñ€Ğ°Ğ»(Ğ°) 150 â‚½!", "Ğ¿Ñ€Ğ¾Ğ¸Ğ³Ñ€Ğ°Ğ»(Ğ°) 10 â‚½",
      "Ğ²Ñ‹Ğ¸Ğ³Ñ€Ğ°Ğ»(Ğ°) 200 â‚½!"
    ];

    function addBotMessage() {
      const name = botNames[Math.floor(Math.random() * botNames.length)];
      const message = document.createElement('div');
      message.className = 'bot-message';
      message.innerHTML = `<span style="color:#0ff">${name}</span>: ${botMessages[Math.floor(Math.random() * botMessages.length)]}`;
      botChat.appendChild(message);
      botChat.scrollTop = botChat.scrollHeight;
    }

    // --- ĞŸĞµÑ€Ğ¸Ğ¾Ğ´Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ ---
    setInterval(() => {
      addBotMessage();
    }, 7000);

    // --- Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ---
    updateUI();
    updateFreeSpinsDisplay();
  </script>
</body>
</html>






