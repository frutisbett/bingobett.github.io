<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BingoBett - –°–ª–æ—Ç-–º–∞—à–∏–Ω–∞</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        body {
            background: #1a1a1a;
            color: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding: 10px;
            overflow-x: hidden;
            font-size: 14px;
        }

        @media (min-width: 600px) {
            body {
                font-size: 16px;
            }
        }

        .header {
            text-align: center;
            margin-bottom: 10px;
            width: 100%;
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 5px;
            color: gold;
            text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
        }

        .user-info {
            display: flex;
            justify-content: space-between;
            width: 100%;
            max-width: 500px;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .balance-info, .jackpot-info, .bet-info, .freespin-info {
            background: rgba(0, 0, 0, 0.5);
            padding: 5px 10px;
            border-radius: 15px;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
        }

        .jackpot-info {
            color: gold;
        }

        .freespin-info {
            color: #4caf50;
        }

        .replenish-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 5px;
            margin: 10px 0;
            width: 100%;
            max-width: 500px;
        }

        .replenish-btn {
            padding: 8px 12px !important;
            font-size: 3.5vw !important;
            background: #e53935 !important;
            color: white !important;
            border: none !important;
            border-radius: 5px !important;
            cursor: pointer !important;
            margin: 0 !important;
            transition: none !important;
            box-shadow: none !important;
            transform: none !important;
            min-height: auto !important;
            flex: none !important;
            max-width: none !important;
            white-space: normal !important;
            -webkit-tap-highlight-color: transparent !important;
            touch-action: manipulation !important;
        }

        @media (min-width: 600px) {
            .replenish-btn {
                font-size: 14px !important;
            }
        }

        .withdraw-btn {
            padding: 10px 20px !important;
            font-size: 4vw !important;
            background: #ff9800 !important;
            color: white !important;
            border: none !important;
            border-radius: 5px !important;
            cursor: pointer !important;
            margin: 10px !important;
            transition: none !important;
            box-shadow: none !important;
            transform: none !important;
            min-height: auto !important;
            flex: none !important;
            max-width: none !important;
            white-space: normal !important;
            -webkit-tap-highlight-color: transparent !important;
            touch-action: manipulation !important;
        }

        @media (min-width: 600px) {
            .withdraw-btn {
                font-size: 14px !important;
            }
        }

        .slot-machine {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 3px;
            width: 95vw;
            max-width: 500px;
            aspect-ratio: 5 / 4;
            margin: 10px 0;
            background: #333;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.7);
            border: 2px solid gold;
        }

        .slot {
            background: #222;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 7vw;
            border: 1px solid #444;
            position: relative;
            overflow: hidden;
        }

        @media (min-width: 600px) {
            .slot {
                font-size: 35px;
            }
        }

        /* - –ù–û–í–ê–Ø –ê–ù–ò–ú–ê–¶–ò–Ø –í–†–ê–©–ï–ù–ò–Ø –°–ò–ú–í–û–õ–û–í - */
        .slot.spinning .symbol {
            animation: symbolSpin 0.1s linear infinite;
        }

        .slot.stopping .symbol {
            animation: symbolStop 0.3s ease-out forwards;
        }

        @keyframes symbolSpin {
            0% { transform: translateY(0%); opacity: 0.7; }
            50% { transform: translateY(-50%); opacity: 0.3; }
            100% { transform: translateY(-100%); opacity: 0.7; }
        }

        @keyframes symbolStop {
            0% { transform: translateY(-100%); opacity: 0.7; }
            100% { transform: translateY(0%); opacity: 1; }
        }

        /* - –ö–û–ù–ï–¶ –ù–û–í–û–ô –ê–ù–ò–ú–ê–¶–ò–ò - */

        .slot.win {
            background-color: gold;
            color: black;
            box-shadow: 0 0 15px 5px gold;
            animation: winPulse 1s infinite alternate;
        }

        @keyframes winPulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.05); }
        }

        .slot.big-win {
            background: linear-gradient(45deg, #ff0000, #ff7300, #fffb00, #48ff00, #00ffd5, #002bff, #7a00ff, #ff00c8, #ff0000);
            background-size: 400% 400%;
            animation: rainbowGlow 2s ease infinite, winShake 0.5s infinite;
            color: white;
        }

        @keyframes rainbowGlow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes winShake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }

        .controls {
            margin: 15px 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            width: 100%;
            max-width: 500px;
        }

        button {
            padding: 12px 16px;
            font-size: 14px;
            cursor: pointer;
            border-radius: 12px;
            border: none;
            background: #4caf50;
            color: white;
            box-shadow: 0 3px #388e3c;
            transition: all 0.1s;
            min-height: 44px;
            flex: 1;
            min-width: 100px;
            max-width: 150px;
        }

        button:active {
            transform: translateY(2px);
            box-shadow: 0 1px #388e3c;
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: 0 1px #555;
        }

        .bet-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
            width: 100%;
            max-width: 500px;
            justify-content: center;
        }

        .bet-controls button {
            padding: 8px 12px;
            font-size: 14px;
            min-width: auto;
        }

        .bet-controls span {
            min-width: 80px;
            text-align: center;
        }

        .message {
            margin: 15px 0;
            min-height: 2em;
            text-align: center;
            color: #ff0;
            font-size: 14px;
            max-width: 90vw;
            word-wrap: break-word;
        }

        #botChat {
            width: 95%;
            max-width: 500px;
            height: 80px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            padding: 10px;
            margin-top: 10px;
            overflow-y: auto;
            font-size: 12px;
        }

        .bot-message {
            margin-bottom: 3px;
            color: #aaa;
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏ */
        .modal-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .username-modal {
            background: #333;
            padding: 20px;
            border-radius: 10px;
            color: white;
            min-width: 300px;
            text-align: center;
        }

        .username-modal input {
            margin: 10px 0;
            padding: 10px;
            font-size: 16px;
            border-radius: 5px;
            border: none;
            width: 200px;
        }

        .username-modal button {
            padding: 10px 20px;
            font-size: 16px;
            background: #4caf50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–≤–æ–¥–∞ */
        .withdraw-modal {
            background: #333;
            padding: 20px;
            border-radius: 10px;
            color: white;
            min-width: 300px;
            text-align: center;
        }

        .withdraw-modal input {
            margin: 10px 0;
            padding: 10px;
            font-size: 16px;
            border-radius: 5px;
            border: none;
            width: 200px;
        }

        .withdraw-modal button {
            padding: 10px 20px;
            font-size: 16px;
            background: #4caf50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }

        .withdraw-modal button.cancel {
            background: #f44336;
        }

        .withdraw-error {
            color: #ff4444;
            margin-top: 10px;
            font-size: 14px;
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∞–≤–∏–ª */
        .rules-modal {
            background: #333;
            padding: 20px;
            border-radius: 10px;
            color: white;
            min-width: 300px;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .rules-modal h3 {
            color: gold;
            text-align: center;
            margin-bottom: 15px;
        }

        .rules-modal ul {
            text-align: left;
            padding-left: 20px;
        }

        .rules-modal li {
            margin-bottom: 8px;
        }

        .rules-modal button {
            padding: 10px 20px;
            font-size: 16px;
            background: #4caf50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 15px;
        }

        /* –ú–∏–Ω–∏-–∏–≥—Ä–∞ */
        .mini-game-overlay {
            position: fixed; /* –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Å absolute */
            top: 0;
            left: 0;
            right: 0;
            bottom: 0; /* –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Å height: 100% */
            background: rgba(0,0,0,0.75);
            display: none; /* –°–∫—Ä—ã—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
            align-items: center;
            justify-content: center;
            z-index: 999;
        }

        .mini-game-content {
            background: #232323;
            border-radius: 2vw;
            padding: 5vw 3vw 4vw 3vw;
            color: #fff;
            min-width: 60vw;
            box-shadow: 0 0 4vw #000;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .boxes {
            display: flex;
            gap: 10px;
            margin: 20px 0;
        }

        .box {
            width: 20vw;
            max-width: 100px;
            height: 20vw;
            max-height: 100px;
            background: #000;
            border-radius: 2vw;
            font-size: 10vw;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: inset 0 0 2vw #0f0;
            border: 0.5vw solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .box.win {
            animation: boxWin 1s ease infinite;
            box-shadow: inset 0 0 2vw gold;
            border-color: gold;
        }

        .box.lose {
            animation: boxLose 0.5s ease;
            box-shadow: inset 0 0 2vw #f00;
            border-color: #f00;
        }

        @keyframes boxWin {
            0% { box-shadow: inset 0 0 2vw #0f0; border-color: transparent; transform: scale(1); }
            50% { box-shadow: inset 0 0 2vw gold; border-color: gold; transform: scale(1.05); }
            100% { box-shadow: inset 0 0 2vw #0f0; border-color: transparent; transform: scale(1); }
        }

        @keyframes boxLose {
            0% { transform: scale(1); }
            50% { transform: scale(0.9); }
            100% { transform: scale(1); }
        }

        .mini-game-msg {
            margin: 15px 0;
            font-size: 4vw;
            text-align: center;
            min-height: 2em;
        }

        .close-btn {
            padding: 10px 20px;
            font-size: 4vw;
            background: #4caf50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }

        @media (min-width: 600px) {
            .close-btn {
                font-size: 16px;
            }
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–∏–Ω–∏-–∏–≥—Ä—ã "–î–æ–∂–¥—å –∏–∑ –º–æ–Ω–µ—Ç" */
        #coinRainGame {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            overflow: hidden;
        }

        #coinRainCanvas {
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        #coinRainUI {
            position: absolute;
            top: 20px;
            left: 0;
            width: 100%;
            text-align: center;
            font-size: 20px;
            color: white;
            z-index: 1001;
            pointer-events: none; /* –ß—Ç–æ–±—ã UI –Ω–µ –º–µ—à–∞–ª–æ –∫–ª–∏–∫–∞–º –ø–æ canvas */
        }

        #coinRainMessage {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 28px;
            color: yellow;
            text-align: center;
            z-index: 1002;
            background: rgba(0, 0, 0, 0.7);
            padding: 20px;
            border-radius: 10px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>BingoBett</h1>
        <div class="user-info">
            <div class="username">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: <span id="usernameDisplay">–ì–æ—Å—Ç—å</span></div>
            <div class="freespin-info">–§—Ä–∏—Å–ø–∏–Ω—ã: <span id="freespinCount">0</span></div>
        </div>
        <div class="user-info">
            <div class="balance-info">–ë–∞–ª–∞–Ω—Å: <span id="balanceDisplay">0.00</span> ‚ÇΩ</div>
            <div class="jackpot-info">–î–∂–µ–∫–ø–æ—Ç: <span id="jackpotDisplay">0</span> ‚ÇΩ</div>
        </div>
        <div class="user-info">
            <div class="bet-info">–°—Ç–∞–≤–∫–∞: <span id="betDisplay">10</span> ‚ÇΩ</div>
        </div>
    </div>

    <div class="replenish-buttons">
        <button class="replenish-btn" data-amount="50">50 ‚ÇΩ</button>
        <button class="replenish-btn" data-amount="300">300 ‚ÇΩ</button>
        <button class="replenish-btn" data-amount="500">500 ‚ÇΩ</button>
        <button class="replenish-btn" data-amount="800">800 ‚ÇΩ</button>
        <a id="replenishLink" href="#" target="_blank" style="display: none;">–û–ø–ª–∞—Ç–∏—Ç—å</a>
    </div>

    <div style="text-align: center; margin: 10px 0;">
        <button class="withdraw-btn" id="withdrawBtn">–í—ã–≤–µ—Å—Ç–∏ –≤—ã–∏–≥—Ä—ã—à</button>
    </div>

    <div class="slot-machine" id="slotMachine"></div>

    <div class="controls">
        <button id="spinButton">–í—Ä–∞—â–∞—Ç—å üé∞</button>
        <button id="autoSpinButton">–ê–≤—Ç–æ—Å–ø–∏–Ω ‚ñ∂Ô∏è</button>
        <button id="stopAutoSpinButton" style="display:none;">–°—Ç–æ–ø –∞–≤—Ç–æ—Å–ø–∏–Ω ‚èπ</button>
        <button id="rulesButton">–ü—Ä–∞–≤–∏–ª–∞ üìã</button>
    </div>

    <div class="bet-controls">
        <button id="betMinus">-</button>
        <span>–°—Ç–∞–≤–∫–∞: <span id="betAmountDisplay">10</span> ‚ÇΩ</span>
        <button id="betPlus">+</button>
    </div>

    <div class="message" id="message"></div>
    <div id="botChat"><b>–ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª–∏:</b><br></div>

    <!-- –ú–∏–Ω–∏-–∏–≥—Ä–∞ "–í—ã–±–µ—Ä–∏ –∫–æ—Ä–æ–±–∫—É" -->
    <div class="mini-game-overlay" id="miniGameOverlay">
        <div class="mini-game-content">
            <h2>–ú–∏–Ω–∏-–∏–≥—Ä–∞: –≤—ã–±–µ—Ä–∏—Ç–µ –∫–æ—Ä–æ–±–∫—É!</h2>
            <div class="boxes">
                <div class="box" data-box="1">üéÅ</div>
                <div class="box" data-box="2">üéÅ</div>
                <div class="box" data-box="3">üéÅ</div>
            </div>
            <div class="mini-game-msg" id="miniGameMsg"></div>
            <button class="close-btn" id="closeMiniGame">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <!-- –ú–∏–Ω–∏-–∏–≥—Ä–∞ "–î–æ–∂–¥—å –∏–∑ –º–æ–Ω–µ—Ç" -->
    <div id="coinRainGame">
        <canvas id="coinRainCanvas"></canvas>
        <div id="coinRainUI">
            <div>–ü–æ–π–º–∞–Ω–æ: <span id="coinsCaught">0</span> ‚ÇΩ</div>
            <div>–û—Å—Ç–∞–ª–æ—Å—å –≤—Ä–µ–º–µ–Ω–∏: <span id="timeLeft">15</span> —Å–µ–∫</div>
        </div>
        <div id="coinRainMessage"></div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏ -->
    <div id="usernameModal" class="modal-bg" style="display:none;">
        <div class="username-modal">
            <h3>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ BingoBett!</h3>
            <div>–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –¥–ª—è –∏–≥—Ä—ã:</div>
            <input id="usernameInput" maxlength="32" autocomplete="off">
            <button id="usernameOkBtn">OK</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–≤–æ–¥–∞ -->
    <div id="withdrawModal" class="modal-bg" style="display:none;">
        <div class="withdraw-modal">
            <h3>–í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</h3>
            <div>–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –∫–∞—Ä—Ç—ã (16 —Ü–∏—Ñ—Ä):</div>
            <input id="cardNumberInput" maxlength="19" placeholder="1234 5678 9012 3456" autocomplete="off">
            <div>–°—É–º–º–∞ –∫ –≤—ã–≤–æ–¥—É: <span id="withdrawAmount">0.00</span> ‚ÇΩ</div>
            <div style="margin-top: 15px;">
                <button id="confirmWithdrawBtn">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
                <button class="cancel" id="cancelWithdrawBtn">–û—Ç–º–µ–Ω–∞</button>
            </div>
            <div class="withdraw-error" id="withdrawError"></div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∞–≤–∏–ª -->
    <div id="rulesModal" class="modal-bg" style="display:none;">
        <div class="rules-modal">
            <h3>–ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã BingoBett</h3>
            <ul>
                <li><b>–¶–µ–ª—å –∏–≥—Ä—ã:</b> –í—ã—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏.</li>
                <li><b>–°–ª–æ—Ç—ã:</b> –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ 5x4. –í—ã–∏–≥—Ä—ã—à–∏ –Ω–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã—Ö –ª–∏–Ω–∏—è—Ö.</li>
                <li><b>–°—Ç–∞–≤–∫–∏:</b> –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞ 10 ‚ÇΩ, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è 80 ‚ÇΩ.</li>
                <li><b>–í—ã–ø–ª–∞—Ç—ã:</b>
                    <ul>
                        <li>–û–±—ã—á–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã: üçíüçãüçäüçâüçáüçì: 3√ó5, 4√ó10, 5√ó20</li>
                        <li>–û–±—ã—á–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã: üççü•ùüçåü••: 3√ó7, 4√ó14, 5√ó28</li>
                        <li>–ü—Ä–µ–º–∏—É–º —Å–∏–º–≤–æ–ª—ã: üéÅ: 3√ó15, 4√ó30, 5√ó60</li>
                        <li>–ü—Ä–µ–º–∏—É–º —Å–∏–º–≤–æ–ª—ã: üíé: 3√ó20, 4√ó40, 5√ó80</li>
                        <li>–ü—Ä–µ–º–∏—É–º —Å–∏–º–≤–æ–ª—ã: ‚≠ê: 3√ó25, 4√ó50, 5√ó100</li>
                        <li>–ü—Ä–µ–º–∏—É–º —Å–∏–º–≤–æ–ª—ã: üÉè: 3√ó30, 4√ó60, 5√ó120</li>
                        <li>–û—Å–æ–±—ã–µ —Å–∏–º–≤–æ–ª—ã: üëë: 3√ó50, 4√ó100, 5√ó200</li>
                        <li>–û—Å–æ–±—ã–µ —Å–∏–º–≤–æ–ª—ã: üí∞ (—Ç–æ–ª—å–∫–æ –Ω–∞ 3-–º –±–∞—Ä–∞–±–∞–Ω–µ): 3√ó100, 4√ó200, 5√ó500</li>
                    </ul>
                </li>
                <li><b>–î–∂–µ–∫–ø–æ—Ç:</b> 10% –æ—Ç –∫–∞–∂–¥–æ–π —Å—Ç–∞–≤–∫–∏ –∏–¥–µ—Ç –≤ —Ñ–æ–Ω–¥ –¥–∂–µ–∫–ø–æ—Ç–∞. –®–∞–Ω—Å –Ω–∞ –¥–∂–µ–∫–ø–æ—Ç 0.1%.</li>
                <li><b>–§—Ä–∏—Å–ø–∏–Ω—ã:</b> –ü—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –¥–∞–µ—Ç—Å—è 55 —Ñ—Ä–∏—Å–ø–∏–Ω–æ–≤. –ê–∫—Ç–∏–≤–Ω—ã 24 —á–∞—Å–∞.</li>
                <li><b>–ú–∏–Ω–∏-–∏–≥—Ä—ã:</b> –ü—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –≤—ã–∏–≥—Ä—ã—à–∞—Ö –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –º–∏–Ω–∏-–∏–≥—Ä—ã —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø—Ä–∏–∑–∞–º–∏.</li>
                <li><b>–í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤:</b> –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –¥–ª—è –≤—ã–≤–æ–¥–∞ 40,001 ‚ÇΩ. –ö –≤—ã–≤–æ–¥—É –¥–æ—Å—Ç—É–ø–Ω–∞ —Å—É–º–º–∞ —Å–≤—ã—à–µ 40,000 ‚ÇΩ.</li>
            </ul>
            <button id="closeRulesBtn">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <script>
        (function() { // –ò—Å–ø–æ–ª—å–∑—É–µ–º IIFE –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏
            'use strict';

            // - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App SDK -
            let tgUser = null;
            let isTelegramReady = false;

            function initTelegram() {
                if (window.Telegram && window.Telegram.WebApp) {
                    const tg = window.Telegram.WebApp;
                    tg.expand();
                    tg.enableClosingConfirmation();
                    tgUser = tg.initDataUnsafe.user || null;
                    isTelegramReady = true;
                    console.log("Telegram Web App SDK –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω");
                } else {
                    console.warn("Telegram Web App SDK –Ω–µ –Ω–∞–π–¥–µ–Ω");
                }
            }

            // - DOM –≠–ª–µ–º–µ–Ω—Ç—ã - (–±—É–¥—É—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM)
            let slotMachine = null;
            let slotElements = [];
            let messageElement = null;
            let balanceDisplay = null;
            let jackpotDisplay = null;
            let betDisplay = null;
            let betAmountDisplay = null;
            let usernameDisplay = null;
            let freespinCount = null;
            let spinButton = null;
            let autoSpinButton = null;
            let stopAutoSpinButton = null;
            let betMinus = null;
            let betPlus = null;
            let botChat = null;

            // - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–≥—Ä—ã -
            const COLUMNS = 5;
            const ROWS = 4;
            const MIN_BET = 10;
            const MAX_BET = 80;

            // *** –ò–ó–ú–ï–ù–ï–ù–û: –£–º–µ–Ω—å—à–µ–Ω–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã–ø–∞–¥–µ–Ω–∏—è —Ä–µ–¥–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤ ***
            const REELS = [
                ["üçí","üçã","üçä","üçâ","üçá","üçì","üçç","ü•ù","üçå","ü••","üéÅ","üíé","üçã","üçä","üçâ","üçá","üçì","ü••","‚≠ê","üÉè","üëë"],
                ["üçã","üçä","üçâ","üçá","üçì","üçç","ü•ù","üçå","ü••","üéÅ","üíé","üçí","üçã","üçä","üçâ","üçá","üçì","üçç","‚≠ê","üÉè"],
                ["üçä","üçâ","üçá","üçì","üçç","ü•ù","üçå","ü••","üéÅ","üíé","üçí","üçã","üçä","üçâ","üçá","üçì","üçç","‚≠ê","üÉè","üí∞"],
                ["üçâ","üçá","üçì","üçç","ü•ù","üçå","ü••","üéÅ","üíé","üçí","üçã","üçä","üçâ","üçá","üçì","üçç","‚≠ê","üÉè"],
                ["üçá","üçì","üçç","ü•ù","üçå","ü••","üéÅ","üíé","üçí","üçã","üçä","üçâ","üçá","üçì","üçç","ü•ù","‚≠ê","üÉè"]
            ];

            // *** –ò–ó–ú–ï–ù–ï–ù–û: –£–º–µ–Ω—å—à–µ–Ω–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã–ø–∞–¥–µ–Ω–∏—è —Ä–µ–¥–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤ ***
            const payTable = {
                "üçí": {3:5, 4:10, 5:20}, "üçã": {3:5, 4:10, 5:20}, "üçä": {3:5, 4:10, 5:20},
                "üçâ": {3:5, 4:10, 5:20}, "üçá": {3:5, 4:10, 5:20}, "üçì": {3:7, 4:14, 5:28},
                "üçç": {3:7, 4:14, 5:28}, "ü•ù": {3:10, 4:20, 5:40}, "üçå": {3:10, 4:20, 5:40},
                "ü••": {3:12, 4:24, 5:48}, "üéÅ": {3:15, 4:30, 5:60}, "üíé": {3:20, 4:40, 5:80},
                "‚≠ê": {3:25, 4:50, 5:100}, "üÉè": {3:30, 4:60, 5:120}, "üëë": {3:50, 4:100, 5:200},
                "üí∞": {3:100, 4:200, 5:500}
            };

            // - –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã -
            // *** –ò–ó–ú–ï–ù–ï–ù–û: –°—Ç–∞—Ä—Ç–æ–≤—ã–π –±–∞–ª–∞–Ω—Å 777 —Ä—É–±–ª–µ–π ***
            let balance = parseFloat(localStorage.getItem('slotBalance')) || 777;
            let betAmount = parseInt(localStorage.getItem('slotBet')) || 10;
            let jackpot = parseFloat(localStorage.getItem('jackpot')) || 2200453;
            let username = localStorage.getItem('slotUsername') || '';
            let isSpinning = false;
            let autoSpinActive = false;
            let autoSpinInterval = null;
            let isUsingFreeSpin = false;

            // - –ö–ª–∞—Å—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ—Ä–∏—Å–ø–∏–Ω–∞–º–∏ -
            class FreeSpinsManager {
                constructor() {
                    this.initializeFreeSpins();
                    this.checkExpiration();
                }

                initializeFreeSpins() {
                    const registrationTimestamp = localStorage.getItem('registrationTimestamp');
                    if (!registrationTimestamp) {
                        localStorage.setItem('freeSpins', '55');
                        localStorage.setItem('registrationTimestamp', Date.now().toString());
                    }
                }

                checkExpiration() {
                    const registrationTime = Number(localStorage.getItem('registrationTimestamp'));
                    const currentTime = Date.now();
                    const twentyFourHours = 24 * 60 * 60 * 1000;
                    
                    if (currentTime - registrationTime > twentyFourHours) {
                        localStorage.setItem('freeSpins', '0');
                        this.updateDisplay();
                    }
                }

                getFreeSpins() {
                    this.checkExpiration();
                    return parseInt(localStorage.getItem('freeSpins') || '0');
                }

                useFreeSpins(count = 1) {
                    let currentSpins = this.getFreeSpins();
                    if (currentSpins >= count) {
                        currentSpins -= count;
                        localStorage.setItem('freeSpins', currentSpins.toString());
                        this.updateDisplay();
                        return true;
                    }
                    return false;
                }

                updateDisplay() {
                    const freeSpins = this.getFreeSpins();
                    if (freespinCount) freespinCount.textContent = freeSpins;
                }
            }

            const freeSpinsManager = new FreeSpinsManager();

            // - –§—É–Ω–∫—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI -
            function updateUI() {
                if (balanceDisplay) balanceDisplay.textContent = balance.toFixed(2);
                if (jackpotDisplay) jackpotDisplay.textContent = new Intl.NumberFormat('ru-RU').format(jackpot);
                if (betDisplay) betDisplay.textContent = betAmount;
                if (betAmountDisplay) betAmountDisplay.textContent = betAmount;
                if (usernameDisplay) usernameDisplay.textContent = username || '–ì–æ—Å—Ç—å';
                
                localStorage.setItem('slotBalance', balance.toString());
                localStorage.setItem('slotBet', betAmount.toString());
                localStorage.setItem('jackpot', jackpot.toString());
                localStorage.setItem('slotUsername', username);
                
                freeSpinsManager.updateDisplay();
            }

            function showMessage(text) {
                if (messageElement) {
                    messageElement.textContent = text;
                    // –û—á–∏—Å—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
                    setTimeout(() => {
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –±—ã–ª–æ –ª–∏ –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
                        if (messageElement.textContent === text) {
                            messageElement.textContent = '';
                        }
                    }, 5000);
                }
            }

            // *** –ò–ó–ú–ï–ù–ï–ù–û: –£–º–µ–Ω—å—à–µ–Ω–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã–∏–≥—Ä—ã—à–µ–π ***
            function getSymbolFromReel(reel, position) {
                const symbol = reel[position % reel.length];

                // –£–º–µ–Ω—å—à–∞–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã–ø–∞–¥–µ–Ω–∏—è –æ—á–µ–Ω—å —Ä–µ–¥–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤ –Ω–∞ 20%
                if ((symbol === "üëë" || symbol === "üí∞") && Math.random() > 0.2) { // –ë—ã–ª–æ 0.15, —Å—Ç–∞–ª–æ 0.2
                    const commonSymbols = ["üçí","üçã","üçä","üçâ","üçá","üçì","üçç","ü•ù","üçå","ü••"];
                    return commonSymbols[Math.floor(Math.random() * commonSymbols.length)];
                }

                // –£–º–µ–Ω—å—à–∞–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã–ø–∞–¥–µ–Ω–∏—è –ø—Ä–µ–º–∏—É–º —Å–∏–º–≤–æ–ª–æ–≤ –Ω–∞ 20%
                if ((symbol === "üéÅ" || symbol === "üíé" || symbol === "‚≠ê" || symbol === "üÉè") && Math.random() > 0.35) { // –ë—ã–ª–æ 0.3, —Å—Ç–∞–ª–æ 0.35
                    const commonAndMediumSymbols = ["üçí","üçã","üçä","üçâ","üçá","üçì","üçç","ü•ù","üçå","ü••", "üçì","üçç","ü•ù","üçå","ü••"];
                    return commonAndMediumSymbols[Math.floor(Math.random() * commonAndMediumSymbols.length)];
                }

                return symbol;
            }

            // - –õ–æ–≥–∏–∫–∞ –∏–≥—Ä—ã -
            function createSlots() {
                if (!slotMachine) {
                    console.error("–≠–ª–µ–º–µ–Ω—Ç slotMachine –Ω–µ –Ω–∞–π–¥–µ–Ω");
                    return;
                }
                slotMachine.innerHTML = '';
                slotElements = [];

                for(let row=0; row<ROWS; row++){
                    for(let col=0; col<COLUMNS; col++){
                        const slot = document.createElement('div');
                        slot.classList.add('slot');
                        slot.textContent = "üçí"; // –ù–∞—á–∞–ª—å–Ω—ã–π —Å–∏–º–≤–æ–ª
                        slotMachine.appendChild(slot);
                        slotElements.push(slot);
                    }
                }
            }

            function setupEventListeners() {
                // –ö–Ω–æ–ø–∫–∏ —Å—Ç–∞–≤–∫–∏
                if (betMinus) {
                    // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
                    const newBetMinus = betMinus.cloneNode(true);
                    betMinus.parentNode.replaceChild(newBetMinus, betMinus);
                    betMinus = newBetMinus;
                    betMinus.onclick = () => {
                        if (betAmount > MIN_BET) {
                            betAmount -= 10;
                            updateUI();
                        }
                    };
                }

                if (betPlus) {
                    // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
                    const newBetPlus = betPlus.cloneNode(true);
                    betPlus.parentNode.replaceChild(newBetPlus, betPlus);
                    betPlus = newBetPlus;
                    betPlus.onclick = () => {
                        if (betAmount < MAX_BET) {
                            betAmount += 10;
                            updateUI();
                        }
                    };
                }

                // –ö–Ω–æ–ø–∫–∏ –≤—Ä–∞—â–µ–Ω–∏—è
                if (spinButton) {
                    const newSpinButton = spinButton.cloneNode(true);
                    spinButton.parentNode.replaceChild(newSpinButton, spinButton);
                    spinButton = newSpinButton;
                    spinButton.onclick = startSpin;
                }

                if (autoSpinButton) {
                    const newAutoSpinButton = autoSpinButton.cloneNode(true);
                    autoSpinButton.parentNode.replaceChild(newAutoSpinButton, autoSpinButton);
                    autoSpinButton = newAutoSpinButton;
                    autoSpinButton.onclick = startAutoSpin;
                }

                if (stopAutoSpinButton) {
                    const newStopAutoSpinButton = stopAutoSpinButton.cloneNode(true);
                    stopAutoSpinButton.parentNode.replaceChild(newStopAutoSpinButton, stopAutoSpinButton);
                    stopAutoSpinButton = newStopAutoSpinButton;
                    stopAutoSpinButton.onclick = stopAutoSpin;
                }

                // –ö–Ω–æ–ø–∫–∏ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
                const replenishButtons = document.querySelectorAll('.replenish-btn');
                replenishButtons.forEach(btn => {
                    btn.onclick = () => {
                        const amount = btn.getAttribute('data-amount');
                        if (amount) {
                            // –í —Ä–µ–∞–ª—å–Ω–æ–π –∏–≥—Ä–µ –∑–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã
                            // –ù–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ –ÆMoney
                            const link = document.getElementById('replenishLink');
                            if (link) {
                                // –ü—Ä–∏–º–µ—Ä —Å—Å—ã–ª–∫–∏ –¥–ª—è –ÆMoney (–Ω—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –≤–∞—à—É)
                                link.href = `https://yoomoney.ru/quickpay/confirm.xml?receiver=4100118061966198&quickpay-form=shop&targets=%D0%9F%D0%BE%D0%BF%D0%BE%D0%BB%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5+%D0%B1%D0%B0%D0%BB%D0%B0%D0%BD%D1%81%D0%B0+BingoBett&paymentType=AC&sum=${amount}`;
                                link.style.display = 'block';
                                link.click();
                                
                                // –≠–º—É–ª—è—Ü–∏—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                                // –í —Ä–µ–∞–ª—å–Ω–æ–π –∏–≥—Ä–µ —ç—Ç–æ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø–æ—Å–ª–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç –ÆMoney
                                /*
                                setTimeout(() => {
                                    balance += parseFloat(amount);
                                    updateUI();
                                    showMessage(`–ë–∞–ª–∞–Ω—Å –ø–æ–ø–æ–ª–Ω–µ–Ω –Ω–∞ ${amount} ‚ÇΩ (—ç–º—É–ª—è—Ü–∏—è)`);
                                }, 5000);
                                */
                            }
                        }
                    };
                });

                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
                initializeUsernameModal();
                initializeWithdrawal();
                initializeRules();
            }

            // - –ê–≤—Ç–æ—Å–ø–∏–Ω -
            function startAutoSpin() {
                if (autoSpinActive) return;
                autoSpinActive = true;
                
                if (autoSpinButton) autoSpinButton.style.display = 'none';
                if (stopAutoSpinButton) stopAutoSpinButton.style.display = 'inline-block';
                
                autoSpinInterval = setInterval(() => {
                    if (!isSpinning) {
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–µ–º –ª–∏ –º—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∞–≤—Ç–æ—Å–ø–∏–Ω
                        const freeSpins = freeSpinsManager.getFreeSpins();
                        if (balance >= betAmount || freeSpins > 0) {
                            startSpin();
                        } else {
                            stopAutoSpin();
                            showMessage('–ê–≤—Ç–æ—Å–ø–∏–Ω –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤');
                        }
                    }
                }, 3000); // –ò–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É —Å–ø–∏–Ω–∞–º–∏ –≤ –∞–≤—Ç–æ—Å–ø–∏–Ω–µ
            }

            function stopAutoSpin() {
                autoSpinActive = false;
                if (autoSpinInterval) {
                    clearInterval(autoSpinInterval);
                    autoSpinInterval = null;
                }
                
                if (autoSpinButton) autoSpinButton.style.display = 'inline-block';
                if (stopAutoSpinButton) stopAutoSpinButton.style.display = 'none';
            }

            // - –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤—Ä–∞—â–µ–Ω–∏—è -
            async function startSpin() {
                if (isSpinning) return;
                isSpinning = true;

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ –∏ —Ñ—Ä–∏—Å–ø–∏–Ω–æ–≤
                const freeSpins = freeSpinsManager.getFreeSpins();
                if (freeSpins > 0) {
                    isUsingFreeSpin = true;
                    freeSpinsManager.useFreeSpins(1);
                    showMessage('üéÅ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—Ä–∏—Å–ø–∏–Ω!');
                } else if (balance >= betAmount) {
                    isUsingFreeSpin = false;
                } else {
                    showMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è —Å—Ç–∞–≤–∫–∏');
                    isSpinning = false;
                    return;
                }

                if (!isUsingFreeSpin) {
                    // –°–Ω–∏–º–∞–µ–º –æ–±—ã—á–Ω—É—é —Å—Ç–∞–≤–∫—É
                    let jackpotPart = betAmount * 0.1; // 10% –∏–¥–µ—Ç –≤ –¥–∂–µ–∫–ø–æ—Ç
                    jackpot += jackpotPart;
                    balance -= betAmount;
                    updateUI(); // –û–±–Ω–æ–≤–ª—è–µ–º UI –ø–æ—Å–ª–µ —Å–Ω—è—Ç–∏—è —Å—Ç–∞–≤–∫–∏
                } else {
                    // –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Ñ—Ä–∏—Å–ø–∏–Ω–∞ —á–∞—Å—Ç—å —Å—Ç–∞–≤–∫–∏ —Ç–æ–∂–µ –∏–¥–µ—Ç –≤ –¥–∂–µ–∫–ø–æ—Ç
                    let jackpotPart = betAmount * 0.1;
                    jackpot += jackpotPart;
                    updateUI(); // –û–±–Ω–æ–≤–ª—è–µ–º UI —Ç–æ–ª—å–∫–æ –¥–∂–µ–∫–ø–æ—Ç
                }

                // - –ê–Ω–∏–º–∞—Ü–∏—è –≤—Ä–∞—â–µ–Ω–∏—è -
                if (messageElement) messageElement.textContent = "–í—Ä–∞—â–∞–µ–º...";

                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–∞—Ä–∞–±–∞–Ω–∞ (–∫–æ–ª–æ–Ω–∫–∏)
                let finalStopPositions = [];
                for(let col=0; col<COLUMNS; col++){
                    const reel = REELS[col];
                    // –î–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–µ–º –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏
                    const intermediatePositions = [];
                    for(let i=0; i<10; i++) { // 10 –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π –¥–ª—è –ø–ª–∞–≤–Ω–æ—Å—Ç–∏
                        intermediatePositions.push(Math.floor(Math.random() * reel.length));
                    }
                    // –§–∏–Ω–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è
                    const finalPosition = Math.floor(Math.random() * reel.length);
                    intermediatePositions.push(finalPosition);
                    finalStopPositions.push({
                        intermediate: intermediatePositions,
                        final: finalPosition
                    });
                }

                // –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–ª–æ—Ç–æ–≤
                slotElements.forEach(slot => {
                    slot.classList.remove('win', 'big-win', 'stopping');
                });

                // –ó–∞–ø—É—Å–∫ –∞–Ω–∏–º–∞—Ü–∏–∏ –≤—Ä–∞—â–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö —Å–ª–æ—Ç–æ–≤
                slotElements.forEach((slot, index) => {
                    slot.classList.add('spinning');
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º —Å–∏–º–≤–æ–ª –≤–Ω—É—Ç—Ä–∏ —Å–ª–æ—Ç–∞ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
                    const symbolDiv = document.createElement('div');
                    symbolDiv.className = 'symbol';
                    slot.innerHTML = '';
                    slot.appendChild(symbolDiv);
                    
                    // –ü–æ–ª—É—á–∞–µ–º –∫–æ–ª–æ–Ω–∫—É —Å–ª–æ—Ç–∞
                    const col = index % COLUMNS;
                    
                    // –ë—ã—Å—Ç—Ä–∞—è —Å–º–µ–Ω–∞ —Å–∏–º–≤–æ–ª–æ–≤
                    let spinIndex = 0;
                    const spinSymbols = ["üçí","üçã","üçä","üçâ","üçá","üçì","üçç","ü•ù","üçå","ü••","üéÅ","üíé","‚≠ê","üÉè","üëë","üí∞"];
                    const symbolInterval = setInterval(() => {
                        symbolDiv.textContent = spinSymbols[spinIndex % spinSymbols.length];
                        spinIndex++;
                    }, 50); // –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–∞—è —Å–º–µ–Ω–∞
                    slot.dataset.symbolInterval = symbolInterval;
                });

                // –ù–∞—á–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ –æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π –ø–µ—Ä–≤–æ–≥–æ –±–∞—Ä–∞–±–∞–Ω–∞
                await new Promise(resolve => setTimeout(resolve, 1000));

                // –ü–æ–æ—á–µ—Ä–µ–¥–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞—Ä–∞–±–∞–Ω–æ–≤ (—Å–ª–µ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ)
                for (let col = 0; col < COLUMNS; col++) {
                    // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ –∑–∞–º–µ–¥–ª–µ–Ω–∏—è
                    for (let row = 0; row < ROWS; row++) {
                        const slotIndex = row * COLUMNS + col;
                        const slot = slotElements[slotIndex];
                        slot.classList.add('stopping');
                        
                        // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–º–µ–Ω—É —Å–∏–º–≤–æ–ª–æ–≤
                        const symbolInterval = slot.dataset.symbolInterval;
                        if (symbolInterval) {
                            clearInterval(symbolInterval);
                        }
                        
                        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Å–∏–º–≤–æ–ª —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
                        const finalSymbol = getSymbolFromReel(REELS[col], finalStopPositions[col].final);
                        const symbolDiv = slot.querySelector('.symbol');
                        if (symbolDiv) {
                            symbolDiv.textContent = finalSymbol;
                        }
                    }
                    
                    // –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
                    await new Promise(resolve => setTimeout(resolve, 400));
                    
                    // –¢–∞–∫—Ç–∏–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞
                    if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.HapticFeedback) {
                        window.Telegram.WebApp.HapticFeedback.impactOccurred('medium');
                    }
                    
                    // –ü–∞—É–∑–∞ –º–µ–∂–¥—É –æ—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏ –±–∞—Ä–∞–±–∞–Ω–æ–≤
                    if (col < COLUMNS - 1) {
                        await new Promise(resolve => setTimeout(resolve, 300));
                    }
                }

                // –£–±–∏—Ä–∞–µ–º –∫–ª–∞—Å—Å –≤—Ä–∞—â–µ–Ω–∏—è
                slotElements.forEach(slot => {
                    slot.classList.remove('spinning');
                });

                // - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–∏–≥—Ä—ã—à–µ–π -
                // –§–æ—Ä–º–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
                let results = [];
                for(let row=0; row<ROWS; row++){
                    let line = [];
                    for(let col=0; col<COLUMNS; col++){
                        const slotIndex = row * COLUMNS + col;
                        line.push(slotElements[slotIndex].textContent);
                    }
                    results.push(line);
                }

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—ã–∏–≥—Ä—ã—à–Ω—ã–µ –ª–∏–Ω–∏–∏
                let totalWin = 0;
                let winningLines = []; // –î–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ª—å–∫–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏ (4 –ª–∏–Ω–∏–∏)
                for (let row = 0; row < ROWS; row++) {
                    const line = results[row];
                    const firstSymbol = line[0];
                    let count = 1;
                    
                    for (let i = 1; i < line.length; i++) {
                        if (line[i] === firstSymbol) {
                            count++;
                        } else {
                            break;
                        }
                    }
                    
                    if (count >= 3 && payTable[firstSymbol]) {
                        const win = payTable[firstSymbol][count] || 0;
                        totalWin += win * betAmount;
                        winningLines.push({row: row, count: count});
                    }
                }

                // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –≤—ã–∏–≥—Ä–∞–≤—à–∏–µ –ª–∏–Ω–∏–∏
                // –°–Ω–∞—á–∞–ª–∞ –æ–ø—Ä–µ–¥–µ–ª–∏–º –∏–Ω–¥–µ–∫—Å—ã –≤—ã–∏–≥—Ä–∞–≤—à–∏—Ö —Å–ª–æ—Ç–æ–≤
                let winningSlots = [];
                for (const winInfo of winningLines) {
                    const {row, count} = winInfo;
                    // –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å—ã —Å–ª–æ—Ç–æ–≤ –≤ —ç—Ç–æ–π –ª–∏–Ω–∏–∏
                    for (let col = 0; col < count; col++) {
                        const index = row * COLUMNS + col;
                        winningSlots.push(index);
                    }
                }

                // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –≤—ã–∏–≥—Ä–∞–≤—à–∏–µ —Å–ª–æ—Ç—ã
                winningSlots.forEach(index => {
                    const slot = slotElements[index];
                    if (slot) {
                        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –≤—ã–∏–≥—Ä—ã—à–∞ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
                        const symbol = slot.textContent;
                        if (totalWin >= betAmount * 10) { // –£—Å–ª–æ–≤–∏–µ –¥–ª—è –±–æ–ª—å—à–æ–≥–æ –≤—ã–∏–≥—Ä—ã—à–∞, –º–æ–∂–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å
                            slot.classList.add('big-win');
                        } else {
                            slot.classList.add('win');
                        }
                    }
                });

                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–∏–≥—Ä—ã—à–∞
                if (totalWin > 0) {
                    balance += totalWin;
                    
                    // –î–∂–µ–∫–ø–æ—Ç –Ω–µ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –≤ —ç—Ç–æ–π –≤–µ—Ä—Å–∏–∏ –∏–≥—Ä—ã, –∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ
                    
                    if (totalWin >= betAmount * 50) { // –£—Å–ª–æ–≤–∏–µ –¥–ª—è –º–µ–≥–∞-–≤—ã–∏–≥—Ä—ã—à–∞
                        showMessage(`üéâ –ú–ï–ì–ê –í–´–ò–ì–†–´–®! +${totalWin.toFixed(2)} ‚ÇΩ`);
                    } else {
                        showMessage(`üí∞ –í—ã–∏–≥—Ä—ã—à: +${totalWin.toFixed(2)} ‚ÇΩ`);
                    }

                    // –ó–∞–ø—É—Å–∫ –º–∏–Ω–∏-–∏–≥—Ä—ã —Å –Ω–µ–±–æ–ª—å—à–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é –∏–ª–∏ –ø—Ä–∏ –±–æ–ª—å—à–æ–º –≤—ã–∏–≥—Ä—ã—à–µ
                    // *** –ò–ó–ú–ï–ù–ï–ù–û: –£–≤–µ–ª–∏—á–µ–Ω–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞ –º–∏–Ω–∏-–∏–≥—Ä—ã –Ω–∞ 4% ***
                    // –ë—ã–ª–æ 3%, —Å—Ç–∞–ª–æ 7%
                    if (Math.random() < 0.07 || totalWin >= betAmount * 25) {
                        setTimeout(() => startMiniGame(totalWin), 2000);
                    }
                    
                    // *** –î–û–ë–ê–í–õ–ï–ù–û: –ó–∞–ø—É—Å–∫ –º–∏–Ω–∏-–∏–≥—Ä—ã "–î–æ–∂–¥—å –∏–∑ –º–æ–Ω–µ—Ç" —Å 5% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é –ø–æ—Å–ª–µ –≤—ã–∏–≥—Ä—ã—à–∞ ***
                    if (Math.random() < 0.05) {
                        setTimeout(() => startCoinRainGame(totalWin), 2000);
                    }
                } else {
                    showMessage("–ù–µ—Ç –≤—ã–∏–≥—Ä—ã—à–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë!");
                }

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∂–µ–∫–ø–æ—Ç–∞ (–æ—á–µ–Ω—å –Ω–∏–∑–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å)
                if (Math.random() < 0.001) { // 0.1% —à–∞–Ω—Å
                    balance += jackpot;
                    showMessage(`üèÜ –î–ñ–ï–ö–ü–û–¢! +${jackpot.toFixed(2)} ‚ÇΩ`);
                    addBotMessage(`${username || '–ò–≥—Ä–æ–∫'} —Å–æ—Ä–≤–∞–ª –î–ñ–ï–ö–ü–û–¢ ${jackpot.toFixed(2)} ‚ÇΩ!`);
                    jackpot = 100000; // –°–±—Ä–æ—Å –¥–∂–µ–∫–ø–æ—Ç–∞
                }

                updateUI();
                isSpinning = false;
            }

            // - –ú–∏–Ω–∏-–∏–≥—Ä–∞ -
            function startMiniGame(winAmount) {
                const overlay = document.getElementById('miniGameOverlay');
                const boxes = overlay ? overlay.querySelectorAll('.box') : [];
                const msg = document.getElementById('miniGameMsg');
                const closeBtn = document.getElementById('closeMiniGame');

                if (!overlay || boxes.length === 0 || !msg || !closeBtn) {
                    console.warn("–≠–ª–µ–º–µ–Ω—Ç—ã –º–∏–Ω–∏-–∏–≥—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.");
                    return;
                }

                // –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ—Ä–æ–±–æ–∫
                boxes.forEach(box => {
                    box.classList.remove('win', 'lose');
                    box.onclick = null;
                });

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–≤–µ—Ä–ª–µ–π
                overlay.style.display = 'flex';

                // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –∑–∞–∫—Ä—ã—Ç–∏—è –¥–æ –≤—ã–±–æ—Ä–∞
                closeBtn.style.display = 'none';

                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤—ã–∏–≥—Ä—ã—à–Ω—É—é –∫–æ—Ä–æ–±–∫—É
                const winBoxIndex = Math.floor(Math.random() * 3);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                msg.textContent = "–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–Ω—É –∏–∑ –∫–æ—Ä–æ–±–æ–∫. –í –æ–¥–Ω–æ–π –∏–∑ –Ω–∏—Ö –ø—Ä–∏–∑!";

                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–æ–≤
                boxes.forEach((box, index) => {
                    box.onclick = function() {
                        // –û—Ç–∫–ª—é—á–∞–µ–º –∫–ª–∏–∫–∏ –Ω–∞ –≤—Å–µ—Ö –∫–æ—Ä–æ–±–∫–∞—Ö
                        boxes.forEach(b => b.onclick = null);
                        
                        // –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –¥—Ä–∞–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞
                        setTimeout(() => {
                            if (index === winBoxIndex) {
                                // –í—ã–∏–≥—Ä—ã—à
                                box.classList.add('win');
                                const bonusWin = winAmount; // –ë–æ–Ω—É—Å —Ä–∞–≤–µ–Ω –æ—Å–Ω–æ–≤–Ω–æ–º—É –≤—ã–∏–≥—Ä—ã—à—É
                                balance += bonusWin;
                                msg.textContent = `–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! +${bonusWin.toFixed(2)} ‚ÇΩ`;
                                showMessage(`–ú–∏–Ω–∏-–∏–≥—Ä–∞: +${bonusWin.toFixed(2)} ‚ÇΩ`);
                            } else {
                                // –ü—Ä–æ–∏–≥—Ä—ã—à
                                box.classList.add('lose');
                                // –ú–æ–∂–Ω–æ —Å–Ω—è—Ç—å —á–∞—Å—Ç—å –≤—ã–∏–≥—Ä—ã—à–∞, –Ω–æ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ, –ø–æ—Ö–æ–∂–µ, –Ω–∏—á–µ–≥–æ –Ω–µ —Å–Ω–∏–º–∞–ª–æ—Å—å
                                msg.textContent = `–ü–æ–≤–µ–∑–µ—Ç –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!`;
                            }
                            updateUI();
                            
                            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –∑–∞–∫—Ä—ã—Ç–∏—è
                            closeBtn.style.display = 'block';
                        }, 800); // –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
                    };
                });

                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –∑–∞–∫—Ä—ã—Ç–∏—è
                closeBtn.onclick = function() {
                    overlay.style.display = 'none';
                };
            }

            // - –ú–∏–Ω–∏-–∏–≥—Ä–∞ "–î–æ–∂–¥—å –∏–∑ –º–æ–Ω–µ—Ç" -
            function startCoinRainGame(winAmountFromSlots) {
                const gameContainer = document.getElementById('coinRainGame');
                const canvas = document.getElementById('coinRainCanvas');
                const ctx = canvas.getContext('2d');
                const coinsCaughtElement = document.getElementById('coinsCaught');
                const timeLeftElement = document.getElementById('timeLeft');
                const messageElement = document.getElementById('coinRainMessage');
                
                if (!gameContainer || !canvas || !ctx || !coinsCaughtElement || !timeLeftElement || !messageElement) {
                    console.warn("–≠–ª–µ–º–µ–Ω—Ç—ã –º–∏–Ω–∏-–∏–≥—Ä—ã '–î–æ–∂–¥—å –∏–∑ –º–æ–Ω–µ—Ç' –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.");
                    return;
                }

                // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ canvas
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
                
                // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
                let coins = [];
                let score = 0;
                let timeLeft = 15; // 15 —Å–µ–∫—É–Ω–¥
                let gameActive = true;
                
                // –ù–æ–º–∏–Ω–∞–ª—ã –º–æ–Ω–µ—Ç –∏ –∏—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
                const coinValues = [
                    { value: 1, probability: 0.4 },
                    { value: 5, probability: 0.3 },
                    { value: 10, probability: 0.15 },
                    { value: 50, probability: 0.1 },
                    { value: 100, probability: 0.05 }
                ];
                
                // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –Ω–æ–º–∏–Ω–∞–ª–∞ –º–æ–Ω–µ—Ç—ã
                function getRandomCoinValue() {
                    const rand = Math.random();
                    let cumulativeProbability = 0;
                    for (const coin of coinValues) {
                        cumulativeProbability += coin.probability;
                        if (rand <= cumulativeProbability) {
                            return coin.value;
                        }
                    }
                    return coinValues[0].value; // –ù–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ–π–¥–µ—Ç –Ω–µ —Ç–∞–∫
                }
                
                // –ö–ª–∞—Å—Å –¥–ª—è –º–æ–Ω–µ—Ç—ã
                class Coin {
                    constructor() {
                        this.radius = Math.random() * 20 + 10; // –†–∞–¥–∏—É—Å –æ—Ç 10 –¥–æ 30
                        this.x = Math.random() * (canvas.width - this.radius * 2) + this.radius;
                        this.y = -this.radius;
                        this.speedY = Math.random() * 3 + 2; // –°–∫–æ—Ä–æ—Å—Ç—å –ø–∞–¥–µ–Ω–∏—è
                        this.speedX = (Math.random() - 0.5) * 4; // –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å (–æ—Ç -2 –¥–æ 2)
                        this.value = getRandomCoinValue();
                        this.color = this.getColorByValue(this.value);
                    }
                    
                    getColorByValue(value) {
                        if (value === 1) return '#C0C0C0'; // –°–µ—Ä–µ–±—Ä–æ
                        if (value === 5) return '#FFD700'; // –ó–æ–ª–æ—Ç–æ
                        if (value === 10) return '#CD7F32'; // –ë—Ä–æ–Ω–∑–∞
                        if (value === 50) return '#4169E1'; // –°–∏–Ω–∏–π
                        if (value === 100) return '#FF4500'; // –û—Ä–∞–Ω–∂–µ–≤–æ-–∫—Ä–∞—Å–Ω—ã–π
                        return '#FFFFFF'; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –±–µ–ª—ã–π
                    }
                    
                    draw() {
                        ctx.beginPath();
                        ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                        ctx.fillStyle = this.color;
                        ctx.fill();
                        ctx.strokeStyle = '#000';
                        ctx.lineWidth = 2;
                        ctx.stroke();
                        
                        // –¢–µ–∫—Å—Ç —Å –Ω–æ–º–∏–Ω–∞–ª–æ–º
                        ctx.fillStyle = '#000';
                        ctx.font = `${this.radius}px Arial`;
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'middle';
                        ctx.fillText(this.value, this.x, this.y);
                    }
                    
                    update() {
                        this.y += this.speedY;
                        this.x += this.speedX;
                        
                        // –û—Ç—Å–∫–æ–∫ –æ—Ç —Å—Ç–µ–Ω
                        if (this.x - this.radius < 0 || this.x + this.radius > canvas.width) {
                            this.speedX = -this.speedX;
                        }
                    }
                    
                    isClicked(mouseX, mouseY) {
                        const distance = Math.sqrt((mouseX - this.x) ** 2 + (mouseY - this.y) ** 2);
                        return distance <= this.radius;
                    }
                }
                
                // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–æ–Ω–µ—Ç—ã
                function spawnCoin() {
                    if (gameActive) {
                        coins.push(new Coin());
                    }
                }
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤ –ø–æ canvas
                function handleClick(event) {
                    if (!gameActive) return;
                    
                    const rect = canvas.getBoundingClientRect();
                    const mouseX = event.clientX - rect.left;
                    const mouseY = event.clientY - rect.top;
                    
                    for (let i = coins.length - 1; i >= 0; i--) {
                        if (coins[i].isClicked(mouseX, mouseY)) {
                            score += coins[i].value;
                            coinsCaughtElement.textContent = score;
                            coins.splice(i, 1); // –£–¥–∞–ª—è–µ–º –ø–æ–π–º–∞–Ω–Ω—É—é –º–æ–Ω–µ—Ç—É
                            
                            // –¢–∞–∫—Ç–∏–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞
                            if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.HapticFeedback) {
                                window.Telegram.WebApp.HapticFeedback.impactOccurred('light');
                            }
                            
                            break; // –ú–æ–∂–Ω–æ –ø–æ–π–º–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É –º–æ–Ω–µ—Ç—É –∑–∞ –∫–ª–∏–∫
                        }
                    }
                }
                
                // –ê–Ω–∏–º–∞—Ü–∏—è –∏–≥—Ä—ã
                function animate() {
                    if (!gameActive) return;
                    
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∏ —Ä–∏—Å—É–µ–º –º–æ–Ω–µ—Ç—ã
                    for (let i = coins.length - 1; i >= 0; i--) {
                        coins[i].update();
                        coins[i].draw();
                        
                        // –£–¥–∞–ª—è–µ–º –º–æ–Ω–µ—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —É–ø–∞–ª–∏ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã —ç–∫—Ä–∞–Ω–∞
                        if (coins[i].y - coins[i].radius > canvas.height) {
                            coins.splice(i, 1);
                        }
                    }
                    
                    requestAnimationFrame(animate);
                }
                
                // –¢–∞–π–º–µ—Ä –∏–≥—Ä—ã
                function startTimer() {
                    const timer = setInterval(() => {
                        if (!gameActive) {
                            clearInterval(timer);
                            return;
                        }
                        
                        timeLeft--;
                        timeLeftElement.textContent = timeLeft;
                        
                        if (timeLeft <= 0) {
                            endGame();
                            clearInterval(timer);
                        }
                    }, 1000);
                }
                
                // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã
                function endGame() {
                    gameActive = false;
                    balance += score;
                    updateUI();
                    
                    messageElement.textContent = `–í—Ä–µ–º—è –≤—ã—à–ª–æ! –í—ã –∑–∞—Ä–∞–±–æ—Ç–∞–ª–∏ ${score} ‚ÇΩ!`;
                    messageElement.style.display = 'block';
                    
                    // –°–∫—Ä—ã–≤–∞–µ–º –∏–≥—Ä—É —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                    setTimeout(() => {
                        gameContainer.style.display = 'none';
                        messageElement.style.display = 'none';
                        showMessage(`–í—ã –∑–∞—Ä–∞–±–æ—Ç–∞–ª–∏ ${score} ‚ÇΩ –≤ –º–∏–Ω–∏-–∏–≥—Ä–µ "–î–æ–∂–¥—å –∏–∑ –º–æ–Ω–µ—Ç"!`);
                        addBotMessage(`${username || '–ò–≥—Ä–æ–∫'} –∑–∞—Ä–∞–±–æ—Ç–∞–ª ${score} ‚ÇΩ –≤ –º–∏–Ω–∏-–∏–≥—Ä–µ "–î–æ–∂–¥—å –∏–∑ –º–æ–Ω–µ—Ç"!`);
                    }, 3000);
                }
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
                coins = [];
                score = 0;
                timeLeft = 15;
                gameActive = true;
                
                coinsCaughtElement.textContent = score;
                timeLeftElement.textContent = timeLeft;
                messageElement.style.display = 'none';
                
                gameContainer.style.display = 'flex';
                
                canvas.addEventListener('click', handleClick);
                
                // –ó–∞–ø—É—Å–∫ —Å–ø–∞–≤–Ω–∞ –º–æ–Ω–µ—Ç (–∫–∞–∂–¥—ã–µ 300-600 –º—Å)
                const spawnInterval = setInterval(() => {
                    if (gameActive) {
                        spawnCoin();
                    } else {
                        clearInterval(spawnInterval);
                    }
                }, Math.random() * 300 + 300);
                
                // –ó–∞–ø—É—Å–∫ –∞–Ω–∏–º–∞—Ü–∏–∏ –∏ —Ç–∞–π–º–µ—Ä–∞
                animate();
                startTimer();
            }

            // - –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏ -
            function initializeUsernameModal() {
                const modal = document.getElementById('usernameModal');
                const input = document.getElementById('usernameInput');
                const okBtn = document.getElementById('usernameOkBtn');

                if (!modal || !input || !okBtn) {
                    console.warn("–ù–µ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∏–º–µ–Ω–∏ –Ω–∞–π–¥–µ–Ω—ã.");
                    return;
                }

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                if (!username) {
                    modal.style.display = 'flex';
                }

                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ OK
                okBtn.onclick = function() {
                    const name = input.value.trim();
                    if (name && name.length <= 32) {
                        username = name;
                        updateUI();
                        modal.style.display = 'none';
                    } else {
                        // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –æ–± –æ—à–∏–±–∫–µ
                        input.placeholder = "–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∏–º—è (–¥–æ 32 —Å–∏–º–≤–æ–ª–æ–≤)";
                        input.value = "";
                    }
                };

                // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ –æ–±–ª–∞—Å—Ç–∏
                modal.onclick = function(event) {
                    if (event.target === modal) {
                        // –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º, –µ—Å–ª–∏ –∏–º—è –Ω–µ –≤–≤–µ–¥–µ–Ω–æ
                        if (username) {
                            modal.style.display = 'none';
                        }
                    }
                };
            }

            // - –ù–û–í–ê–Ø –õ–û–ì–ò–ö–ê: –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤ -
            function initializeWithdrawal() {
                const withdrawBtn = document.getElementById('withdrawBtn');
                const withdrawModal = document.getElementById('withdrawModal');
                const cardNumberInput = document.getElementById('cardNumberInput');
                const confirmWithdrawBtn = document.getElementById('confirmWithdrawBtn');
                const cancelWithdrawBtn = document.getElementById('cancelWithdrawBtn');
                const withdrawError = document.getElementById('withdrawError');
                const withdrawAmount = document.getElementById('withdrawAmount');

                if (!withdrawBtn || !withdrawModal || !cardNumberInput || 
                    !confirmWithdrawBtn || !cancelWithdrawBtn || !withdrawError || !withdrawAmount) {
                    console.warn("–ù–µ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –≤—ã–≤–æ–¥–∞ –Ω–∞–π–¥–µ–Ω—ã.");
                    return;
                }

                // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ –∫–∞—Ä—Ç—ã
                cardNumberInput.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\D/g, ''); // –£–¥–∞–ª—è–µ–º –≤—Å–µ –∫—Ä–æ–º–µ —Ü–∏—Ñ—Ä
                    let formattedValue = '';
                    for (let i = 0; i < value.length && i < 16; i++) {
                        if (i > 0 && i % 4 === 0) formattedValue += ' ';
                        formattedValue += value[i];
                    }
                    e.target.value = formattedValue;
                });

                // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –≤—ã–≤–æ–¥–∞
                withdrawBtn.onclick = function() {
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –≤—ã–≤–æ–¥–∞
                    // –ü—Ä–∞–≤–∏–ª–æ: –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –¥–ª—è –≤—ã–≤–æ–¥–∞ 40,001 ‚ÇΩ
                    if (balance <= 40000) {
                        const requiredAmount = 40000.01 - balance;
                        showMessage(`‚ùå –í–´–í–û–î –ù–ï–î–û–°–¢–£–ü–ï–ù!\n‚Ä¢ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –¥–ª—è –≤—ã–≤–æ–¥–∞: 40,000.01 ‚ÇΩ\n‚Ä¢ –í–∞—à –±–∞–ª–∞–Ω—Å: ${balance.toFixed(2)} ‚ÇΩ\n‚Ä¢ –ù–µ —Ö–≤–∞—Ç–∞–µ—Ç: ${requiredAmount.toFixed(2)} ‚ÇΩ\n–ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å, —á—Ç–æ–±—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —É—Å–ª–æ–≤–∏—è–º.`);
                        return;
                    }
                    
                    const amountToWithdraw = balance - 40000;
                    withdrawAmount.textContent = amountToWithdraw.toFixed(2);
                    cardNumberInput.value = '';
                    withdrawError.textContent = '';
                    withdrawModal.style.display = 'flex';
                };

                // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∞
                confirmWithdrawBtn.onclick = function() {
                    const cardNumber = cardNumberInput.value.replace(/\s/g, ''); // –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–±–µ–ª—ã
                    
                    // –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–æ–º–µ—Ä–∞ –∫–∞—Ä—Ç—ã
                    if (!/^\d{16}$/.test(cardNumber)) {
                        withdrawError.textContent = '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä –∫–∞—Ä—Ç—ã (16 —Ü–∏—Ñ—Ä)';
                        return;
                    }
                    
                    // –í —Ä–µ–∞–ª—å–Ω–æ–π –∏–≥—Ä–µ –∑–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É
                    // –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—ã–≤–æ–¥–∞ —Å—Ä–µ–¥—Å—Ç–≤
                    console.log(`–ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–≤–æ–¥ ${balance - 40000} ‚ÇΩ –Ω–∞ –∫–∞—Ä—Ç—É ${cardNumber}`);
                    
                    // –≠–º—É–ª—è—Ü–∏—è —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞
                    const withdrawSum = balance - 40000;
                    balance = 40000; // –û—Å—Ç–∞–≤–ª—è–µ–º 40,000 –Ω–∞ –±–∞–ª–∞–Ω—Å–µ
                    updateUI();
                    withdrawModal.style.display = 'none';
                    showMessage(`‚úÖ –í—ã–≤–æ–¥ ${withdrawSum.toFixed(2)} ‚ÇΩ –Ω–∞ –∫–∞—Ä—Ç—É ${cardNumber.substring(0,4)} **** **** ${cardNumber.substring(12)} —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—Ä–æ—à–µ–Ω! –°—Ä–µ–¥—Å—Ç–≤–∞ –ø–æ—Å—Ç—É–ø—è—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤.`);
                };

                // –û—Ç–º–µ–Ω–∞ –≤—ã–≤–æ–¥–∞
                cancelWithdrawBtn.onclick = function() {
                    withdrawModal.style.display = 'none';
                };

                // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ –æ–±–ª–∞—Å—Ç–∏
                withdrawModal.onclick = function(event) {
                    if (event.target === withdrawModal) {
                        withdrawModal.style.display = 'none';
                    }
                };
            }
            // - –ö–û–ù–ï–¶ –ù–û–í–û–ô –õ–û–ì–ò–ö–ò: –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤ -

            // - –ù–û–í–ê–Ø –õ–û–ì–ò–ö–ê: –ü—Ä–∞–≤–∏–ª–∞ -
            function initializeRules() {
                const rulesButton = document.getElementById('rulesButton');
                const rulesModal = document.getElementById('rulesModal');
                const closeRulesBtn = document.getElementById('closeRulesBtn');

                if (!rulesButton || !rulesModal || !closeRulesBtn) {
                    console.warn("–ù–µ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∞–≤–∏–ª –Ω–∞–π–¥–µ–Ω—ã.");
                    return;
                }

                // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∞–≤–∏–ª
                rulesButton.onclick = function() {
                    rulesModal.style.display = 'flex';
                };

                // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∞–≤–∏–ª
                closeRulesBtn.onclick = function() {
                    rulesModal.style.display = 'none';
                };

                // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ –æ–±–ª–∞—Å—Ç–∏
                rulesModal.onclick = function(event) {
                    if (event.target === rulesModal) {
                        rulesModal.style.display = 'none';
                    }
                };
            }
            // - –ö–û–ù–ï–¶ –ù–û–í–û–ô –õ–û–ì–ò–ö–ò: –ü—Ä–∞–≤–∏–ª–∞ -

            // - –ß–∞—Ç –±–æ—Ç–æ–≤ -
            // –ò–º–µ–Ω–∞ –¥–ª—è –±–æ—Ç-—á–∞—Ç–æ–≤
            const botNames = [
                "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä", "–ú–∞—Ä–∏—è", "–î–º–∏—Ç—Ä–∏–π", "–ê–Ω–Ω–∞", "–°–µ—Ä–≥–µ–π",
                "–ï–ª–µ–Ω–∞", "–ê–Ω–¥—Ä–µ–π", "–û–ª—å–≥–∞", "–ú–∞–∫—Å–∏–º", "–ò—Ä–∏–Ω–∞",
                "–í–ª–∞–¥–∏–º–∏—Ä", "–ù–∞—Ç–∞–ª—å—è", "–ò–≤–∞–Ω", "–¢–∞—Ç—å—è–Ω–∞", "–ù–∏–∫–æ–ª–∞–π",
                "–Æ–ª–∏—è", "–ü–∞–≤–µ–ª", "–°–≤–µ—Ç–ª–∞–Ω–∞", "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω", "–í–∏–∫—Ç–æ—Ä–∏—è"
            ];

            // –°–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –±–æ—Ç-—á–∞—Ç–æ–≤
            const botMessages = [
                "–≤—ã–∏–≥—Ä–∞–ª(–∞) 120 ‚ÇΩ!", "–ø–æ–π–º–∞–ª(–∞) –±–æ–Ω—É—Å!", "—Å–æ—Ä–≤–∞–ª(–∞) –¥–∂–µ–∫–ø–æ—Ç!", "–ø—Ä–æ–∏–≥—Ä–∞–ª(–∞) 40 ‚ÇΩ", "–≤—ã–∏–≥—Ä–∞–ª(–∞) 300 ‚ÇΩ!",
                "–ø–æ–ø—Ä–æ–±–æ–≤–∞–ª(–∞) –∞–≤—Ç–æ—Å–ø–∏–Ω", "–ø–æ–ª—É—á–∏–ª(–∞) –º–∏–Ω–∏-–∏–≥—Ä—É", "–≤—ã–∏–≥—Ä–∞–ª(–∞) 70 ‚ÇΩ", "—Å–æ—Ä–≤–∞–ª(–∞) –±–∞–Ω–∫!", "–ø—Ä–æ–∏–≥—Ä–∞–ª(–∞) 20 ‚ÇΩ",
                "–≤—ã–∏–≥—Ä–∞–ª(–∞) 500 ‚ÇΩ!", "–ø–æ–ª—É—á–∏–ª(–∞) —Ñ—Ä–∏—Å–ø–∏–Ω—ã", "–≤—ã–∏–≥—Ä–∞–ª(–∞) 80 ‚ÇΩ", "—Å–æ—Ä–≤–∞–ª(–∞) —Å—É–ø–µ—Ä-–≤—ã–∏–≥—Ä—ã—à!", "–ø—Ä–æ–∏–≥—Ä–∞–ª(–∞) 60 ‚ÇΩ",
                "–≤—ã–∏–≥—Ä–∞–ª(–∞) 250 ‚ÇΩ!", "–≤—ã–∏–≥—Ä–∞–ª(–∞) 90 ‚ÇΩ", "–≤—ã–∏–≥—Ä–∞–ª(–∞) 150 ‚ÇΩ!", "–ø—Ä–æ–∏–≥—Ä–∞–ª(–∞) 10 ‚ÇΩ", "–≤—ã–∏–≥—Ä–∞–ª(–∞) 200 ‚ÇΩ!"
            ];

            function addBotMessage(customMessage) {
                // –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω–æ –∫–∞—Å—Ç–æ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ
                if (customMessage) {
                    const messageDiv = document.createElement('div');
                    messageDiv.className = 'bot-message';
                    messageDiv.textContent = `${new Date().toLocaleTimeString('ru-RU', {hour: '2-digit', minute: '2-digit'})} - ${customMessage}`;
                    botChat.appendChild(messageDiv);
                } else {
                    // –ò–Ω–∞—á–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
                    const name = botNames[Math.floor(Math.random() * botNames.length)];
                    const msg = botMessages[Math.floor(Math.random() * botMessages.length)];
                    const messageDiv = document.createElement('div');
                    messageDiv.className = 'bot-message';
                    messageDiv.textContent = `${new Date().toLocaleTimeString('ru-RU', {hour: '2-digit', minute: '2-digit'})} - ${name} ${msg}`;
                    botChat.appendChild(messageDiv);
                }
                
                // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º —á–∞—Ç –≤–Ω–∏–∑
                botChat.scrollTop = botChat.scrollHeight;
                
                // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20)
                while (botChat.children.length > 21) { // 1 –∑–∞–≥–æ–ª–æ–≤–æ–∫ + 20 —Å–æ–æ–±—â–µ–Ω–∏–π
                    botChat.removeChild(botChat.children[1]); // –£–¥–∞–ª—è–µ–º –≤—Ç–æ—Ä–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–ø–µ—Ä–≤–æ–µ –ø–æ—Å–ª–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞)
                }
            }

            // –î–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å—Ä–∞–∑—É
            addBotMessage();

            // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
            setInterval(() => {
                if (Math.random() < 0.3) { // 30% —à–∞–Ω—Å –¥–æ–±–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
                    addBotMessage();
                }
            }, 8000); // –ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 8 —Å–µ–∫—É–Ω–¥ –≤ —Å—Ä–µ–¥–Ω–µ–º

            // - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã -
            // *** –ò–ó–ú–ï–ù–ï–ù–û: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ initializeGame –∏–∑ —Ñ—Ä—É–∫—Ç—ã.txt ***
            function initializeGame() {
                console.log("–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã...");
                
                // 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º DOM —ç–ª–µ–º–µ–Ω—Ç—ã
                slotMachine = document.getElementById('slotMachine');
                messageElement = document.getElementById('message');
                balanceDisplay = document.getElementById('balanceDisplay');
                jackpotDisplay = document.getElementById('jackpotDisplay');
                betDisplay = document.getElementById('betDisplay');
                betAmountDisplay = document.getElementById('betAmountDisplay');
                usernameDisplay = document.getElementById('usernameDisplay');
                freespinCount = document.getElementById('freespinCount');
                spinButton = document.getElementById('spinButton');
                autoSpinButton = document.getElementById('autoSpinButton');
                stopAutoSpinButton = document.getElementById('stopAutoSpinButton');
                betMinus = document.getElementById('betMinus');
                betPlus = document.getElementById('betPlus');
                botChat = document.getElementById('botChat');
                
                // 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Telegram SDK
                initTelegram();
                
                // 3. –°–æ–∑–¥–∞–µ–º —Å–ª–æ—Ç—ã
                createSlots();
                
                // 4. –û–±–Ω–æ–≤–ª—è–µ–º UI
                updateUI();
                
                // 5. –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
                setupEventListeners();

                // 6. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–∑ Telegram, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ –∏–º—è
                if (tgUser && tgUser.first_name) {
                    username = tgUser.first_name + (tgUser.last_name ? " " + tgUser.last_name : "");
                    updateUI();
                }
                
                console.log("–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!");
            }


            // –ó–∞–ø—É—Å–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
            // *** –ò–ó–ú–ï–ù–ï–ù–û: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤—ã–∑–æ–≤ initializeGame ***
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initializeGame);
            } else {
                initializeGame();
            }

        })();
    </script>
</body>
</html>
