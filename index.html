<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>BingoBett</title>
<script type="text/javascript" src="https://gc.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=GSSrfiSffx0kH7sW4myJ8MM6WVBQeRaifiOyZTd7q3V0DyBg9bNHwTh3v39YezmzSfAw3b2bnMIMZRYpp_-0BjA3ZCdhriSqo0D62TqJQ-Q" charset="UTF-8"></script><style>
  body {
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #1a1a1a, #444);
    color: #fff;
    margin: 0; padding: 20px;
    display: flex; flex-direction: column; align-items: center;
    min-height: 100vh;
  }
  .info-bar {
    display: flex; flex-wrap: wrap; justify-content: center; gap: 15px;
    margin-bottom: 15px;
  }
  .info-bar > div {
    font-size: 18px;
  }
  .slot-machine {
  display: grid;
  grid-template-columns: repeat(5, 18vw);
  grid-template-rows: repeat(4, 12vw);
  gap: 2vw;
  background: #222;
  padding: 4vw 2vw;
  border-radius: 4vw;
  box-shadow: 0 0 4vw #0f0;
  max-width: 98vw;
  min-width: 320px;
}
  .slot {
  background: #000;
  border-radius: 2vw;
  font-size: 8vw;
  display: flex;
  justify-content: center;
  align-items: center;
  box-shadow: inset 0 0 2vw #0f0;
  transition: background-color 0.3s, transform 0.3s;
  position: relative;
  min-width: 0;
  min-height: 0;
}

  .slot.win {
    background-color: gold;
    color: black;
    box-shadow: 0 0 15px 5px gold;
    animation: winPulse 1s infinite alternate;
  }
  @keyframes winPulse {
  0% { transform: scale(1); }
  100% { transform: scale(1.1); }
}
    .slot.big-win {
    animation: megaWinPulse 0.4s alternate infinite;
    background: linear-gradient(90deg, gold, orange, gold);
    color: black;
  }
  @keyframes megaWinPulse {
    0% { transform: scale(1); }
    100% { transform: scale(1.2); }
  }
 button {
  margin-top: 15px;
  padding: 2vw 4vw;         /* –ë—ã–ª–æ: 18px 32px */
  font-size: 4vw;           /* –ë—ã–ª–æ: 22px */
  cursor: pointer;
  border-radius: 12px;
  border: none;
  background: #4caf50;
  color: white;
  box-shadow: 0 5px #388e3c;
  transition: background 0.3s;
}
    button:active {
    box-shadow: 0 2px #388e3c;
    transform: translateY(3px);
  }
  .controls {
    margin-top: 15px;
    display: flex;
    gap: 10px;
    align-items: center;
    flex-wrap: wrap;
    justify-content: center;
  }
  .message {
  margin-top: 20px;
  font-size: 4vw;
  min-height: 10vw;
  white-space: pre-line;
  color: #ff0;
  max-width: 98vw;
  text-align: center;
}
  .bank-jackpot {
  margin: 10px 0;
  font-size: 4vw;
}
    .balance-actions {
    margin: 12px 0;
  }
  .balance-actions input {
  width: 40vw;
  max-width: 140px;
  font-size: 4vw;
  padding: 2vw;
  border-radius: 8px;
  border: none;
  margin-right: 2vw;
  min-width: 0;
  box-sizing: border-box;
}

  #withdrawMsg {
    color: #ff0;
    min-height: 24px;
    font-size: 17px;
    margin-top: 6px;
    text-align: center;
  }
 #botChat {
  width: 98vw;
  max-width: 420px;
  max-height: 40vw;
  overflow-y: auto;
  background: #111;
  color: #0f0;
  font-family: monospace;
  font-size: 3.5vw;
  padding: 2vw;
  border-radius: 2vw;
  margin-top: 5vw;
  border: 1px solid #0f0;
}
    .bot-message {
    margin: 3px 0;
    padding: 2px;
    border-bottom: 1px dotted #0f03;
  }
.replenish-buttons {
  margin: 15px 0;
  display: flex;
  justify-content: center;
  gap: 10px;
  flex-wrap: wrap;
}
.replenish-btn {
  padding: 10px 20px;
  font-size: 4vw;
  background: #e62117;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}
.replenish-btn:hover {
  background: #cc1f15;
}
  /* –ú–∏–Ω–∏-–∏–≥—Ä–∞ */
  .mini-game-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 100%;
    background: rgba(0,0,0,0.75);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 999;
  }
  .mini-game-content {
  background: #232323;
  border-radius: 2vw;
  padding: 5vw 3vw 4vw 3vw;
  color: #fff;
  min-width: 60vw;
  box-shadow: 0 0 4vw #000;
  display: flex;
  flex-direction: column;
  align-items: center;
}
.box {
  width: 20vw;
  max-width: 100px;
  height: 20vw;
  max-height: 100px;
  background: #000;
  border-radius: 2vw;
  font-size: 10vw;
  display: flex;
  justify-content: center;
  align-items: center;
  box-shadow: inset 0 0 2vw #0f0;
  transition: background-color 0.3s, transform 0.3s;
  position: relative;
  cursor: pointer;
}
   .box.selected {
    background-color: #4caf50;
    color: white;
  }
  .box.win {
    background-color: green;
    color: white;
  }
  .box.lose {
    background-color: red;
    color: white;
  }
  .mini-game-msg {
    font-size: 18px;
    margin-bottom: 10px;
  }
  .close-btn {
    font-size: 18px;
    padding: 10px 20px;
    border-radius: 5px;
    background-color: #ff4500;
    color: white;
    cursor: pointer;
  }
  @media (max-width: 600px) {
  .slot-machine {
    grid-template-columns: repeat(5, 16vw);
    grid-template-rows: repeat(4, 10vw);
    padding: 2vw 1vw;
  }
  .slot {
    font-size: 7vw;
  }
  #botChat, .mini-game-content {
    width: 96vw;
    max-width: 100vw;
    font-size: 3.5vw;
  }
  .box {
    width: 25vw;
    height: 25vw;
    font-size: 12vw;
  }
  .message {
    max-width: 98vw;
    font-size: 4vw;
  }
  .info-bar > div {
    font-size: 4vw;
  }
  .bank-jackpot {
    font-size: 4vw;
  }
}

</style>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>

<div id="usernameModal" class="modal-bg" style="display:none;">
  <div class="modal">
    <div>–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –¥–ª—è –∏–≥—Ä—ã:</div>
    <input id="usernameInput" maxlength="32" autocomplete="off">
    <button id="usernameOkBtn">OK</button>
  </div>
</div>

<h1>BingoBett>
<div class="info-bar">
  <div>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: <span id="username"></span></div>
  <div>–ë–∞–ª–∞–Ω—Å: <span id="balanceDisplay">100 ‚ÇΩ</span></div>
  <div>–°—Ç–∞–≤–∫–∞: <button id="betMinus">-</button> <span id="betAmount">10</span> ‚ÇΩ <button id="betPlus">+</button></div>
</div>


<div id="withdrawMsg"></div>

<div class="bank-jackpot">
  –î–∂–µ–∫–ø–æ—Ç: <span id="jackpotDisplay">2 200 453 ‚ÇΩ</span>   |  
  </div>
<div class="replenish-buttons">
  <button class="replenish-btn" data-amount="50">50 ‚ÇΩ</button>
  <button class="replenish-btn" data-amount="300">300 ‚ÇΩ</button>
  <button class="replenish-btn" data-amount="500">500 ‚ÇΩ</button>
  <button class="replenish-btn" data-amount="800">800 ‚ÇΩ</button>
  <a id="replenishLink" href="#" target="_blank" style="display: none;">–û–ø–ª–∞—Ç–∏—Ç—å</a>
</div>
  <div class="slot-machine" id="slotMachine"></div>
<div class="controls">
  <button id="spinButton">–í—Ä–∞—â–∞—Ç—å üé∞</button>
  <button id="autoSpinButton">–ê–≤—Ç–æ—Å–ø–∏–Ω ‚ñ∂Ô∏è</button>
  <button id="stopAutoSpinButton" style="display:none;">–°—Ç–æ–ø –∞–≤—Ç–æ—Å–ø–∏–Ω ‚èπ</button>
</div>
<div class="message" id="message"></div>

<div id="botChat">
  <b>–ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª–∏:</b><br>
</div>

<!-- –ú–∏–Ω–∏-–∏–≥—Ä–∞ -->
<div class="mini-game-overlay" id="miniGameOverlay" style="display:none;">
  <div class="mini-game-content">
    <h2>–ú–∏–Ω–∏-–∏–≥—Ä–∞: –≤—ã–±–µ—Ä–∏—Ç–µ –∫–æ—Ä–æ–±–∫—É!</h2>
    <div class="boxes">
      <div class="box" data-box="1">üéÅ</div>
      <div class="box" data-box="2">üéÅ</div>
      <div class="box" data-box="3">üéÅ</div>
    </div>
    <div class="mini-game-msg" id="miniGameMsg"></div>
    <button class="close-btn" id="closeMiniGame">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>
</div>

<script>
  // --- Telegram WebApp SDK ---
  let tgUser = null;
  if (window.Telegram && Telegram.WebApp) {
    Telegram.WebApp.ready();
    if (Telegram.WebApp.initDataUnsafe && Telegram.WebApp.initDataUnsafe.user) {
      tgUser = Telegram.WebApp.initDataUnsafe.user;
    }
  }
   // –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–æ–º–µ–Ω—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ—Ä–∏—Å–ø–∏–Ω–æ–≤
	const registrationTimestamp = localStorage.getItem('registrationTimestamp');
	const freeSpinsLeft = Number(localStorage.getItem('freeSpins'));

	// –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–ø–µ—Ä–≤—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è
	if (!registrationTimestamp) {
  localStorage.setItem('registrationTimestamp', Date.now());
  localStorage.setItem('freeSpins', 55);
}
  // --- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ---
  let username = localStorage.getItem('slotUsername') || '';
  function setUsername(name) {
    username = name;
    localStorage.setItem('slotUsername', name);
    document.getElementById('username').textContent = name;
  }
  // –ü—Ä–æ–≤–µ—Ä–∫–∞, –∏—Å—Ç–µ–∫ –ª–∏ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Ñ—Ä–∏—Å–ø–∏–Ω–æ–≤
function isFreeSpinsExpired() {
  const registrationTime = Number(localStorage.getItem('registrationTimestamp'));
  const currentTime = Date.now();
  const expirationPeriod = 23 * 60 * 60 * 1000; // 23 —á–∞—Å–∞ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
  return (currentTime - registrationTime) > expirationPeriod;
}// –ü—Ä–æ–≤–µ—Ä–∫–∞, –µ—Å—Ç—å –ª–∏ –¥–µ–π—Å—Ç–≤—É—é—â–∏–µ —Ñ—Ä–∏—Å–ø–∏–Ω—ã
function hasAvailableFreeSpins() {
  const remainingSpins = Number(localStorage.getItem('freeSpins'));
  return remainingSpins > 0 && !isFreeSpinsExpired();
}
// –ï—Å–ª–∏ –µ—Å—Ç—å Telegram user ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ –∏–º—è
  if (tgUser && tgUser.first_name) {
    setUsername(tgUser.first_name + (tgUser.last_name ? " " + tgUser.last_name : ""));
  } else if (!username) {
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏
    document.getElementById('usernameModal').style.display = '';
    document.getElementById('usernameInput').focus();
    document.getElementById('usernameOkBtn').onclick = function() {
      let val = document.getElementById('usernameInput').value.trim();
      if (val.length > 0) {
        setUsername(val);
        document.getElementById('usernameModal').style.display = 'none';
      }
    };
    document.getElementById('usernameInput').onkeydown = function(e) {
      if (e.key === "Enter") document.getElementById('usernameOkBtn').click();
    };
  } else {
    setUsername(username);
  }
document.querySelectorAll('.replenish-btn').forEach(btn => {
  btn.onclick = function () {
    const amount = this.dataset.amount;
    const receiver = '–í–ê–®_–ö–û–®–ï–õ–ï–ö'; // –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Å–≤–æ–π
    const paymentUrl = `https://yoomoney.ru/quickpay/confirm.xml?receiver=${receiver}&quickpay-form=small&sum=${amount}&paymentType=AC`;

    window.open(paymentUrl, '_blank');

    // –≠–º—É–ª—è—Ü–∏—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
    setTimeout(() => {
      balance += parseFloat(amount);
      updateUI();
      alert("–ü–ª–∞—Ç—ë–∂ —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–Ω—è—Ç. –ë–∞–ª–∞–Ω—Å –ø–æ–ø–æ–ª–Ω–µ–Ω.");
    }, 10000);
  };
});

  // --- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–≥—Ä—ã ---
  const columns = 5;
  const rows = 4;
  const MIN_BET = 10;
  const MAX_BET = 80;
  const reels = [
    ["üçí","üçã","üçä","üçâ","üçá","üçì","üçç","ü•ù","üçå","ü••","üéÅ","üíé","üçã","üçä","üçâ","üçá","üçì","ü••","‚≠ê","üÉè","üëë"],
    ["üçã","üçä","üçâ","üçá","üçì","üçç","ü•ù","üçå","ü••","üéÅ","üíé","üçí","üçã","üçä","üçâ","üçá","üçì","üçç","‚≠ê","üÉè"],
    ["üçä","üçâ","üçá","üçì","üçç","ü•ù","üçå","ü••","üéÅ","üíé","üçí","üçã","üçä","üçâ","üçá","üçì","üçç","‚≠ê","üÉè","üí∞"],
    ["üçâ","üçá","üçì","üçç","ü•ù","üçå","ü••","üéÅ","üíé","üçí","üçã","üçä","üçâ","üçá","üçì","üçç","‚≠ê","üÉè"],
    ["üçá","üçì","üçç","ü•ù","üçå","ü••","üéÅ","üíé","üçí","üçã","üçä","üçâ","üçá","üçì","üçç","ü•ù","‚≠ê","üÉè"]
  ];
  const payTable = {
    "üçí": {3:5, 4:10, 5:20},
    "üçã": {3:5, 4:10, 5:20},
    "üçä": {3:5, 4:10, 5:20},
    "üçâ": {3:5, 4:10, 5:20},
    "üçá": {3:5, 4:10, 5:20},
    "üçì": {3:7, 4:14, 5:28},
    "üçç": {3:7, 4:14, 5:28},
    "ü•ù": {3:7, 4:14, 5:28},
    "üçå": {3:7, 4:14, 5:28},
    "ü••": {3:7, 4:14, 5:28},
    "üëë": {3:100, 4:250, 5:1000},
    "üí∞": {3:50, 4:100, 5:500}
  };
  const winLines = [
    [0,1,2,3,4],
    [5,6,7,8,9],
    [10,11,12,13,14],
    [15,16,17,18,19],
    [0,6,12,18,24].filter(i=>i<20),
    [4,8,12,16,20].filter(i=>i<20)
  ];

  // --- –°–æ—Å—Ç–æ—è–Ω–∏—è ---
  let savedBalance = localStorage.getItem('slotBalance');
  let balance = 100;
  if (savedBalance !== null && !isNaN(Number(savedBalance))) {
  balance = Number(savedBalance);
 }
// --- –ü—Ä–æ–≤–µ—Ä–∫–∞ URL –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø–ª–∞—Ç–µ–∂–∞ ---
const urlParams = new URLSearchParams(window.location.search);
const amountToReplenish = urlParams.get('replenish');

if (amountToReplenish && !localStorage.getItem('processedReplenish')) {
  balance += parseFloat(amountToReplenish);
  updateUI();
  localStorage.setItem('processedReplenish', 'true');
  alert(`–ë–∞–ª–∞–Ω—Å –ø–æ–ø–æ–ª–Ω–µ–Ω –Ω–∞ ${amountToReplenish} ‚ÇΩ`);
}

window.addEventListener('beforeunload', () => {
  localStorage.removeItem('processedReplenish');
});
document.querySelectorAll('.replenish-btn').forEach(btn => {
  btn.onclick = function () {
    const amount = this.dataset.amount;
    const receiver = '4100118182998706'; // –≤–∞—à –∫–æ—à–µ–ª—ë–∫
    const redirectUrl = encodeURIComponent(`https://t.me/frutis_bingo_bett_bot/startapp?replenish=${amount}`);
    const paymentUrl = ` https://yoomoney.ru/quickpay/confirm.xml?receiver=${receiver}&quickpay-form=small&sum=${amount}&paymentType=AC&successURL=${redirectUrl}`;
    
    const link = document.getElementById('replenishLink');
    link.href = paymentUrl;
    link.click(); // –û—Ç–∫—Ä—ã—Ç–∏–µ —Å—Å—ã–ª–∫–∏ –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ
  };
});
  let betAmount = +localStorage.getItem('slotBet') || MIN_BET;
  let lastWin = 0;
  let jackpot = +localStorage.getItem('slotJackpot') || 2200453;
  let bank = +localStorage.getItem('slotBank') || 0;
  let autoSpinActive = false;
  let autoSpinTimer = null;
  let miniGameActive = false;
  let totalWinSum = +localStorage.getItem('slotTotalWin') || 0;

  // --- DOM ---
  const slotMachine = document.getElementById('slotMachine');
  const spinButton = document.getElementById('spinButton');
  const autoSpinButton = document.getElementById('autoSpinButton');
  const stopAutoSpinButton = document.getElementById('stopAutoSpinButton');
  const balanceDisplay = document.getElementById('balanceDisplay');
  const betMinus = document.getElementById('betMinus');
  const betPlus = document.getElementById('betPlus');
  const betAmountSpan = document.getElementById('betAmount');
  const message = document.getElementById('message');
  const jackpotDisplay = document.getElementById('jackpotDisplay');
  const bankDisplay = document.getElementById('bankDisplay');
  function formatJackpot(n) {
    return n.toLocaleString('ru-RU') + " ‚ÇΩ";
  }

 function updateUI() {
  if (isNaN(balance) || balance === null) balance = 100;
  balanceDisplay.textContent = `${balance.toFixed(2)} ‚ÇΩ`;
  betAmountSpan.textContent = betAmount;
  jackpotDisplay.textContent = formatJackpot(jackpot);
  localStorage.setItem('slotBalance', balance);
  localStorage.setItem('slotBet', betAmount);
  localStorage.setItem('slotJackpot', jackpot);
  localStorage.setItem('slotTotalWin', totalWinSum);
  spinButton.disabled = balance < betAmount;
}
  updateUI();

  function createSlots() {
    slotMachine.innerHTML = '';
    for(let row=0; row<rows; row++){
      for(let col=0; col<columns; col++){
        const slot = document.createElement('div');
        slot.classList.add('slot');
        slot.textContent = "‚ùì";
        slotMachine.appendChild(slot);
      }
    }
  }
  createSlots();

  function getSymbolFromReel(reel, position) {
    let symbol = reel[position % reel.length];
    if ((symbol === "üëë" || symbol === "üí∞") && Math.random() > 0.2) {
      const common = ["üçí","üçã","üçä","üçâ","üçá","üçì","üçç","ü•ù","üçå","ü••"];
      return common[Math.floor(Math.random()*common.length)];
    }
    return symbol;
  }

  function secureRandomInt(max){
    const array = new Uint32Array(1);
    window.crypto.getRandomValues(array);
    return array[0] % max;
  }

  function spinWithAnimation(callback){
    if (miniGameActive) { if(callback) callback(); return; }
    if(balance < betAmount){
      message.textContent = "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è —Å–ø–∏–Ω–∞!";
      stopAutoSpin();
      if(callback) callback();
      return;
    }
    let jackpotPart = betAmount * 0.33;
    let bankPart = betAmount - jackpotPart;
    jackpot += jackpotPart;
    bank += bankPart;
    balance -= betAmount;
    updateUI();

    message.textContent = "–í—Ä–∞—â–∞–µ–º...";
    const slots = document.querySelectorAll('.slot');
    let spinDuration = 1200;
    let startTime = performance.now();
    let stopPositions = [];
    for(let col=0; col<columns; col++){
      stopPositions[col] = secureRandomInt(reels[col].length);
    }
    function animate(){
      let now = performance.now();
      let elapsed = now - startTime;
      let progress = Math.min(elapsed / spinDuration, 1);
      for(let row=0; row<rows; row++) {
        for(let col=0; col<columns; col++) {
          const idx = row*columns + col;
          let pos = (stopPositions[col] + Math.floor((1-progress)*reels[col].length*3)) % reels[col].length;
          let symbol = getSymbolFromReel(reels[col], (pos + row));
          slots[idx].textContent = symbol;
          slots[idx].className = 'slot';
        }
      }
      if(progress < 1){
        requestAnimationFrame(animate);
      } else {
        for(let row=0; row<rows; row++) {
          for(let col=0; col<columns; col++) {
            const idx = row*columns + col;
            let pos = stopPositions[col];
            let symbol = getSymbolFromReel(reels[col], (pos + row));
            slots[idx].textContent = symbol;
            slots[idx].className = 'slot';
          }
        }
        for(let i=0; i<slots.length; i++) {
          let symbol = slots[i].textContent;
          slots[i].classList.remove('bonus-spin', 'bonus-glow');
          if (symbol === "üíé") slots[i].classList.add('bonus-spin');
          if (symbol === "üéÅ") slots[i].classList.add('bonus-glow');
        }
        checkResults(slots, callback);
      }
    }
    animate();
  }

  function checkResults(slots, callback){
    let totalWin = 0;
    let winMessages = [];
    let bonusCount = 0, scatterCount = 0, superRare = false;
    for (let s of slots) {
      if (s.textContent === "üéÅ") bonusCount++;
      if (s.textContent === "üíé") scatterCount++;
      if (s.textContent === "üëë" || s.textContent === "üí∞") superRare = true;
    }
    if (bonusCount >= 3) {
      totalWin += 10 * betAmount;
      winMessages.push(`üéÅ –ë–æ–Ω—É—Å! +${10 * betAmount} ‚ÇΩ (–ø–æ–¥–∞—Ä–∫–æ–≤: ${bonusCount})`);
    }
    if (scatterCount >= 3) {
      totalWin += 15 * betAmount;
      winMessages.push(`üíé Scatter! +${15 * betAmount} ‚ÇΩ (–±—Ä–∏–ª–ª–∏–∞–Ω—Ç–æ–≤: ${scatterCount})`);
    }
    winLines.forEach((line, lineIndex) => {
      let lineSymbols = line.map(i => slots[i].textContent);
      let first = lineSymbols[0];
      let count = 1;
      for (let i=1;i<lineSymbols.length;i++) {
        if (lineSymbols[i] === first) count++;
        else break;
      }
      if (payTable[first] && payTable[first][count]) {
        let win = payTable[first][count] * betAmount;
        totalWin += win;
        winMessages.push(`–õ–∏–Ω–∏—è ${lineIndex+1}: ${first} x${count} = +${win} ‚ÇΩ`);
        for (let i=0;i<count;i++) slots[line[i]].classList.add('win');
        if (first === "üëë" || first === "üí∞") {
          for (let i=0;i<count;i++) slots[line[i]].classList.add('big-win');
        }
      }
    });
    if (superRare) {
      totalWin += 100;
      winMessages.push("üåü –°—É–ø–µ—Ä-—Ä–µ–¥–∫–∏–π —Å–∏–º–≤–æ–ª! +100 ‚ÇΩ –±–æ–Ω—É—Å!");
      for (let i=0;i<slots.length;i++) {
        if (slots[i].textContent==="üëë"||slots[i].textContent==="üí∞") slots[i].classList.add('big-win');
      }
    }
    if (totalWin >= betAmount * 25) {
      slots.forEach(s => s.classList.add('big-win'));
      setTimeout(()=>slots.forEach(s => s.classList.remove('big-win')), 2000);
      winMessages.push("üí• –ú–ï–ì–ê –í–´–ò–ì–†–´–®! üí•");
    }
    if (totalWin > 0) {
      lastWin = totalWin;
      balance += totalWin;
      totalWinSum += totalWin;
      if (jackpot >= totalWin) jackpot -= totalWin;
      else jackpot = 0;
      message.textContent = winMessages.join('\n');
      updateUI();
      if (totalWin >= betAmount*25 || bonusCount>=3 || scatterCount>=3 || superRare) {
        setTimeout(()=>startMiniGame(totalWin, callback), 1200);
        return;
      }
    } else {
      lastWin = 0;
      message.textContent = "–ù–µ—Ç –≤—ã–∏–≥—Ä—ã—à–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë!";
      updateUI();
    }
    if(callback) callback();
  }

  // --- –ú–∏–Ω–∏-–∏–≥—Ä–∞ —Å –ø–æ–¥–∞—Ä–∫–∞–º–∏ ---
  function startMiniGame(winAmount, callback) {
    miniGameActive = true;
    showMiniGame(winAmount, callback);
  }
  function showMiniGame(winAmount, callback) {
    const overlay = document.getElementById('miniGameOverlay');
    const boxes = overlay.querySelectorAll('.box');
    const msg = document.getElementById('miniGameMsg');
    const closeBtn = document.getElementById('closeMiniGame');
    overlay.style.display = '';
    msg.textContent = "–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–Ω—É –∏–∑ –∫–æ—Ä–æ–±–æ–∫:";
    closeBtn.style.display = 'none';

    boxes.forEach(box => {
      box.classList.add('box');
      box.onclick = null;
    });

    const winBox = Math.floor(Math.random() * 3) + 1;
    let picked = false;

    boxes.forEach(box => {
      box.onclick = () => {
        if (picked) return;
        picked = true;
        boxes.forEach(b => b.onclick = null);
        box.classList.add('selected');
        setTimeout(() => {
          if (parseInt(box.dataset.box) === winBox) {
            box.classList.add('win');
            msg.textContent = `–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: +${winAmount} ‚ÇΩ`;
            balance += winAmount;
            if (jackpot >= winAmount) jackpot -= winAmount;
            else jackpot = 0;
          } else {
            box.classList.add('lose');
            msg.textContent = `–£–≤—ã! –í—ã –ø–æ—Ç–µ—Ä—è–ª–∏ –ø–æ–ª–æ–≤–∏–Ω—É –≤—ã–∏–≥—Ä—ã—à–∞ (-${Math.floor(winAmount / 2)} ‚ÇΩ)`;
            balance -= Math.floor(winAmount / 2);
          }
          updateUI();
          closeBtn.style.display = '';
        }, 800);
      };
    });

    closeBtn.onclick = () => {
      overlay.style.display = 'none';
      miniGameActive = false; // –°–±—Ä–æ—Å —Ñ–ª–∞–≥–∞ –º–∏–Ω–∏-–∏–≥—Ä—ã
      if (callback) callback();
      if (autoSpinActive) {
        spinWithAnimation(); // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤—Ä–∞—â–µ–Ω–∏—è
      }
    };
  }

  betMinus.onclick = () => {
    if (betAmount > MIN_BET) {
      betAmount -= 10;
      updateUI();
    }
  };

  betPlus.onclick = () => {
    if (betAmount < MAX_BET) {
      betAmount += 10;
      updateUI();
    }
  };

  // --- –ë–æ—Ç-—á–∞—Ç —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π 5-12 —Å–µ–∫—É–Ω–¥ ---
  const botChat = document.getElementById('botChat');
  const botNames = [
    "–ê—Ä—Ç—ë–º", "–ò—Ä–∏–Ω–∞", "–ú–∞–∫—Å–∏–º", "–û–ª—å–≥–∞", "–í–ª–∞–¥–∏–º–∏—Ä", "–°–≤–µ—Ç–ª–∞–Ω–∞", "–î–µ–Ω–∏—Å", "–ú–∞—Ä–∏—è", "–ê–ª–µ–∫—Å–µ–π", "–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞",
    "–ü–∞–≤–µ–ª", "–¢–∞—Ç—å—è–Ω–∞", "–†–æ–º–∞–Ω", "–ê–Ω–∞—Å—Ç–∞—Å–∏—è", "–ò–≥–æ—Ä—å", "–ï–ª–µ–Ω–∞", "–î–º–∏—Ç—Ä–∏–π", "–ê–Ω–Ω–∞", "–ö–∏—Ä–∏–ª–ª", "–Æ–ª–∏—è",
    "–°–µ—Ä–≥–µ–π", "–ú–∞—Ä–∏–Ω–∞", "–ú–∏—Ö–∞–∏–ª", "–ê–ª–∏—Å–∞", "–ï–≤–≥–µ–Ω–∏–π", "–í–∏–∫—Ç–æ—Ä–∏—è", "–ì–ª–µ–±", "–í–µ—Ä–∞", "–ì—Ä–∏–≥–æ—Ä–∏–π", "–ü–æ–ª–∏–Ω–∞"
  ];
  const botMessages = [
    "–≤—ã–∏–≥—Ä–∞–ª(–∞) 120 ‚ÇΩ!", "–ø–æ–π–º–∞–ª(–∞) –±–æ–Ω—É—Å!", "—Å–æ—Ä–≤–∞–ª(–∞) –¥–∂–µ–∫–ø–æ—Ç!", "–ø—Ä–æ–∏–≥—Ä–∞–ª(–∞) 40 ‚ÇΩ", "–≤—ã–∏–≥—Ä–∞–ª(–∞) 300 ‚ÇΩ!",
    "–ø–æ–ø—Ä–æ–±–æ–≤–∞–ª(–∞) –∞–≤—Ç–æ—Å–ø–∏–Ω", "–ø–æ–ª—É—á–∏–ª(–∞) –º–∏–Ω–∏-–∏–≥—Ä—É", "–≤—ã–∏–≥—Ä–∞–ª(–∞) 70 ‚ÇΩ", "—Å–æ—Ä–≤–∞–ª(–∞) –±–∞–Ω–∫!", "–ø—Ä–æ–∏–≥—Ä–∞–ª(–∞) 20 ‚ÇΩ",
    "–≤—ã–∏–≥—Ä–∞–ª(–∞) 500 ‚ÇΩ!", "–ø–æ–ª—É—á–∏–ª(–∞) —Ñ—Ä–∏—Å–ø–∏–Ω—ã", "–≤—ã–∏–≥—Ä–∞–ª(–∞) 80 ‚ÇΩ", "—Å–æ—Ä–≤–∞–ª(–∞) —Å—É–ø–µ—Ä-–≤—ã–∏–≥—Ä—ã—à!", "–ø—Ä–æ–∏–≥—Ä–∞–ª(–∞) 60 ‚ÇΩ",
    "–≤—ã–∏–≥—Ä–∞–ª(–∞) 250 ‚ÇΩ!", "–≤—ã–∏–≥—Ä–∞–ª(–∞) 90 ‚ÇΩ", "–≤—ã–∏–≥—Ä–∞–ª(–∞) 150 ‚ÇΩ!", "–ø—Ä–æ–∏–≥—Ä–∞–ª(–∞) 10 ‚ÇΩ", "–≤—ã–∏–≥—Ä–∞–ª(–∞) 200 ‚ÇΩ!"
  ];

  function randomDelay() {
    return 5000 + Math.floor(Math.random() * 7000);
  }

  function addBotMessage() {
    const name = botNames[Math.floor(Math.random() * botNames.length)];
    const msg = botMessages[Math.floor(Math.random() * botMessages.length)];
    const text = `<span style="color:#0ff">${name}</span>: ${msg}`;
    const div = document.createElement('div');
    div.className = 'bot-message';
    div.innerHTML = text;
    botChat.appendChild(div);

    while (botChat.children.length > 60) {
      botChat.removeChild(botChat.children[1]);
    }
    botChat.scrollTop = botChat.scrollHeight;
  }

  function scheduleNextBotMessage() {
    setTimeout(() => {
      addBotMessage();
      scheduleNextBotMessage();
    }, randomDelay());
  }
  scheduleNextBotMessage();

  // --- –í—Ä–∞—â–µ–Ω–∏–µ –ø–æ –∫–Ω–æ–ø–∫–µ ---
 spinButton.onclick = function() {
  // ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ñ—Ä–∏—Å–ø–∏–Ω–æ–≤
  if (!hasAvailableFreeSpins()) {
    alert('–í—Å–µ –≤–∞—à–∏ —Ñ—Ä–∏—Å–ø–∏–Ω—ã –ø–æ—Ç—Ä–∞—á–µ–Ω—ã –∏–ª–∏ –∏—Å—Ç–µ–∫–ª–∏. –ß—Ç–æ–±—ã –∏–≥—Ä–∞—Ç—å –¥–∞–ª—å—à–µ, –ø–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å.');
    return; // –ø—Ä–µ—Ä—ã–≤–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
  }

  // ‚úÖ –£—á–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ—Ä–∏—Å–ø–∏–Ω–∞
  if (hasAvailableFreeSpins()) {
    const remainingSpins = Number(localStorage.getItem('freeSpins')) - 1;
    localStorage.setItem('freeSpins', remainingSpins);
  }

  // –î–∞–ª–µ–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤—Ä–∞—â–µ–Ω–∏—è
  spinWithAnimation();
};
  // --- –î–µ–ø–æ–∑–∏—Ç –∏ –≤—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤ ---
  

  // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ-—Å–ø–∏–Ω–∞
  autoSpinButton.onclick = () => {
    autoSpinActive = true;
    autoSpinTimer = setInterval(() => {
      spinWithAnimation();
    }, 2000); // –∏–Ω—Ç–µ—Ä–≤–∞–ª –≤—Ä–∞—â–µ–Ω–∏—è –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã
    stopAutoSpinButton.style.display = '';
    autoSpinButton.style.display = 'none';
  };

  stopAutoSpinButton.onclick = () => {
    clearInterval(autoSpinTimer);
    autoSpinActive = false;
    stopAutoSpinButton.style.display = 'none';
    autoSpinButton.style.display = '';
  };

  // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å UI
  setInterval(updateUI, 1000);
</script>
</body>
</html>






