<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BettBoom - –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ —Å–ª–æ—Ç—ã</title>
    <style>
        /* –í–∞—à–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–∏–ª–∏ */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            color: white;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            overflow-x: hidden;
        }
        .header {
            text-align: center;
            padding: 15px;
            background: rgba(0, 0, 0, 0.7);
            border-bottom: 2px solid gold;
        }
        .header h1 {
            margin: 0;
            font-size: 2rem;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
            animation: glow 2s infinite alternate;
        }
        @keyframes glow {
            from { text-shadow: 0 0 5px rgba(255, 215, 0, 0.5); }
            to { text-shadow: 0 0 20px rgba(255, 215, 0, 0.8), 0 0 30px rgba(255, 215, 0, 0.6); }
        }
        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            gap: 20px;
        }
        .user-info {
            display: flex;
            justify-content: space-around;
            width: 90%;
            max-width: 500px;
            background: rgba(0, 0, 0, 0.6);
            padding: 15px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        .info-item {
            text-align: center;
        }
        .info-item span {
            color: var(--tg-theme-accent-text-color, #ffd700);
            font-weight: bold;
            text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
        }
        .slot-machine {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 5px;
            width: 90%;
            max-width: 500px;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 15px;
            border: 2px solid gold;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }
        .slot {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }
        .slot.win {
            animation: winAnimation 0.5s ease-in-out;
            background: rgba(255, 215, 0, 0.2);
        }
        @keyframes winAnimation {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        .controls {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            width: 90%;
            max-width: 500px;
        }
        button {
            padding: 12px 20px;
            font-size: 14px;
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.4);
        }
        button:active {
            transform: translateY(0);
        }
        .replenish-btn {
            background: linear-gradient(45deg, #2196F3, #1976D2);
        }
        .auto-spin-btn {
            background: linear-gradient(45deg, #FF9800, #F57C00);
        }
        .stop-auto-btn {
            background: linear-gradient(45deg, #f44336, #d32f2f);
        }
        .message {
            margin: 15px 0;
            min-height: 2em;
            text-align: center;
            color: #ffeb3b;
            font-size: 14px;
            max-width: 90vw;
            word-wrap: break-word;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        #botChat {
            width: 90%;
            max-width: 400px;
            height: 80px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 10px;
            padding: 10px;
            margin-top: 10px;
            overflow-y: auto;
            font-size: 11px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .bot-message {
            margin-bottom: 3px;
            color: #bbb;
        }
        .modal-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .modal {
            background: #333;
            padding: 25px;
            border-radius: 15px;
            color: white;
            min-width: 300px;
            max-width: 90vw;
            text-align: center;
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .modal input {
            margin: 15px 0;
            padding: 12px;
            font-size: 16px;
            border-radius: 8px;
            border: 1px solid #555;
            width: 220px;
            background: #222;
            color: white;
        }
        .modal button {
            padding: 10px 20px;
            font-size: 14px;
            background: #4caf50;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin: 6px;
        }
        .modal button.cancel {
            background: #f44336;
        }
        /* –£–ª—É—á—à–µ–Ω–Ω–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è */
        #inGameReplenishModal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        /* –ú–∏–Ω–∏-–∏–≥—Ä–∞ "–î–æ–∂–¥—å –º–æ–Ω–µ—Ç" */
        #coinRainOverlay {
            background: rgba(0, 0, 0, 0.95);
        }
        #coinRainCanvas {
            width: 100%;
            height: 100%;
            cursor: pointer;
            touch-action: manipulation;
        }
        #coinRainUI {
            position: absolute;
            top: 20px;
            left: 0;
            width: 100%;
            text-align: center;
            font-size: 18px;
            color: var(--tg-theme-accent-text-color, #ffd700);
            z-index: 1001;
            pointer-events: none;
        }
        #coinRainTitle {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
            animation: coinRainTitlePulse 1s infinite alternate;
        }
        @keyframes coinRainTitlePulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.05); }
        }
        #coinRainResult {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            color: var(--tg-theme-accent-text-color, #ffd700);
            z-index: 1002;
        }
        #coinRainResultText {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        #coinRainClose {
            padding: 12px 24px;
            font-size: 16px;
            background: var(--tg-theme-button-color, #4caf50);
            color: var(--tg-theme-button-text-color, white);
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }
        .browser-notice {
            background: linear-gradient(135deg, #2196f3, #1565c0);
            color: white;
            padding: 10px;
            text-align: center;
            font-size: 12px;
        }
        .win-animation {
            animation: winPulse 0.5s ease-in-out;
        }
        @keyframes winPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        .jackpot-info {
            color: gold;
            animation: jackpotGlow 2s ease-in-out infinite alternate;
        }
        @keyframes jackpotGlow {
            0% { box-shadow: 0 0 5px rgba(255, 215, 0, 0.5); }
            100% { box-shadow: 0 0 15px rgba(255, 215, 0, 0.8); }
        }
        .freespin-info {
            color: #4caf50;
        }
        /* –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ */
        #usernameDisplay {
            color: var(--tg-theme-accent-text-color, #ffd700) !important;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
        }
        #balanceDisplay {
            color: var(--tg-theme-accent-text-color, #ffd700) !important;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
        }
        #betDisplay {
            color: var(--tg-theme-accent-text-color, #ffd700) !important;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
        }
        #betAmountDisplay {
            color: var(--tg-theme-accent-text-color, #ffd700) !important;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
        }
        .loading {
            opacity: 0;
            animation: fadeIn 0.8s ease-in-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @media (max-width: 360px) {
            .slot {
                font-size: 5vw;
            }
            .user-info {
                font-size: 11px;
            }
            button {
                font-size: 11px;
                padding: 10px 12px;
            }
        }
        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–∏–Ω–∏-–∏–≥—Ä */
        .mini-game-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .mini-game-content {
            background: #333;
            padding: 25px;
            border-radius: 15px;
            color: white;
            text-align: center;
            border: 2px solid gold;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .boxes {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }
        .box {
            font-size: 3rem;
            cursor: pointer;
            padding: 20px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        .box:hover {
            transform: scale(1.1);
            background: rgba(255, 215, 0, 0.2);
        }
        .mini-game-msg {
            font-size: 1.2rem;
            margin: 20px 0;
        }
        .win-box {
            animation: boxWin 0.5s ease-in-out;
        }
        @keyframes boxWin {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        .rules-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .rules-content {
            background: #333;
            padding: 25px;
            border-radius: 15px;
            color: white;
            max-width: 90vw;
            max-height: 80vh;
            overflow-y: auto;
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .rules-content h3 {
            color: gold;
            text-align: center;
            margin-top: 0;
        }
        .rules-content p {
            line-height: 1.5;
        }
    </style>
</head>
<body class="loading">
    <div class="browser-notice" style="display: none;">üñ•Ô∏è <strong>–õ–æ–∫–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</strong> ‚Ä¢ –ò–≥—Ä–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ</div>
    <div class="header">
        <h1>üí• BettBoom</h1>
    </div>
    <div class="game-container">
        <div class="user-info">
            <div class="info-item">–ò–≥—Ä–æ–∫: <span id="usernameDisplay">-</span></div>
            <div class="info-item">–ë–∞–ª–∞–Ω—Å: <span id="balanceDisplay">0.00</span> ‚ÇΩ</div>
            <div class="info-item">–°—Ç–∞–≤–∫–∞: <span id="betAmountDisplay">100</span> ‚ÇΩ</div>
            <div class="info-item">–§—Ä–∏—Å–ø–∏–Ω—ã: <span id="freeSpinsDisplay" class="freespin-info">0</span></div>
            <div class="info-item">–î–∂–µ–∫–ø–æ—Ç: <span id="jackpotDisplay" class="jackpot-info">0.00</span> ‚ÇΩ</div>
        </div>
        <div class="slot-machine" id="slotMachine">
            <!-- –°–ª–æ—Ç—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –∑–¥–µ—Å—å -->
        </div>
        <div class="message" id="message">üí• –ò–≥—Ä–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞! –ù–∞–∂–º–∏—Ç–µ "–ö—Ä—É—Ç–∏—Ç—å"</div>
        <div id="botChat">
            <b>üî• –ê–∫—Ç–∏–≤–Ω—ã–µ –∏–≥—Ä–æ–∫–∏:</b><br>
        </div>
        <div class="controls">
            <button id="spinButton">üé∞ –ö—Ä—É—Ç–∏—Ç—å</button>
            <button id="autoSpinButton" class="auto-spin-btn">üîÑ –ê–≤—Ç–æ</button>
            <button id="stopAutoButton" class="stop-auto-btn" style="display: none;">‚èπÔ∏è –°—Ç–æ–ø</button>
            <button id="rulesButton">üìñ –ü—Ä–∞–≤–∏–ª–∞</button>
            <button id="withdrawBtn">üí∏ –í—ã–≤–æ–¥</button>
            <button class="replenish-btn" data-amount="500">üí≥ 500 ‚ÇΩ</button>
            <button class="replenish-btn" data-amount="800">üí≥ 800 ‚ÇΩ</button>
            <button class="replenish-btn" data-amount="1000">üí≥ 1000 ‚ÇΩ</button>
            <button class="replenish-btn" data-amount="10000">üí≥ 10000 ‚ÇΩ</button>
        </div>
        <div style="display: flex; gap: 10px; margin-top: 10px;">
            <button id="decreaseBet">-</button>
            <button id="increaseBet">+</button>
        </div>
    </div>

    <!-- –ú–∏–Ω–∏-–∏–≥—Ä–∞ -->
    <div class="mini-game-overlay" id="miniGameOverlay">
        <div class="mini-game-content">
            <h3>üéÅ –ú–∏–Ω–∏-–∏–≥—Ä–∞: –≤—ã–±–µ—Ä–∏—Ç–µ –∫–æ—Ä–æ–±–∫—É!</h3>
            <div class="boxes">
                <div class="box" data-box="1">üéÅ</div>
                <div class="box" data-box="2">üéÅ</div>
                <div class="box" data-box="3">üéÅ</div>
            </div>
            <div class="mini-game-msg" id="miniGameMsg">–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–Ω—É –∏–∑ –∫–æ—Ä–æ–±–æ–∫ - –≤ –æ–¥–Ω–æ–π –∏–∑ –Ω–∏—Ö –ø—Ä–∏–∑!</div>
        </div>
    </div>

    <!-- –ú–∏–Ω–∏-–∏–≥—Ä–∞ "–î–æ–∂–¥—å –º–æ–Ω–µ—Ç" -->
    <div id="coinRainOverlay" class="mini-game-overlay" style="display: none;">
        <div id="coinRainUI">
            <div id="coinRainTitle">üí∞ –î–æ–∂–¥—å –º–æ–Ω–µ—Ç üí∞</div>
            <div>–ü–æ–π–º–∞–Ω–æ: <span id="coinsCaught">0</span> ‚ÇΩ</div>
            <div>–í—Ä–µ–º—è: <span id="timeLeft">4</span> —Å–µ–∫</div>
        </div>
        <canvas id="coinRainCanvas"></canvas>
        <div id="coinRainResult" style="display:none;">
            <div id="coinRainResultText"></div>
            <button id="coinRainClose">–ó–∞–±—Ä–∞—Ç—å –≤—ã–∏–≥—Ä—ã—à</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏ -->
    <div id="usernameModal" class="modal-bg">
        <div class="modal">
            <h3>üí• –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ BettBoom!</h3>
            <div>–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –¥–ª—è –∏–≥—Ä—ã:</div>
            <input id="usernameInput" maxlength="20" autocomplete="off" placeholder="–ò–º—è –∏–≥—Ä–æ–∫–∞">
            <button id="usernameOkBtn">‚úÖ –ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–≤–æ–¥–∞ -->
    <div id="withdrawModal" class="modal-bg" style="display:none;">
        <div class="modal">
            <h3>üí∏ –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</h3>
            <div id="withdrawWarning" style="background: rgba(255, 0, 0, 0.1); border: 1px solid red; border-radius: 5px; padding: 10px; margin: 10px 0; display: none;">
                <div style="font-weight: bold; color: red; margin-bottom: 5px;">üö´ –í–´–í–û–î –ù–ï–î–û–°–¢–£–ü–ï–ù</div>
                <div id="withdrawWarningText"></div>
            </div>
            <div id="withdrawForm">
                <div style="margin: 10px 0;">–ù–æ–º–µ—Ä –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –∫–∞—Ä—Ç—ã (16 —Ü–∏—Ñ—Ä):</div>
                <input id="cardNumberInput" maxlength="19" placeholder="1234 5678 9012 3456">
                <div style="margin: 10px 0;">–í–∞—à –±–∞–ª–∞–Ω—Å: <span id="currentBalanceDisplay">0.00</span> ‚ÇΩ<br>
                –ú–∞–∫—Å–∏–º—É–º –¥–ª—è –≤—ã–≤–æ–¥–∞: <span id="withdrawAmount">0.00</span> ‚ÇΩ</div>
                <div id="withdrawError"></div>
                <button id="confirmWithdrawBtn">üì§ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≤—ã–≤–æ–¥</button>
            </div>
            <button class="cancel" id="cancelWithdrawBtn">‚ùå –û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∞–≤–∏–ª -->
    <div id="rulesModal" class="rules-modal">
        <div class="rules-content">
            <h3>üìñ –ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã</h3>
            <p>‚Ä¢ <b>–¶–µ–ª—å –∏–≥—Ä—ã:</b> –í—ã–∏–≥—Ä—ã–≤–∞—Ç—å –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ –¥–µ–Ω–µ–≥ –≤ —Å–ª–æ—Ç–∞—Ö</p>
            <p>‚Ä¢ <b>–°—Ç–∞–≤–∫–∏:</b> –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞ 100 ‚ÇΩ, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è 10000 ‚ÇΩ</p>
            <p>‚Ä¢ <b>–í—ã–∏–≥—Ä—ã—à–∏:</b> –í—ã–∏–≥—Ä—ã—à–∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å–∏–º–≤–æ–ª–æ–≤</p>
            <p>‚Ä¢ <b>–§—Ä–∏—Å–ø–∏–Ω—ã:</b> –ü–æ–ª—É—á–∏—Ç–µ 55 –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö —Å–ø–∏–Ω–æ–≤ –∫–∞–∂–¥—ã–µ 24 —á–∞—Å–∞</p>
            <p>‚Ä¢ <b>–î–∂–µ–∫–ø–æ—Ç:</b> –°–ª—É—á–∞–π–Ω—ã–µ –∫—Ä—É–ø–Ω—ã–µ –≤—ã–∏–≥—Ä—ã—à–∏</p>
            <p>‚Ä¢ <b>–ú–∏–Ω–∏-–∏–≥—Ä—ã:</b> –°–ª—É—á–∞–π–Ω—ã–µ –±–æ–Ω—É—Å–Ω—ã–µ –∏–≥—Ä—ã</p>
            <p>‚Ä¢ <b>"–í—ã–±–µ—Ä–∏ –∫–æ—Ä–æ–±–∫—É":</b> –í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–Ω—É –∏–∑ 3 –∫–æ—Ä–æ–±–æ–∫ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–æ–Ω—É—Å–∞</p>
            <p>‚Ä¢ <b>"–î–æ–∂–¥—å –º–æ–Ω–µ—Ç":</b> –õ–æ–≤–∏—Ç–µ –ø–∞–¥–∞—é—â–∏–µ –º–æ–Ω–µ—Ç—ã –∑–∞ 4 —Å–µ–∫—É–Ω–¥—ã! –¢–∞–ø–∞–π—Ç–µ –ø–æ —ç–∫—Ä–∞–Ω—É</p>
            <p>‚Ä¢ <b>–®–∞–Ω—Å –∑–∞–ø—É—Å–∫–∞:</b> 35% –ø—Ä–∏ –≤—ã–∏–≥—Ä—ã—à–µ + 15% –±–µ–∑ –≤—ã–∏–≥—Ä—ã—à–∞ (–≤—Å–µ–≥–æ ~50%)</p>
            <p>‚Ä¢ <b>–ß–∞—Å—Ç–æ—Ç–∞:</b> –í —Å—Ä–µ–¥–Ω–µ–º –∫–∞–∂–¥—ã–µ 2-3 —Å–ø–∏–Ω–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –º–∏–Ω–∏-–∏–≥—Ä–∞</p>
            <p>‚Ä¢ –ë–æ–Ω—É—Å –æ—Ç 60% –¥–æ 240% –æ—Ç —Å—Ç–∞–≤–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Å–ø–µ—Ö–∞</p><br>
            <p><b>üèÜ –í—ã–∏–≥—Ä—ã—à–Ω—ã–µ –ª–∏–Ω–∏–∏:</b></p>
            <p>‚Ä¢ 4 –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏ (—Ä—è–¥—ã)</p>
            <p>‚Ä¢ 2 –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏ (‚Üò –∏ ‚Üô)</p>
            <div style="text-align: center; margin-top: 20px;">
                <button id="closeRulesBtn">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –£–ª—É—á—à–µ–Ω–Ω–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è -->
    <div id="inGameReplenishModal" class="modal-bg">
        <div class="modal">
            <h3>üí≥ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞</h3>
            <p>–°—É–º–º–∞: <strong id="modalAmount">0</strong> ‚ÇΩ</p>
            <div style="margin: 15px 0; padding: 10px; background: rgba(255,215,0,0.1); border-radius: 8px; border: 1px solid gold;">
                <p style="font-size: 12px; margin: 0;">
                    <strong>‚ö†Ô∏è –í–∞–∂–Ω–æ:</strong><br>
                    –ü–ª–∞—Ç–µ–∂ –±—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω —á–µ—Ä–µ–∑ –Ø–Ω–¥–µ–∫—Å.–ö–∞—Å—Å—É<br>
                    –í—ã –æ—Å—Ç–∞–Ω–µ—Ç–µ—Å—å –≤ –∏–≥—Ä–µ –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã
                </p>
            </div>
            <div style="margin: 15px 0;">
                <button id="processPaymentBtn" style="width: 100%; padding: 12px; background: linear-gradient(45deg, #4CAF50, #45a049); color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer;">
                    ‚úÖ –û–ø–ª–∞—Ç–∏—Ç—å <span id="modalAmountBtn">0</span> ‚ÇΩ
                </button>
            </div>
            <div style="text-align: center;">
                <button id="cancelPaymentBtn" style="padding: 8px 15px; background: #f44336; color: white; border: none; border-radius: 8px; cursor: pointer;">
                    ‚ùå –û—Ç–º–µ–Ω–∞
                </button>
            </div>
        </div>
    </div>

    <script>
        // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        const reels = [
            ["üçí","üçì","üçç","ü•ù","üçå","ü••","üéÅ","üíé","üçí","üçã","üçä","üçâ","üçá","üçì","üçç","ü•ù","‚≠ê","üÉè"],
            ["üçí","üçì","üçç","ü•ù","üçå","ü••","üéÅ","üíé","üçí","üçã","üçä","üçâ","üçá","üçì","üçç","ü•ù","‚≠ê","üÉè"],
            ["üçí","üçì","üçç","ü•ù","üçå","ü••","üéÅ","üíé","üçí","üçã","üçä","üçâ","üçá","üçì","üçç","ü•ù","‚≠ê","üÉè"],
            ["üçí","üçì","üçç","ü•ù","üçå","ü••","üéÅ","üíé","üçí","üçã","üçä","üçâ","üçá","üçì","üçç","ü•ù","‚≠ê","üÉè"],
            ["üçí","üçì","üçç","ü•ù","üçå","ü••","üéÅ","üíé","üçí","üçã","üçä","üçâ","üçá","üçì","üçç","ü•ù","‚≠ê","üÉè"]
        ];
        const payTable = {
            "üçí": {3:8, 4:15, 5:30},
            "üçã": {3:8, 4:15, 5:30},
            "üçä": {3:8, 4:15, 5:30},
            "üçâ": {3:8, 4:15, 5:30},
            "üçá": {3:8, 4:15, 5:30},
            "üçì": {3:12, 4:20, 5:40},
            "üçç": {3:12, 4:20, 5:40},
            "ü•ù": {3:15, 4:30, 5:60},
            "üçå": {3:15, 4:30, 5:60},
            "ü••": {3:20, 4:40, 5:80},
            "üéÅ": {3:25, 4:50, 5:100},
            "üíé": {3:30, 4:60, 5:120},
            "‚≠ê": {3:40, 4:80, 5:160},
            "üÉè": {3:50, 4:100, 5:200},
            "üëë": {3:80, 4:160, 5:320},
            "üí∞": {3:150, 4:300, 5:800}
        };

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        let balance = parseFloat(localStorage.getItem('local_slotBalance')) || 5000;
        let betAmount = 100;
        let isSpinning = false;
        let isAutoSpinning = false;
        let autoSpinInterval;
        let username = localStorage.getItem('username') || '';
        let tgUser = null;
        let isTelegramApp = false;
        let jackpot = 0;
        let lastWin = 0;
        let freeSpinsManager = new FreeSpinsManager();

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        document.addEventListener('DOMContentLoaded', function() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
            initTelegramWebApp();
            
            // –°–æ–∑–¥–∞–µ–º —Å–ª–æ—Ç—ã
            createSlots();
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            setupEventListeners();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
            initializeModals();
            
            // –ó–∞–ø—É—Å–∫ –±–æ—Ç-—á–∞—Ç–∞
            startBotChat();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            updateUI();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã
            checkPaymentReturn();
        });

        // –£–ª—É—á—à–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è —Å—Ä–µ–¥—Å—Ç–≤
        function setupReplenishButtons() {
            const replenishButtons = document.querySelectorAll('.replenish-btn');
            replenishButtons.forEach(btn => {
                btn.onclick = () => {
                    const amount = parseInt(btn.getAttribute('data-amount'));
                    console.log(`üõí –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞ ${amount} ‚ÇΩ`);
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ –∏–≥—Ä—ã
                    showInGameReplenishModal(amount);
                };
            });
        }

        function showInGameReplenishModal(amount) {
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—É–º–º—É –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
            document.getElementById('modalAmount').textContent = amount;
            document.getElementById('modalAmountBtn').textContent = amount;
            
            // –°–æ–∑–¥–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤–Ω—É—Ç—Ä–∏ –∏–≥—Ä—ã
            const modal = document.getElementById('inGameReplenishModal');
            modal.style.display = 'flex';
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            document.getElementById('processPaymentBtn').onclick = () => {
                processPayment(amount);
                modal.style.display = 'none';
            };
            
            document.getElementById('cancelPaymentBtn').onclick = () => {
                modal.style.display = 'none';
            };
        }

        function processPayment(amount) {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø—Ä–æ—Ü–µ—Å—Å–µ
            showMessage(`üí≥ –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–∞ ${amount}‚ÇΩ...`);
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –ø–ª–∞—Ç–µ–∂–∞
            const paymentId = `bingobett_${Date.now()}_${Math.random().toString(36).substring(7)}`;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–ª–∞—Ç–µ–∂–µ
            const paymentInfo = {
                id: paymentId,
                amount: amount,
                timestamp: Date.now(),
                status: 'pending'
            };
            localStorage.setItem('pendingPayment', JSON.stringify(paymentInfo));
            
            // –§–æ—Ä–º–∏—Ä—É–µ–º URL –¥–ª—è YooMoney —Å –≤–æ–∑–≤—Ä–∞—Ç–æ–º –Ω–∞ –∏–≥—Ä—É
            const successURL = `${window.location.origin}${window.location.pathname}?payment=success&amount=${amount}&id=${paymentId}`;
            
            // –°–æ–∑–¥–∞–µ–º URL –¥–ª—è –æ–ø–ª–∞—Ç—ã
            const yoomoneyUrl = `https://yoomoney.ru/quickpay/confirm.xml?receiver=4100118182998706&quickpay-form=shop&targets=BingoBett%20–ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ%20(${paymentId})&paymentType=AC&sum=${amount}&label=${paymentId}&successURL=${encodeURIComponent(successURL)}`;
            
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º –ø–ª–∞—Ç–µ–∂ –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ (–∏–ª–∏ –≤ —Ç–æ–º –∂–µ –æ–∫–Ω–µ, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
            window.open(yoomoneyUrl, '_blank');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
            showMessage(`üí≥ –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–ª–∞—Ç–µ–∂ –Ω–∞ ${amount}‚ÇΩ...
‚ö° –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≤–µ—Ä—à–∏—Ç–µ –æ–ø–ª–∞—Ç—É –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ`);
            
            // –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                checkPaymentStatus(paymentId, amount);
            }, 5000);
        }

        function checkPaymentStatus(paymentId, amount) {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É—Å–ø–µ—à–Ω—ã–π –ø–ª–∞—Ç–µ–∂ –≤ localStorage –∏–ª–∏ URL
            const pendingPayment = JSON.parse(localStorage.getItem('pendingPayment') || '{}');
            if (pendingPayment.id === paymentId && pendingPayment.status === 'pending') {
                // –ü–ª–∞—Ç–µ–∂ –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω - –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–º–µ–Ω–∏–ª –∏–ª–∏ –Ω–µ –∑–∞–≤–µ—Ä—à–∏–ª
                showMessage(`‚ùå –ü–ª–∞—Ç–µ–∂ –Ω–µ –±—ã–ª –∑–∞–≤–µ—Ä—à–µ–Ω. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.`);
            }
        }

        function initTelegramWebApp() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ Telegram WebApp
            if (typeof window.Telegram !== 'undefined' && window.Telegram.WebApp) {
                console.log('‚úÖ Telegram WebApp –æ–±–Ω–∞—Ä—É–∂–µ–Ω');
                isTelegramApp = true;
                const tg = window.Telegram.WebApp;
                tg.expand();
                tg.setHeaderColor('#1a1a2e');
                tg.setBackgroundColor('#1a1a2e');
                
                tgUser = tg.initDataUnsafe?.user;
                if (tgUser) {
                    console.log('üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å Telegram:', tgUser.first_name, tgUser.id);
                    getTelegramUsername();
                } else {
                    console.log('‚ö†Ô∏è –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã');
                }
                
                // MainButton
                if (tg.MainButton) {
                    tg.MainButton.setText('üé∞ –ö—Ä—É—Ç–∏—Ç—å');
                    tg.MainButton.show();
                    tg.MainButton.onClick(() => {
                        if (!isSpinning && spinButton) {
                            startSpin();
                        }
                    });
                    console.log('‚úÖ MainButton –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞');
                }
                
                // Haptic feedback
                if (tg.HapticFeedback && typeof tg.HapticFeedback.impactOccurred === 'function') {
                    tg.HapticFeedback.impactOccurred('medium');
                    console.log('‚úÖ Haptic feedback —Ä–∞–±–æ—Ç–∞–µ—Ç');
                }
            } else {
                console.log('‚ö†Ô∏è Telegram WebApp –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω');
                isTelegramApp = false;
                // –í–∫–ª—é—á–∞–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                document.querySelector('.browser-notice').style.display = 'block';
            }
        }

        function getTelegramUsername() {
            if (tgUser && tgUser.username) {
                username = tgUser.username;
                localStorage.setItem('username', username);
                updateUI();
            }
        }

        function createSlots() {
            const slotMachine = document.getElementById('slotMachine');
            slotMachine.innerHTML = '';
            for (let i = 0; i < 20; i++) {
                const slot = document.createElement('div');
                slot.classList.add('slot');
                slot.textContent = "üçí";
                slotMachine.appendChild(slot);
            }
        }

        function updateUI() {
            document.getElementById('usernameDisplay').textContent = username || '–ì–æ—Å—Ç—å';
            document.getElementById('balanceDisplay').textContent = balance.toFixed(2);
            document.getElementById('betAmountDisplay').textContent = betAmount;
            document.getElementById('freeSpinsDisplay').textContent = freeSpinsManager.getFreeSpins();
            document.getElementById('jackpotDisplay').textContent = jackpot.toFixed(2);
            document.getElementById('currentBalanceDisplay').textContent = balance.toFixed(2);
            document.getElementById('withdrawAmount').textContent = (balance - 40000).toFixed(2);
        }

        function showMessage(message) {
            const messageElement = document.getElementById('message');
            messageElement.innerHTML = message;
            setTimeout(() => {
                messageElement.innerHTML = '';
            }, 5000);
        }

        function addBotMessage(message) {
            const chat = document.getElementById('botChat');
            const messageElement = document.createElement('div');
            messageElement.className = 'bot-message';
            messageElement.textContent = message;
            chat.appendChild(messageElement);
            chat.scrollTop = chat.scrollHeight;
        }

        function startBotChat() {
            const botNames = ["–ê–ª–µ–∫—Å–µ–π", "–ú–∞—Ä–∏—è", "–î–º–∏—Ç—Ä–∏–π", "–ê–Ω–Ω–∞", "–°–µ—Ä–≥–µ–π", "–ï–ª–µ–Ω–∞", "–ú–∞–∫—Å–∏–º", "–û–ª—å–≥–∞", "–ò–≤–∞–Ω", "–¢–∞—Ç—å—è–Ω–∞"];
            const botMessages = [
                "–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º —Å –ø–æ–±–µ–¥–æ–π!",
                "–í—ã–∏–≥—Ä–∞–ª 1000 ‚ÇΩ!",
                "–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º —Å –¥–∂–µ–∫–ø–æ—Ç–æ–º!",
                "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑!",
                "–í—ã–∏–≥—Ä—ã—à –Ω–∞ 500 ‚ÇΩ!",
                "–°—á–∞—Å—Ç–ª–∏–≤—ã–π –∏–≥—Ä–æ–∫!",
                "–ò–≥—Ä–∞–π—Ç–µ —É—Å–µ—Ä–¥–Ω–µ–µ!",
                "–£–¥–∞—á–∞ –Ω–∞ –≤–∞—à–µ–π —Å—Ç–æ—Ä–æ–Ω–µ!",
                "–°–ø–∞—Å–∏–±–æ –∑–∞ –∏–≥—Ä—É!",
                "–í—ã –º–æ–ª–æ–¥–µ—Ü!"
            ];

            setInterval(() => {
                if (Math.random() > 0.7) {
                    const name = botNames[Math.floor(Math.random() * botNames.length)];
                    const message = botMessages[Math.floor(Math.random() * botMessages.length)];
                    addBotMessage(`${name}: ${message}`);
                }
            }, 7000);
        }

        function setupEventListeners() {
            const spinButton = document.getElementById('spinButton');
            const autoSpinButton = document.getElementById('autoSpinButton');
            const stopAutoButton = document.getElementById('stopAutoButton');
            const increaseBetButton = document.getElementById('increaseBet');
            const decreaseBetButton = document.getElementById('decreaseBet');
            const rulesButton = document.getElementById('rulesButton');
            const withdrawBtn = document.getElementById('withdrawBtn');
            const closeRulesBtn = document.getElementById('closeRulesBtn');
            const confirmWithdrawBtn = document.getElementById('confirmWithdrawBtn');
            const cancelWithdrawBtn = document.getElementById('cancelWithdrawBtn');
            const cardInput = document.getElementById('cardNumberInput');
            
            // –ö–Ω–æ–ø–∫–∏ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ –¥–∏–ª–µ—Ä–∞ (—É–ª—É—á—à–µ–Ω–Ω—ã–µ)
            setupReplenishButtons();
            
            // –ö–Ω–æ–ø–∫–∞ –≤—Ä–∞—â–µ–Ω–∏—è
            if (spinButton) {
                spinButton.onclick = () => {
                    if (!isSpinning && !isAutoSpinning) {
                        startSpin();
                    }
                };
            }
            
            // –ê–≤—Ç–æ-–≤—Ä–∞—â–µ–Ω–∏–µ
            if (autoSpinButton) {
                autoSpinButton.onclick = () => {
                    if (!isAutoSpinning) {
                        isAutoSpinning = true;
                        autoSpinButton.style.display = 'none';
                        stopAutoButton.style.display = 'inline-block';
                        autoSpinInterval = setInterval(() => {
                            if (!isSpinning) {
                                startSpin();
                            }
                        }, 1500);
                    }
                };
            }
            
            // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–≤—Ç–æ-–≤—Ä–∞—â–µ–Ω–∏—è
            if (stopAutoButton) {
                stopAutoButton.onclick = () => {
                    isAutoSpinning = false;
                    clearInterval(autoSpinInterval);
                    autoSpinButton.style.display = 'inline-block';
                    stopAutoButton.style.display = 'none';
                };
            }
            
            // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∏
            if (increaseBetButton) {
                increaseBetButton.onclick = () => {
                    if (betAmount < 10000) {
                        betAmount += 100;
                        updateUI();
                    }
                };
            }
            
            // –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∏
            if (decreaseBetButton) {
                decreaseBetButton.onclick = () => {
                    if (betAmount > 100) {
                        betAmount -= 100;
                        updateUI();
                    }
                };
            }
            
            // –ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã
            if (rulesButton) {
                rulesButton.onclick = () => {
                    document.getElementById('rulesModal').style.display = 'flex';
                };
            }
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∞–≤–∏–ª
            if (closeRulesBtn) {
                closeRulesBtn.onclick = () => {
                    document.getElementById('rulesModal').style.display = 'none';
                };
            }
            
            // –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤
            if (withdrawBtn) {
                withdrawBtn.onclick = () => {
                    document.getElementById('withdrawModal').style.display = 'flex';
                };
            }
            
            // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ –∫–∞—Ä—Ç—ã
            if (cardInput) {
                cardInput.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\D/g, '');
                    let formattedValue = '';
                    for (let i = 0; i < value.length; i++) {
                        if (i > 0 && i % 4 === 0) {
                            formattedValue += ' ';
                        }
                        formattedValue += value[i];
                    }
                    e.target.value = formattedValue;
                });
            }
            
            // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∞
            if (confirmWithdrawBtn) {
                confirmWithdrawBtn.onclick = () => {
                    const cardNumber = document.getElementById('cardNumberInput').value.replace(/\s/g, '');
                    const withdrawForm = document.getElementById('withdrawForm');
                    const withdrawWarning = document.getElementById('withdrawWarning');
                    const withdrawError = document.getElementById('withdrawError');
                    
                    // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –æ—à–∏–±–∫–∏
                    withdrawError.textContent = '';
                    
                    if (balance <= 40000) {
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–º –±–∞–ª–∞–Ω—Å–µ
                        const needed = 40001 - balance;
                        withdrawWarning.style.display = 'block';
                        withdrawForm.style.display = 'none';
                        let warningMessage = `<div style="margin-bottom: 10px;"><strong>–í–∞—à –±–∞–ª–∞–Ω—Å: ${balance.toFixed(2)} ‚ÇΩ</strong><br><strong>–¢—Ä–µ–±—É–µ—Ç—Å—è: 40,001.00 ‚ÇΩ</strong><br><strong style="color: red;">–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç: ${needed.toFixed(2)} ‚ÇΩ</strong></div>`;
                        
                        if (balance < 1000) {
                            warningMessage += `<div style="color: #ff6b6b;">üí° <strong>–°–æ–≤–µ—Ç:</strong> –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–¥–µ–ª–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç–∞–≤–æ–∫ –∏–ª–∏ –ø–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å –∫–Ω–æ–ø–∫–∞–º–∏ –≤—ã—à–µ.</div>`;
                        } else if (balance < 10000) {
                            warningMessage += `<div style="color: #ff9500;">üé∞ <strong>–°–æ–≤–µ—Ç:</strong> –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –∏–≥—Ä–∞—Ç—å! –í–∞–º –æ—Å—Ç–∞–ª–æ—Å—å –≤—ã–∏–≥—Ä–∞—Ç—å –µ—â–µ ${needed.toFixed(2)} ‚ÇΩ.</div>`;
                        } else if (balance < 30000) {
                            warningMessage += `<div style="color: #ff9500;">üöÄ <strong>–ü–æ—á—Ç–∏ –≥–æ—Ç–æ–≤–æ!</strong> –û—Å—Ç–∞–ª–æ—Å—å —Å–æ–≤—Å–µ–º –Ω–µ–º–Ω–æ–≥–æ - ${needed.toFixed(2)} ‚ÇΩ.</div>`;
                        } else {
                            warningMessage += `<div style="color: #ff9500;">üéØ <strong>–°–æ–≤—Å–µ–º –±–ª–∏–∑–∫–æ!</strong> –ï—â–µ ${needed.toFixed(2)} ‚ÇΩ –∏ –≤—ã–≤–æ–¥ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω!</div>`;
                        }
                        document.getElementById('withdrawWarningText').innerHTML = warningMessage;
                        showMessage(`‚ùå –í—ã–≤–æ–¥ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω! –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å: 40,001 ‚ÇΩ. –ù–µ —Ö–≤–∞—Ç–∞–µ—Ç: ${needed.toFixed(2)} ‚ÇΩ`);
                    } else {
                        // –ë–∞–ª–∞–Ω—Å –¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω –¥–ª—è –≤—ã–≤–æ–¥–∞
                        withdrawWarning.style.display = 'none';
                        withdrawForm.style.display = 'block';
                        const withdrawableAmount = balance - 40000;
                        document.getElementById('withdrawAmount').textContent = withdrawableAmount.toFixed(2);
                        cardInput.value = '';
                    }
                };
            }
            
            // –û—Ç–º–µ–Ω–∞ –≤—ã–≤–æ–¥–∞
            if (cancelWithdrawBtn) {
                cancelWithdrawBtn.onclick = () => {
                    document.getElementById('withdrawModal').style.display = 'none';
                };
            }
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –æ–±–ª–∞—Å—Ç–∏
            [document.getElementById('withdrawModal'), document.getElementById('rulesModal')].forEach(modal => {
                if (modal) {
                    modal.onclick = function(event) {
                        if (event.target === modal) {
                            modal.style.display = 'none';
                        }
                    };
                }
            });
        }

        function initializeModals() {
            // –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–º–µ–Ω–∏
            const modal = document.getElementById('usernameModal');
            const input = document.getElementById('usernameInput');
            const okBtn = document.getElementById('usernameOkBtn');
            
            if (!username) {
                modal.style.display = 'flex';
            }
            
            if (okBtn) {
                okBtn.onclick = function() {
                    const name = input.value.trim();
                    if (name && name.length <= 20) {
                        username = name;
                        localStorage.setItem('username', username);
                        updateUI();
                        modal.style.display = 'none';
                        showMessage(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${name}! –£–¥–∞—á–∏ –≤ –∏–≥—Ä–µ!`);
                    } else {
                        alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∏–º—è (–¥–æ 20 —Å–∏–º–≤–æ–ª–æ–≤)');
                    }
                };
            }
        }

        function startSpin() {
            if (isSpinning) return;
            console.log('üé∞ –ù–∞—á–∏–Ω–∞–µ–º –≤—Ä–∞—â–µ–Ω–∏–µ...');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è —Å—Ç–∞–≤–∫–∏
            const freeSpins = freeSpinsManager.getFreeSpins();
            let isUsingFreeSpin = false;
            
            if (freeSpins > 0) {
                isUsingFreeSpin = true;
                freeSpinsManager.useFreeSpins(1);
                showMessage('üéÅ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—Ä–∏—Å–ø–∏–Ω!');
            } else if (balance >= betAmount) {
                balance -= betAmount;
                updateUI();
            } else {
                showMessage('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è —Å—Ç–∞–≤–∫–∏!');
                return;
            }
            
            isSpinning = true;
            const spinButton = document.getElementById('spinButton');
            if (spinButton) {
                spinButton.disabled = true;
            }
            
            const slotElements = document.querySelectorAll('.slot');
            const slotMachine = document.getElementById('slotMachine');
            let spinCount = 0;
            const spinDuration = 2000; // 2 —Å–µ–∫—É–Ω–¥—ã
            const spinInterval = 50; // 50 –º—Å –º–µ–∂–¥—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Å–∏–º–≤–æ–ª–∞
            function getRandomSymbol() {
                const symbols = ["üçí","üçì","üçç","ü•ù","üçå","ü••","üéÅ","üíé","üçã","üçä","üçâ","üçá","‚≠ê","üÉè","üëë","üí∞"];
                return symbols[Math.floor(Math.random() * symbols.length)];
            }
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ –≤—Ä–∞—â–µ–Ω–∏—è
            function animateSpin() {
                if (spinCount >= spinDuration / spinInterval) {
                    finishSpin();
                    return;
                }
                
                slotElements.forEach((slot, index) => {
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
                    slot.textContent = getRandomSymbol();
                });
                
                spinCount++;
                setTimeout(animateSpin, spinInterval);
            }
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
            animateSpin();
            
            // –§—É–Ω–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Ä–∞—â–µ–Ω–∏—è
            function finishSpin() {
                // –ü–æ–ª—É—á–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
                const results = [];
                for (let i = 0; i < 5; i++) {
                    const reel = reels[i];
                    const result = reel[Math.floor(Math.random() * reel.length)];
                    results.push(result);
                }
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
                slotElements.forEach((slot, index) => {
                    slot.textContent = results[index % 5];
                });
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—ã–∏–≥—Ä—ã—à
                checkWin(results);
                
                isSpinning = false;
                if (spinButton) {
                    spinButton.disabled = false;
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º UI
                updateUI();
            }
        }

        function checkWin(results) {
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–∏–≥—Ä—ã—à–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π
            let totalWin = 0;
            let winLines = [];
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏
            for (let row = 0; row < 4; row++) {
                const lineSymbols = [];
                for (let col = 0; col < 5; col++) {
                    lineSymbols.push(results[col]);
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –≤—ã–∏–≥—Ä—ã—à
                const symbolCounts = {};
                lineSymbols.forEach(symbol => {
                    symbolCounts[symbol] = (symbolCounts[symbol] || 0) + 1;
                });
                
                for (const symbol in symbolCounts) {
                    const count = symbolCounts[symbol];
                    if (count >= 3 && payTable[symbol] && payTable[symbol][count]) {
                        const winAmount = payTable[symbol][count] * betAmount;
                        totalWin += winAmount;
                        winLines.push({
                            line: `–õ–∏–Ω–∏—è ${row + 1}`,
                            symbol: symbol,
                            count: count,
                            win: winAmount
                        });
                    }
                }
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏
            const diagonal1 = [results[0], results[1], results[2], results[3], results[4]];
            const diagonal2 = [results[4], results[3], results[2], results[1], results[0]];
            
            for (let i = 0; i < 2; i++) {
                const line = i === 0 ? diagonal1 : diagonal2;
                const symbolCounts = {};
                line.forEach(symbol => {
                    symbolCounts[symbol] = (symbolCounts[symbol] || 0) + 1;
                });
                
                for (const symbol in symbolCounts) {
                    const count = symbolCounts[symbol];
                    if (count >= 3 && payTable[symbol] && payTable[symbol][count]) {
                        const winAmount = payTable[symbol][count] * betAmount;
                        totalWin += winAmount;
                        winLines.push({
                            line: i === 0 ? '–î–∏–∞–≥–æ–Ω–∞–ª—å ‚Üò' : '–î–∏–∞–≥–æ–Ω–∞–ª—å ‚Üô',
                            symbol: symbol,
                            count: count,
                            win: winAmount
                        });
                    }
                }
            }
            
            // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤—ã–∏–≥—Ä—ã—à
            if (totalWin > 0) {
                balance += totalWin;
                lastWin = totalWin;
                jackpot += totalWin * 0.01; // –î–∂–µ–∫–ø–æ—Ç —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ 1% –æ—Ç –≤—ã–∏–≥—Ä—ã—à–∞
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–∏–≥—Ä—ã—à
                showMessage(`üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${totalWin.toFixed(2)} ‚ÇΩ!`);
                
                // –í—ã–¥–µ–ª—è–µ–º –≤—ã–∏–≥—Ä—ã—à–Ω—ã–µ —Å–ª–æ—Ç—ã
                const slotElements = document.querySelectorAll('.slot');
                slotElements.forEach((slot, index) => {
                    if (results[index % 5] === results[0] && results[index % 5] !== '') {
                        slot.classList.add('win');
                        setTimeout(() => {
                            slot.classList.remove('win');
                        }, 1000);
                    }
                });
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —à–∞–Ω—Å –∑–∞–ø—É—Å–∫–∞ –º–∏–Ω–∏-–∏–≥—Ä—ã
                if (Math.random() < 0.35 || totalWin >= betAmount * 10) {
                    setTimeout(() => {
                        // –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä –º–µ–∂–¥—É –º–∏–Ω–∏-–∏–≥—Ä–∞–º–∏: 40% –∫–æ—Ä–æ–±–∫–∏, 60% –¥–æ–∂–¥—å –º–æ–Ω–µ—Ç
                        if (Math.random() < 0.4) {
                            startMiniGame(totalWin * 1.2);
                        } else {
                            startCoinRainGame(totalWin * 1.2);
                        }
                    }, 2000);
                }
            } else {
                showMessage("–ù–µ –ø–æ–≤–µ–∑–ª–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑!");
                
                // –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ô –®–ê–ù–° –º–∏–Ω–∏-–∏–≥—Ä—ã –¥–∞–∂–µ –±–µ–∑ –≤—ã–∏–≥—Ä—ã—à–∞ (15%)
                if (Math.random() < 0.15) {
                    setTimeout(() => {
                        // –ß–∞—â–µ –¥–æ–∂–¥—å –º–æ–Ω–µ—Ç –ø—Ä–∏ –ø—Ä–æ–∏–≥—Ä—ã—à–µ
                        if (Math.random() < 0.7) {
                            startCoinRainGame(betAmount * 0.8); // –ë–æ–ª—å—à–∞—è —Å—É–º–º–∞ –¥–ª—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏
                        } else {
                            startMiniGame(betAmount * 0.6);
                        }
                    }, 2000);
                }
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            updateUI();
        }

        function startMiniGame(bonusAmount) {
            const overlay = document.getElementById('miniGameOverlay');
            const miniGameMsg = document.getElementById('miniGameMsg');
            const boxes = document.querySelectorAll('.box');
            
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –≤—ã–∏–≥—Ä—ã—à–∏
            boxes.forEach(box => {
                box.classList.remove('win-box');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–∏–Ω–∏-–∏–≥—Ä—É
            overlay.style.display = 'flex';
            miniGameMsg.textContent = '–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–Ω—É –∏–∑ –∫–æ—Ä–æ–±–æ–∫ - –≤ –æ–¥–Ω–æ–π –∏–∑ –Ω–∏—Ö –ø—Ä–∏–∑!';
            
            // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é –∫–æ—Ä–æ–±–∫—É —Å –ø—Ä–∏–∑–æ–º
            const prizeBox = Math.floor(Math.random() * 3) + 1;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–æ—Ä–æ–±–æ–∫
            boxes.forEach(box => {
                box.onclick = function() {
                    const selectedBox = parseInt(this.getAttribute('data-box'));
                    
                    // –û—Ç–∫–ª—é—á–∞–µ–º –≤—Å–µ –∫–æ—Ä–æ–±–∫–∏
                    boxes.forEach(b => b.onclick = null);
                    
                    if (selectedBox === prizeBox) {
                        // –í—ã–∏–≥—Ä—ã—à
                        const winAmount = bonusAmount;
                        balance += winAmount;
                        miniGameMsg.textContent = `üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${winAmount.toFixed(2)} ‚ÇΩ!`;
                        this.classList.add('win-box');
                        showMessage(`üéÅ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º —Å –±–æ–Ω—É—Å–æ–º! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${winAmount.toFixed(2)} ‚ÇΩ!`);
                    } else {
                        // –ü—Ä–æ–∏–≥—Ä—ã—à
                        miniGameMsg.textContent = `üòî –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –ø—Ä–∏–∑ –±—ã–ª –≤ –¥—Ä—É–≥–æ–π –∫–æ—Ä–æ–±–∫–µ.`;
                    }
                    
                    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–∏–Ω–∏-–∏–≥—Ä—É —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                    setTimeout(() => {
                        overlay.style.display = 'none';
                        updateUI();
                    }, 3000);
                };
            });
        }

        function startCoinRainGame(bonusAmount) {
            const overlay = document.getElementById('coinRainOverlay');
            const canvas = document.getElementById('coinRainCanvas');
            const ctx = canvas.getContext('2d');
            const coinsCaughtElement = document.getElementById('coinsCaught');
            const timeLeftElement = document.getElementById('timeLeft');
            const resultElement = document.getElementById('coinRainResult');
            const resultTextElement = document.getElementById('coinRainResultText');
            const closeResultBtn = document.getElementById('coinRainClose');
            
            if (!overlay || !canvas || !ctx || !coinsCaughtElement || !timeLeftElement) {
                console.warn("–≠–ª–µ–º–µ–Ω—Ç—ã –º–∏–Ω–∏-–∏–≥—Ä—ã '–î–æ–∂–¥—å –º–æ–Ω–µ—Ç' –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.");
                return;
            }
            
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ canvas
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
            const GAME_DURATION = 4000; // 4 —Å–µ–∫—É–Ω–¥—ã
            const COIN_VALUE = 5; // 5 —Ä—É–±–ª–µ–π –∑–∞ –º–æ–Ω–µ—Ç—É
            const MAX_TOTAL_VALUE = 800; // –º–∞–∫—Å–∏–º—É–º 800 —Ä—É–±–ª–µ–π
            const MAX_COINS = Math.floor(MAX_TOTAL_VALUE / COIN_VALUE); // 160 –º–æ–Ω–µ—Ç
            let coins = [];
            let totalCaught = 0;
            let timeLeft = 4;
            let gameActive = true;
            
            // –ö–ª–∞—Å—Å –º–æ–Ω–µ—Ç—ã
            class Coin {
                constructor() {
                    this.radius = 15 + Math.random() * 10;
                    this.x = Math.random() * (canvas.width - this.radius * 2) + this.radius;
                    this.y = -this.radius;
                    this.speedY = 2 + Math.random() * 3;
                    this.speedX = (Math.random() - 0.5) * 4;
                    this.value = COIN_VALUE;
                    this.rotation = 0;
                    this.rotationSpeed = (Math.random() - 0.5) * 0.2;
                }
                
                update() {
                    this.y += this.speedY;
                    this.x += this.speedX;
                    this.rotation += this.rotationSpeed;
                    
                    // –ü–∞–¥–µ–Ω–∏–µ –º–æ–Ω–µ—Ç—ã
                    if (this.y > canvas.height + this.radius) {
                        this.y = -this.radius;
                        this.x = Math.random() * (canvas.width - this.radius * 2) + this.radius;
                    }
                }
                
                draw() {
                    ctx.save();
                    ctx.translate(this.x, this.y);
                    ctx.rotate(this.rotation);
                    ctx.fillStyle = '#FFD700';
                    ctx.beginPath();
                    ctx.arc(0, 0, this.radius, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // –†–∏—Å—É–µ–º —Ç–µ–∫—Å—Ç –≤–Ω—É—Ç—Ä–∏ –º–æ–Ω–µ—Ç—ã
                    ctx.fillStyle = '#000';
                    ctx.font = 'bold ' + (this.radius * 0.6) + 'px Arial';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(this.value + '', 0, 0);
                    ctx.restore();
                }
            }
            
            // –°–æ–∑–¥–∞–µ–º –º–æ–Ω–µ—Ç—ã
            for (let i = 0; i < MAX_COINS; i++) {
                coins.push(new Coin());
            }
            
            // –§—É–Ω–∫—Ü–∏—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è
            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // –†–∏—Å—É–µ–º —Ñ–æ–Ω
                ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // –†–∏—Å—É–µ–º –º–æ–Ω–µ—Ç—ã
                coins.forEach(coin => {
                    coin.draw();
                });
                
                // –†–∏—Å—É–µ–º —Ç–µ–∫—Å—Ç
                ctx.fillStyle = '#FFD700';
                ctx.font = 'bold 20px Arial';
                ctx.textAlign = 'left';
                ctx.fillText(`–ü–æ–π–º–∞–Ω–æ: ${totalCaught} ‚ÇΩ`, 20, 30);
                ctx.fillText(`–í—Ä–µ–º—è: ${timeLeft} —Å–µ–∫`, 20, 60);
            }
            
            // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            function update() {
                coins.forEach(coin => {
                    coin.update();
                });
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å –∏–≥—Ä–æ–∫–æ–º (–ø—Ä–æ—Å—Ç–æ–π –≤–∞—Ä–∏–∞–Ω—Ç)
                // –í —Ä–µ–∞–ª—å–Ω–æ–π –∏–≥—Ä–µ –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –º–µ—Ö–∞–Ω–∏–∫—É
            }
            
            // –§—É–Ω–∫—Ü–∏—è –∏–≥—Ä—ã
            function gameLoop() {
                if (!gameActive) return;
                
                update();
                draw();
                
                requestAnimationFrame(gameLoop);
            }
            
            // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
            gameLoop();
            
            // –¢–∞–π–º–µ—Ä –¥–ª—è –≤—Ä–µ–º–µ–Ω–∏
            const timer = setInterval(() => {
                timeLeft--;
                timeLeftElement.textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    endCoinRainGame();
                }
            }, 1000);
            
            // –§—É–Ω–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã
            function endCoinRainGame() {
                gameActive = false;
                overlay.style.display = 'none';
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                resultTextElement.textContent = `üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –∑–∞—Ä–∞–±–æ—Ç–∞–ª–∏ ${totalCaught} ‚ÇΩ!`;
                resultElement.style.display = 'block';
                
                // –î–æ–±–∞–≤–ª—è–µ–º –≤—ã–∏–≥—Ä—ã—à –≤ –±–∞–ª–∞–Ω—Å
                balance += totalCaught;
                updateUI();
                
                // –ó–∞–∫—Ä—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
                setTimeout(() => {
                    resultElement.style.display = 'none';
                }, 5000);
            }
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤ –ø–æ –º–æ–Ω–µ—Ç–∞–º
            canvas.addEventListener('click', function(e) {
                if (!gameActive) return;
                
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å –º–æ–Ω–µ—Ç–∞–º–∏
                coins.forEach(coin => {
                    const dx = x - coin.x;
                    const dy = y - coin.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if (distance < coin.radius) {
                        // –ü–æ–π–º–∞–ª–∏ –º–æ–Ω–µ—Ç—É
                        totalCaught += coin.value;
                        coinsCaughtElement.textContent = totalCaught;
                        
                        // –°–º–µ—â–∞–µ–º –º–æ–Ω–µ—Ç—É –≤–Ω–∏–∑
                        coin.y = canvas.height + coin.radius;
                        coin.x = Math.random() * (canvas.width - coin.radius * 2) + coin.radius;
                    }
                });
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–≥—Ä—É
            overlay.style.display = 'flex';
            coinsCaughtElement.textContent = totalCaught;
            timeLeftElement.textContent = timeLeft;
            
            // –°–∫—Ä—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
            resultElement.style.display = 'none';
        }

        function checkPaymentReturn() {
            const urlParams = new URLSearchParams(window.location.search);
            const payment = urlParams.get('payment');
            const amount = urlParams.get('amount');
            const id = urlParams.get('id');
            
            if (payment === 'success' && amount && id) {
                // –£–¥–∞–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
                window.history.replaceState({}, document.title, window.location.pathname);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ —ç—Ç–æ—Ç –ø–ª–∞—Ç–µ–∂ –æ–±—Ä–∞–±–æ—Ç–∞–Ω
                const pendingPayment = JSON.parse(localStorage.getItem('pendingPayment') || '{}');
                if (pendingPayment.id === id && pendingPayment.amount == amount) {
                    // –ü–ª–∞—Ç–µ–∂ —É—Å–ø–µ—à–µ–Ω
                    balance += parseInt(amount);
                    localStorage.setItem('local_slotBalance', balance);
                    updateUI();
                    showMessage(`‚úÖ –ü–ª–∞—Ç–µ–∂ –Ω–∞ ${amount} ‚ÇΩ —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω! –ë–∞–ª–∞–Ω—Å –ø–æ–ø–æ–ª–Ω–µ–Ω.`);
                    
                    // –£–¥–∞–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–ª–∞—Ç–µ–∂–µ
                    localStorage.removeItem('pendingPayment');
                }
            }
        }

        // –ö–ª–∞—Å—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ—Ä–∏—Å–ø–∏–Ω–∞–º–∏
        class FreeSpinsManager {
            constructor() {
                this.freeSpins = localStorage.getItem('freeSpins') ? parseInt(localStorage.getItem('freeSpins')) : 0;
                this.lastFreeSpinsTime = localStorage.getItem('lastFreeSpinsTime') ? parseInt(localStorage.getItem('lastFreeSpinsTime')) : 0;
            }
            
            getFreeSpins() {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∏—Å—Ç–µ–∫ –ª–∏ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Ñ—Ä–∏—Å–ø–∏–Ω–æ–≤ (24 —á–∞—Å–∞)
                const now = Date.now();
                const twentyFourHours = 24 * 60 * 60 * 1000;
                
                if (now - this.lastFreeSpinsTime > twentyFourHours) {
                    this.freeSpins = 0;
                    this.lastFreeSpinsTime = now;
                    this.save();
                }
                
                return this.freeSpins;
            }
            
            useFreeSpins(count) {
                if (this.freeSpins >= count) {
                    this.freeSpins -= count;
                    this.save();
                }
            }
            
            addFreeSpins(count) {
                this.freeSpins += count;
                this.lastFreeSpinsTime = Date.now();
                this.save();
            }
            
            save() {
                localStorage.setItem('freeSpins', this.freeSpins);
                localStorage.setItem('lastFreeSpinsTime', this.lastFreeSpinsTime);
            }
        }
    </script>
</body>
</html>
