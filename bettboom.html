<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BettBoom - –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ —Å–ª–æ—Ç—ã</title>
  <style>
    /* –ü–æ–ª–Ω—ã–π CSS –∏–∑ –≤–∞—à–µ–≥–æ —Ñ–∞–π–ª–∞, –≤–∫–ª—é—á–∞—è —Å—Ç–∏–ª–∏ –∏–≥—Ä—ã, –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –∏ –º–∏–Ω–∏-–∏–≥—Ä */
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #1a1a2e, #16213e);
      color: white;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      overflow-x: hidden;
    }
    .header {
      text-align: center;
      padding: 15px;
      background: rgba(0, 0, 0, 0.7);
      border-bottom: 2px solid gold;
    }
    .header h1 {
      margin: 0;
      font-size: 2rem;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
      animation: glow 2s infinite alternate;
    }
    @keyframes glow {
      from {text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);}
      to {text-shadow: 0 0 20px rgba(255, 215, 0, 0.8), 0 0 30px rgba(255, 215, 0, 0.6);}
    }
    .game-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      gap: 20px;
    }
    .user-info {
      display: flex;
      justify-content: space-around;
      width: 90%;
      max-width: 500px;
      background: rgba(0, 0, 0, 0.6);
      padding: 15px;
      border-radius: 15px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 2px 10px rgba(0,0,0,0.3);
    }
    .info-item {
      text-align: center;
    }
    .info-item span {
      color: var(--tg-theme-accent-text-color, #ffd700);
      font-weight: bold;
      text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
    }
    .slot-machine {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 5px;
      width: 90%;
      max-width: 500px;
      background: rgba(0, 0, 0, 0.7);
      padding: 15px;
      border-radius: 15px;
      border: 2px solid gold;
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
    }
    .slot {
      aspect-ratio: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.5rem;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      transition: all 0.3s ease;
    }
    .slot.win {
      animation: winAnimation 0.5s ease-in-out;
      background: rgba(255, 215, 0, 0.2);
    }
    @keyframes winAnimation {
      0% {transform: scale(1);}
      50% {transform: scale(1.1);}
      100% {transform: scale(1);}
    }
    .controls {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      width: 90%;
      max-width: 500px;
    }
    button {
      padding: 12px 20px;
      font-size: 14px;
      background: linear-gradient(45deg, #4CAF50, #45a049);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: bold;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0,0,0,0.4);
    }
    button:active {
      transform: translateY(0);
    }
    .replenish-btn {
      background: linear-gradient(45deg, #2196F3, #1976D2);
    }
    .auto-spin-btn {
      background: linear-gradient(45deg, #FF9800, #F57C00);
    }
    .stop-auto-btn {
      background: linear-gradient(45deg, #f44336, #d32f2f);
    }
    .message {
      margin: 15px 0;
      min-height: 2em;
      text-align: center;
      color: #ffeb3b;
      font-size: 14px;
      max-width: 90vw;
      word-wrap: break-word;
      font-weight: bold;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
    }
    #botChat {
      width: 90%;
      max-width: 400px;
      height: 80px;
      background: rgba(0, 0, 0, 0.7);
      border-radius: 10px;
      padding: 10px;
      margin-top: 10px;
      overflow-y: auto;
      font-size: 11px;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    .bot-message {
      margin-bottom: 3px;
      color: #bbb;
    }
    .modal-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    .modal {
      background: #333;
      padding: 25px;
      border-radius: 15px;
      color: white;
      min-width: 300px;
      max-width: 90vw;
      text-align: center;
      border: 2px solid rgba(255, 255, 255, 0.3);
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    }
    .modal input {
      margin: 15px 0;
      padding: 12px;
      font-size: 16px;
      border-radius: 8px;
      border: 1px solid #555;
      width: 220px;
      background: #222;
      color: white;
    }
    .modal button {
      padding: 10px 20px;
      font-size: 14px;
      background: #4caf50;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin: 6px;
    }
    .modal button.cancel {
      background: #f44336;
    }
    /* –£–ª—É—á—à–µ–Ω–Ω–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è */
    #inGameReplenishModal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    /* –ú–∏–Ω–∏-–∏–≥—Ä–∞ "–î–æ–∂–¥—å –º–æ–Ω–µ—Ç" */
    #coinRainOverlay {
      background: rgba(0, 0, 0, 0.95);
    }
    #coinRainCanvas {
      width: 100%;
      height: 100%;
      cursor: pointer;
      touch-action: manipulation;
    }
    #coinRainUI {
      position: absolute;
      top: 20px;
      left: 0;
      width: 100%;
      text-align: center;
      font-size: 18px;
      color: var(--tg-theme-accent-text-color, #ffd700);
      z-index: 1001;
      pointer-events: none;
    }
    #coinRainTitle {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 10px;
      animation: coinRainTitlePulse 1s infinite alternate;
    }
    @keyframes coinRainTitlePulse {
      0% {transform: scale(1);}
      100% {transform: scale(1.05);}
    }
    #coinRainResult {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.9);
      padding: 30px;
      border-radius: 15px;
      text-align: center;
      color: var(--tg-theme-accent-text-color, #ffd700);
      z-index: 1002;
    }
    #coinRainResultText {
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 15px;
    }
    #coinRainClose {
      padding: 12px 24px;
      font-size: 16px;
      background: var(--tg-theme-button-color, #4caf50);
      color: var(--tg-theme-button-text-color, white);
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    .browser-notice {
      background: linear-gradient(135deg, #2196f3, #1565c0);
      color: white;
      padding: 10px;
      text-align: center;
      font-size: 12px;
    }
    .win-animation {
      animation: winPulse 0.5s ease-in-out;
    }
    @keyframes winPulse {
      0% {transform: scale(1);}
      50% {transform: scale(1.1);}
      100% {transform: scale(1);}
    }
    .jackpot-info {
      color: gold;
      animation: jackpotGlow 2s ease-in-out infinite alternate;
    }
    @keyframes jackpotGlow {
      0% {box-shadow: 0 0 5px rgba(255, 215, 0, 0.5);}
      100% {box-shadow: 0 0 15px rgba(255, 215, 0, 0.8);}
    }
    .freespin-info {
      color: #4caf50;
    }
    /* –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ */
    #usernameDisplay {
      color: var(--tg-theme-accent-text-color, #ffd700) !important;
      font-weight: bold;
      text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
    }
    #balanceDisplay {
      color: var(--tg-theme-accent-text-color, #ffd700) !important;
      font-weight: bold;
      text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
    }
    #betDisplay {
      color: var(--tg-theme-accent-text-color, #ffd700) !important;
      font-weight: bold;
      text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
    }
    #betAmountDisplay {
      color: var(--tg-theme-accent-text-color, #ffd700) !important;
      font-weight: bold;
      text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
    }
    .loading {
      opacity: 0;
      animation: fadeIn 0.8s ease-in-out forwards;
    }
    @keyframes fadeIn {
      from {opacity: 0; transform: translateY(30px);}
      to {opacity: 1; transform: translateY(0);}
    }
    @media (max-width: 360px) {
      .slot {
        font-size: 5vw;
      }
      .user-info {
        font-size: 11px;
      }
      button {
        font-size: 11px;
        padding: 10px 12px;
      }
    }
    /* –°—Ç–∏–ª–∏ –¥–ª—è –º–∏–Ω–∏-–∏–≥—Ä */
    .mini-game-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    .mini-game-content {
      background: #333;
      padding: 25px;
      border-radius: 15px;
      color: white;
      text-align: center;
      border: 2px solid gold;
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    }
    .boxes {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 20px 0;
    }
    .box {
      font-size: 3rem;
      cursor: pointer;
      padding: 20px;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.1);
      transition: all 0.3s ease;
    }
    .box:hover {
      transform: scale(1.1);
      background: rgba(255, 215, 0, 0.2);
    }
    .mini-game-msg {
      font-size: 1.2rem;
      margin: 20px 0;
    }
    .win-box {
      animation: boxWin 0.5s ease-in-out;
    }
    @keyframes boxWin {
      0% {transform: scale(1);}
      50% {transform: scale(1.2);}
      100% {transform: scale(1);}
    }
    .rules-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    .rules-content {
      background: #333;
      padding: 25px;
      border-radius: 15px;
      color: white;
      max-width: 90vw;
      max-height: 80vh;
      overflow-y: auto;
      border: 2px solid rgba(255, 255, 255, 0.3);
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    }
    .rules-content h3 {
      color: gold;
      text-align: center;
      margin-top: 0;
    }
    .rules-content p {
      line-height: 1.5;
    }
  </style>
</head>
<body class="loading">
  <div class="browser-notice" style="display:none;">
    üñ•Ô∏è <strong>–õ–æ–∫–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</strong> ‚Ä¢ –ò–≥—Ä–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ
  </div>
  <div class="header"><h1>üí• BettBoom</h1></div>
  <div class="game-container">
    <div class="user-info">
      <div class="info-item">–ò–≥—Ä–æ–∫: <span id="usernameDisplay">-</span></div>
      <div class="info-item">–ë–∞–ª–∞–Ω—Å: <span id="balanceDisplay">0.00</span> ‚ÇΩ</div>
      <div class="info-item">–°—Ç–∞–≤–∫–∞: <span id="betAmountDisplay">100</span> ‚ÇΩ</div>
      <div class="info-item">–§—Ä–∏—Å–ø–∏–Ω—ã: <span id="freeSpinsDisplay" class="freespin-info">0</span></div>
      <div class="info-item">–î–∂–µ–∫–ø–æ—Ç: <span id="jackpotDisplay" class="jackpot-info">0.00</span> ‚ÇΩ</div>
    </div>
    <div class="slot-machine" id="slotMachine"></div>
    <div class="message" id="message">üí• –ò–≥—Ä–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞! –ù–∞–∂–º–∏—Ç–µ "–ö—Ä—É—Ç–∏—Ç—å"</div>
    <div id="botChat"><b>üî• –ê–∫—Ç–∏–≤–Ω—ã–µ –∏–≥—Ä–æ–∫–∏:</b><br></div>
    <div class="controls">
      <button id="spinButton">üé∞ –ö—Ä—É—Ç–∏—Ç—å</button>
      <button id="autoSpinButton" class="auto-spin-btn">üîÑ –ê–≤—Ç–æ</button>
      <button id="stopAutoButton" class="stop-auto-btn" style="display:none;">‚èπÔ∏è –°—Ç–æ–ø</button>
      <button id="rulesButton">üìñ –ü—Ä–∞–≤–∏–ª–∞</button>
      <button id="withdrawBtn">üí∏ –í—ã–≤–æ–¥</button>
      <button class="replenish-btn" data-amount="500">üí≥ 500 ‚ÇΩ</button>
      <button class="replenish-btn" data-amount="800">üí≥ 800 ‚ÇΩ</button>
      <button class="replenish-btn" data-amount="1000">üí≥ 1000 ‚ÇΩ</button>
      <button class="replenish-btn" data-amount="10000">üí≥ 10000 ‚ÇΩ</button>
    </div>
    <div style="display:flex;gap:10px;margin-top:10px;">
      <button id="decreaseBet">-</button>
      <button id="increaseBet">+</button>
    </div>
  </div>

  <!-- –ú–∏–Ω–∏-–∏–≥—Ä–∞ "–í—ã–±–µ—Ä–∏ –∫–æ—Ä–æ–±–∫—É" -->
  <div class="mini-game-overlay" id="miniGameOverlay">
    <div class="mini-game-content">
      <h3>üéÅ –ú–∏–Ω–∏-–∏–≥—Ä–∞: –≤—ã–±–µ—Ä–∏—Ç–µ –∫–æ—Ä–æ–±–∫—É!</h3>
      <div class="boxes">
        <div class="box" data-box="1">üéÅ</div>
        <div class="box" data-box="2">üéÅ</div>
        <div class="box" data-box="3">üéÅ</div>
      </div>
      <div class="mini-game-msg" id="miniGameMsg">–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–Ω—É –∏–∑ –∫–æ—Ä–æ–±–æ–∫ - –≤ –æ–¥–Ω–æ–π –∏–∑ –Ω–∏—Ö –ø—Ä–∏–∑!</div>
    </div>
  </div>

  <!-- –ú–∏–Ω–∏-–∏–≥—Ä–∞ "–î–æ–∂–¥—å –º–æ–Ω–µ—Ç" -->
  <div id="coinRainOverlay" class="mini-game-overlay" style="display:none;">
    <div id="coinRainUI">
      <div id="coinRainTitle">üí∞ –î–æ–∂–¥—å –º–æ–Ω–µ—Ç üí∞</div>
      <div>–ü–æ–π–º–∞–Ω–æ: <span id="coinsCaught">0</span> ‚ÇΩ</div>
      <div>–í—Ä–µ–º—è: <span id="timeLeft">4</span> —Å–µ–∫</div>
    </div>
    <canvas id="coinRainCanvas"></canvas>
    <div id="coinRainResult" style="display:none;">
      <div id="coinRainResultText"></div>
      <button id="coinRainClose">–ó–∞–±—Ä–∞—Ç—å –≤—ã–∏–≥—Ä—ã—à</button>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∞–≤–∏–ª -->
  <div class="rules-modal" id="rulesModal">
    <div class="rules-content">
      <h3>üìñ –ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã</h3>
      <p>1. –ò–≥—Ä–∞–π—Ç–µ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Å—Ç–∞–≤–∫–æ–π 100 ‚ÇΩ</p>
      <p>2. –í—ã–∏–≥—Ä—ã—à–∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å–∏–º–≤–æ–ª–æ–≤ –Ω–∞ –ª–∏–Ω–∏–∏</p>
      <p>3. –î–∂–µ–∫–ø–æ—Ç —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è —Å –∫–∞–∂–¥–æ–π —Å—Ç–∞–≤–∫–æ–π</p>
      <p>4. –ü—Ä–∏ –≤—ã–∏–≥—Ä—ã—à–µ 3 –∏–ª–∏ –±–æ–ª–µ–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤, –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –≤—ã–∏–≥—Ä—ã—à</p>
      <p>5. –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ —Å–ø–∏–Ω—ã –∞–∫—Ç–∏–≤–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ –≤—ã–∏–≥—Ä—ã—à–µ 3 –∏–ª–∏ –±–æ–ª–µ–µ "üéÅ"</p>
      <p>6. –ú–∏–Ω–∏-–∏–≥—Ä—ã –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ –∫–Ω–æ–ø–∫–µ "–ú–∏–Ω–∏-–∏–≥—Ä—ã"</p>
      <p>7. –í—Å–µ –≤—ã–∏–≥—Ä—ã—à–∏ –º–æ–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ –Ω–∞ —Å–≤–æ–π –∫–æ—à–µ–ª–µ–∫</p>
      <p>8. –ò–≥—Ä–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</p>
      <p>9. –ü–æ–±–µ–¥–∏—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç –±–æ–Ω—É—Å—ã</p>
      <p>10. –ü—Ä–∏–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ—Å—å –ø—Ä–∞–≤–∏–ª –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</p>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è -->
  <div class="modal-bg" id="inGameReplenishModal">
    <div class="modal">
      <h2>üí≥ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞</h2>
      <input type="number" id="replenishAmount" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" min="100" max="100000">
      <div>
        <button id="confirmReplenish">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
        <button class="cancel" id="cancelReplenish">–û—Ç–º–µ–Ω–∞</button>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–≤–æ–¥–∞ -->
  <div class="modal-bg" id="withdrawModal">
    <div class="modal">
      <h2>üí∏ –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</h2>
      <p>–î–æ—Å—Ç—É–ø–Ω—ã–π –±–∞–ª–∞–Ω—Å: <span id="availableBalance">0</span> ‚ÇΩ</p>
      <input type="number" id="withdrawAmount" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" min="100" max="100000">
      <div>
        <button id="confirmWithdraw">–í—ã–≤–µ—Å—Ç–∏</button>
        <button class="cancel" id="cancelWithdraw">–û—Ç–º–µ–Ω–∞</button>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏ -->
  <div class="modal-bg" id="usernameModal">
    <div class="modal">
      <h2>üë§ –í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è</h2>
      <input type="text" id="usernameInput" placeholder="–ò–º—è –∏–≥—Ä–æ–∫–∞">
      <div>
        <button id="confirmUsername">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–±–µ–¥—ã -->
  <div class="modal-bg" id="winModal">
    <div class="modal">
      <h2>üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</h2>
      <p id="winMessage">–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ 5000 ‚ÇΩ!</p>
      <button id="closeWinModal">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
    </div>
  </div>

  <script>
    // –ò–≥—Ä–æ–≤—ã–µ —Å–∏–º–≤–æ–ª—ã –∏ —Ç–∞–±–ª–∏—Ü–∞ –≤—ã–ø–ª–∞—Ç
    const reels = [
      ["üçí","üçì","üçç","ü•ù","üçå","ü••","üéÅ","üíé","üçí","üçã","üçä","üçâ","üçá","üçì","üçç","ü•ù","‚≠ê","üÉè"],
      ["üçí","üçì","üçç","ü•ù","üçå","ü••","üéÅ","üíé","üçí","üçã","üçä","üçâ","üçá","üçì","üçç","ü•ù","‚≠ê","üÉè"],
      ["üçí","üçì","üçç","ü•ù","üçå","ü••","üéÅ","üíé","üçí","üçã","üçä","üçâ","üçá","üçì","üçç","ü•ù","‚≠ê","üÉè"],
      ["üçí","üçì","üçç","ü•ù","üçå","ü••","üéÅ","üíé","üçí","üçã","üçä","üçâ","üçá","üçì","üçç","ü•ù","‚≠ê","üÉè"],
      ["üçí","üçì","üçç","ü•ù","üçå","ü••","üéÅ","üíé","üçí","üçã","üçä","üçâ","üçá","üçì","üçç","ü•ù","‚≠ê","üÉè"]
    ];

    const payTable = {
      "üçí": {3:8, 4:15, 5:30},
      "üçã": {3:8, 4:15, 5:30},
      "üçä": {3:8, 4:15, 5:30},
      "üçâ": {3:8, 4:15, 5:30},
      "üçá": {3:8, 4:15, 5:30},
      "üçì": {3:12, 4:20, 5:40},
      "üçç": {3:12, 4:20, 5:40},
      "ü•ù": {3:15, 4:30, 5:60},
      "üçå": {3:15, 4:30, 5:60},
      "ü••": {3:20, 4:40, 5:80},
      "üéÅ": {3:25, 4:50, 5:100},
      "üíé": {3:30, 4:60, 5:120},
      "‚≠ê": {3:40, 4:80, 5:160},
      "üÉè": {3:50, 4:100, 5:200},
      "üëë": {3:80, 4:160, 5:320},
      "üí∞": {3:150, 4:300, 5:800}
    };

    // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
    let balance = parseFloat(localStorage.getItem('local_slotBalance')) || 5000;
    let betAmount = 100;
    let isSpinning = false;
    let isAutoSpinning = false;
    let autoSpinInterval;
    let username = localStorage.getItem('username') || '';
    let jackpot = 0;
    let lastWin = 0;
    let freeSpinsManager = new FreeSpinsManager();
    let botMessages = [
      "–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º —Å –Ω–æ–≤—ã–º –∏–≥—Ä–æ–∫–æ–º!",
      "–ö—Ä—É—Ç–∏–º —Å–ª–æ—Ç—ã!",
      "–°—á–∞—Å—Ç–ª–∏–≤—ã–π –≤—ã–∏–≥—Ä—ã—à!",
      "–ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã!",
      "–£–¥–∞—á–∏!",
      "–ë–æ–Ω—É—Å –∑–∞ —Å—Ç–∞–≤–∫—É!",
      "–î–∂–µ–∫–ø–æ—Ç —Ä–∞—Å—Ç–µ—Ç!",
      "–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ —Å–ø–∏–Ω—ã –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã!",
      "–ù–æ–≤—ã–π —Ä–µ–∫–æ—Ä–¥!",
      "–°—á–∞—Å—Ç–ª–∏–≤—ã–π –∏–≥—Ä–æ–∫!"
    ];
    let botChatInterval;

    // –ö–ª–∞—Å—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–µ—Å–ø–ª–∞—Ç–Ω—ã–º–∏ —Å–ø–∏–Ω–∞–º–∏
    class FreeSpinsManager {
      constructor() {
        this.freeSpins = 0;
        this.multiplier = 1;
      }

      activateFreeSpins(count) {
        this.freeSpins = count;
        this.multiplier = 1;
      }

      useFreeSpin() {
        if (this.freeSpins > 0) {
          this.freeSpins--;
          return true;
        }
        return false;
      }

      isActive() {
        return this.freeSpins > 0;
      }

      getFreeSpins() {
        return this.freeSpins;
      }
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
    function initGame() {
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      if (!username) {
        showUsernameModal();
      } else {
        updateUI();
        startBotChat();
      }
      
      // –°–æ–∑–¥–∞–µ–º —Å–ª–æ—Ç—ã
      createSlots();
      
      // –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º —Å–æ–±—ã—Ç–∏—è
      bindEvents();
      
      // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–æ—Ç-—á–∞—Ç–∞
      setInterval(updateBotChat, 5000);
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ —Å–ª–æ—Ç–æ–≤
    function createSlots() {
      const slotMachine = document.getElementById('slotMachine');
      slotMachine.innerHTML = '';
      
      for (let i = 0; i < 5; i++) {
        const slot = document.createElement('div');
        slot.className = 'slot';
        slot.id = `slot-${i}`;
        slot.textContent = '‚ùì';
        slotMachine.appendChild(slot);
      }
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    function updateUI() {
      document.getElementById('usernameDisplay').textContent = username;
      document.getElementById('balanceDisplay').textContent = balance.toFixed(2);
      document.getElementById('betAmountDisplay').textContent = betAmount;
      document.getElementById('freeSpinsDisplay').textContent = freeSpinsManager.getFreeSpins();
      document.getElementById('jackpotDisplay').textContent = jackpot.toFixed(2);
      
      // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–≤–µ—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–Ω–∞—á–µ–Ω–∏–π
      if (freeSpinsManager.isActive()) {
        document.getElementById('freeSpinsDisplay').className = 'freespin-info';
      } else {
        document.getElementById('freeSpinsDisplay').className = '';
      }
    }

    // –ü—Ä–∏–≤—è–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π
    function bindEvents() {
      document.getElementById('spinButton').addEventListener('click', spin);
      document.getElementById('autoSpinButton').addEventListener('click', startAutoSpin);
      document.getElementById('stopAutoButton').addEventListener('click', stopAutoSpin);
      document.getElementById('decreaseBet').addEventListener('click', () => changeBet(-100));
      document.getElementById('increaseBet').addEventListener('click', () => changeBet(100));
      document.getElementById('rulesButton').addEventListener('click', showRules);
      document.getElementById('withdrawBtn').addEventListener('click', showWithdrawModal);
      
      // –ü—Ä–∏–≤—è–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π –∫ –∫–Ω–æ–ø–∫–∞–º –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
      document.querySelectorAll('.replenish-btn').forEach(button => {
        button.addEventListener('click', () => {
          const amount = parseInt(button.getAttribute('data-amount'));
          showReplenishModal(amount);
        });
      });
      
      // –ü—Ä–∏–≤—è–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π –∫ –º–∏–Ω–∏-–∏–≥—Ä–∞–º
      document.getElementById('miniGameOverlay').addEventListener('click', (e) => {
        if (e.target.classList.contains('box')) {
          chooseBox(e.target);
        }
      });
      
      // –°–æ–±—ã—Ç–∏—è –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
      document.getElementById('confirmUsername').addEventListener('click', confirmUsername);
      document.getElementById('confirmReplenish').addEventListener('click', confirmReplenish);
      document.getElementById('cancelReplenish').addEventListener('click', hideReplenishModal);
      document.getElementById('confirmWithdraw').addEventListener('click', confirmWithdraw);
      document.getElementById('cancelWithdraw').addEventListener('click', hideWithdrawModal);
      document.getElementById('closeWinModal').addEventListener('click', hideWinModal);
      document.getElementById('coinRainClose').addEventListener('click', hideCoinRain);
      
      // –°–æ–±—ã—Ç–∏—è –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø–æ ESC
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          hideAllModals();
        }
      });
    }

    // –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—Ä–∞—â–µ–Ω–∏—è
    function startAutoSpin() {
      if (isSpinning) return;
      
      isAutoSpinning = true;
      document.getElementById('autoSpinButton').style.display = 'none';
      document.getElementById('stopAutoButton').style.display = 'block';
      
      autoSpinInterval = setInterval(() => {
        spin();
      }, 1500);
    }

    // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—Ä–∞—â–µ–Ω–∏—è
    function stopAutoSpin() {
      isAutoSpinning = false;
      clearInterval(autoSpinInterval);
      document.getElementById('autoSpinButton').style.display = 'block';
      document.getElementById('stopAutoButton').style.display = 'none';
    }

    // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∏
    function changeBet(amount) {
      if (isSpinning) return;
      
      betAmount += amount;
      if (betAmount < 100) betAmount = 100;
      if (betAmount > balance) betAmount = balance;
      
      updateUI();
    }

    // –í—Ä–∞—â–µ–Ω–∏–µ —Å–ª–æ—Ç–æ–≤
    function spin() {
      if (isSpinning || balance < betAmount) return;
      
      isSpinning = true;
      document.getElementById('spinButton').disabled = true;
      
      // –°–Ω–∏–º–∞–µ–º —Å—Ç–∞–≤–∫—É
      balance -= betAmount;
      updateUI();
      
      // –ü–æ–ª—É—á–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ—Ç–∞
      const results = [];
      for (let i = 0; i < 5; i++) {
        const reel = reels[i];
        const randomIndex = Math.floor(Math.random() * reel.length);
        results.push(reel[randomIndex]);
      }
      
      // –ê–Ω–∏–º–∞—Ü–∏—è –≤—Ä–∞—â–µ–Ω–∏—è
      animateSlotRotation(results);
    }

    // –ê–Ω–∏–º–∞—Ü–∏—è –≤—Ä–∞—â–µ–Ω–∏—è —Å–ª–æ—Ç–æ–≤
    function animateSlotRotation(results) {
      const slots = document.querySelectorAll('.slot');
      let spins = 0;
      const maxSpins = 20;
      
      const spinInterval = setInterval(() => {
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ª–æ—Ç—ã —Å–ª—É—á–∞–π–Ω—ã–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏
        slots.forEach((slot, index) => {
          const reel = reels[index];
          const randomIndex = Math.floor(Math.random() * reel.length);
          slot.textContent = reel[randomIndex];
        });
        
        spins++;
        
        if (spins >= maxSpins) {
          clearInterval(spinInterval);
          
          // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
          slots.forEach((slot, index) => {
            slot.textContent = results[index];
          });
          
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—ã–∏–≥—Ä—ã—à
          checkWin(results);
        }
      }, 100);
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–∏–≥—Ä—ã—à–∞
    function checkWin(results) {
      let totalWin = 0;
      let winLines = [];
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏
      for (let row = 0; row < 3; row++) {
        const line = [];
        for (let col = 0; col < 5; col++) {
          line.push(results[col]);
        }
        
        const winResult = calculateLineWin(line, row);
        if (winResult.amount > 0) {
          totalWin += winResult.amount;
          winLines.push({
            line: row,
            symbols: line,
            amount: winResult.amount
          });
        }
      }
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏
      const diagonal1 = [results[0], results[1], results[2], results[3], results[4]];
      const diagonal2 = [results[4], results[3], results[2], results[1], results[0]];
      
      const diag1Win = calculateLineWin(diagonal1, 3);
      const diag2Win = calculateLineWin(diagonal2, 4);
      
      if (diag1Win.amount > 0) {
        totalWin += diag1Win.amount;
        winLines.push({
          line: 3,
          symbols: diagonal1,
          amount: diag1Win.amount
        });
      }
      
      if (diag2Win.amount > 0) {
        totalWin += diag2Win.amount;
        winLines.push({
          line: 4,
          symbols: diagonal2,
          amount: diag2Win.amount
        });
      }
      
      // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ —Å–ø–∏–Ω—ã
      if (freeSpinsManager.isActive()) {
        totalWin *= freeSpinsManager.multiplier;
        freeSpinsManager.useFreeSpin();
      }
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å –∏ –¥–∂–µ–∫–ø–æ—Ç
      balance += totalWin;
      jackpot += betAmount * 0.05; // 5% –æ—Ç —Å—Ç–∞–≤–∫–∏
      
      // –û–±–Ω–æ–≤–ª—è–µ–º UI
      updateUI();
      
      // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –≤—ã–∏–≥—Ä—ã—à–Ω—ã–µ —Å–ª–æ—Ç—ã
      highlightWinningSlots(winLines);
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –≤—ã–∏–≥—Ä—ã—à–µ
      if (totalWin > 0) {
        showMessage(`üéâ –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${totalWin.toFixed(2)} ‚ÇΩ!`);
        showWinModal(totalWin);
      } else {
        showMessage("üòî –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑!");
      }
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–æ–Ω—É—Å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –¥–ª—è –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö —Å–ø–∏–Ω–æ–≤
      const bonusCount = results.filter(symbol => symbol === 'üéÅ').length;
      if (bonusCount >= 3) {
        freeSpinsManager.activateFreeSpins(bonusCount + 2);
        showMessage(`üéÅ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ —Å–ø–∏–Ω—ã –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã! (${bonusCount + 2} —Å–ø–∏–Ω–æ–≤)`);
        updateUI();
      }
      
      // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤—Ä–∞—â–µ–Ω–∏—è
      isSpinning = false;
      document.getElementById('spinButton').disabled = false;
    }

    // –†–∞—Å—á–µ—Ç –≤—ã–∏–≥—Ä—ã—à–∞ –¥–ª—è –ª–∏–Ω–∏–∏
    function calculateLineWin(line, lineNum) {
      let amount = 0;
      let symbolCount = {};
      
      // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞
      line.forEach(symbol => {
        symbolCount[symbol] = (symbolCount[symbol] || 0) + 1;
      });
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–π —Å–∏–º–≤–æ–ª
      for (const symbol in symbolCount) {
        const count = symbolCount[symbol];
        if (count >= 3 && payTable[symbol]) {
          amount += payTable[symbol][count] * betAmount;
        }
      }
      
      return { amount, line: lineNum };
    }

    // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –≤—ã–∏–≥—Ä—ã—à–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤
    function highlightWinningSlots(winLines) {
      const slots = document.querySelectorAll('.slot');
      
      // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫—É
      slots.forEach(slot => slot.classList.remove('win'));
      
      // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –≤—ã–∏–≥—Ä—ã—à–Ω—ã–µ —Å–ª–æ—Ç—ã
      winLines.forEach(line => {
        const startIndex = line.line === 0 ? 0 : 
                         line.line === 1 ? 1 : 
                         line.line === 2 ? 2 : 
                         line.line === 3 ? 0 : 4;
        
        for (let i = 0; i < 5; i++) {
          if (line.symbols[i] !== undefined) {
            slots[startIndex + i].classList.add('win');
          }
        }
      });
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
    function showMessage(text) {
      document.getElementById('message').textContent = text;
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–±–µ–¥—ã
    function showWinModal(amount) {
      document.getElementById('winMessage').textContent = `üéâ –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${amount.toFixed(2)} ‚ÇΩ!`;
      document.getElementById('winModal').style.display = 'flex';
    }

    // –°–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–±–µ–¥—ã
    function hideWinModal() {
      document.getElementById('winModal').style.display = 'none';
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏
    function showUsernameModal() {
      document.getElementById('usernameModal').style.display = 'flex';
    }

    // –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    function confirmUsername() {
      const nameInput = document.getElementById('usernameInput');
      if (nameInput.value.trim() !== '') {
        username = nameInput.value.trim();
        localStorage.setItem('username', username);
        document.getElementById('usernameModal').style.display = 'none';
        updateUI();
        startBotChat();
      }
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
    function showReplenishModal(amount = null) {
      const replenishModal = document.getElementById('inGameReplenishModal');
      const amountInput = document.getElementById('replenishAmount');
      
      if (amount) {
        amountInput.value = amount;
      } else {
        amountInput.value = '';
      }
      
      replenishModal.style.display = 'flex';
    }

    // –°–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
    function hideReplenishModal() {
      document.getElementById('inGameReplenishModal').style.display = 'none';
    }

    // –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
    function confirmReplenish() {
      const amountInput = document.getElementById('replenishAmount');
      const amount = parseInt(amountInput.value);
      
      if (isNaN(amount) || amount < 100) {
        showMessage("–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—É–º–º—É (–º–∏–Ω–∏–º—É–º 100 ‚ÇΩ)");
        return;
      }
      
      balance += amount;
      updateUI();
      hideReplenishModal();
      showMessage(`‚úÖ –ë–∞–ª–∞–Ω—Å –ø–æ–ø–æ–ª–Ω–µ–Ω –Ω–∞ ${amount} ‚ÇΩ!`);
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–≤–æ–¥–∞
    function showWithdrawModal() {
      document.getElementById('availableBalance').textContent = balance.toFixed(2);
      document.getElementById('withdrawModal').style.display = 'flex';
    }

    // –°–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–≤–æ–¥–∞
    function hideWithdrawModal() {
      document.getElementById('withdrawModal').style.display = 'none';
    }

    // –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≤—ã–≤–æ–¥
    function confirmWithdraw() {
      const amountInput = document.getElementById('withdrawAmount');
      const amount = parseInt(amountInput.value);
      
      if (isNaN(amount) || amount < 100 || amount > balance) {
        showMessage("–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—É–º–º—É (–æ—Ç 100 –¥–æ " + balance.toFixed(2) + " ‚ÇΩ)");
        return;
      }
      
      balance -= amount;
      updateUI();
      hideWithdrawModal();
      showMessage(`‚úÖ –í—ã–≤–æ–¥ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω –Ω–∞ ${amount} ‚ÇΩ!`);
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã
    function showRules() {
      document.getElementById('rulesModal').style.display = 'flex';
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å –º–∏–Ω–∏-–∏–≥—Ä—É "–í—ã–±–µ—Ä–∏ –∫–æ—Ä–æ–±–∫—É"
    function startMiniGame() {
      document.getElementById('miniGameOverlay').style.display = 'flex';
      document.getElementById('miniGameMsg').textContent = '–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–Ω—É –∏–∑ –∫–æ—Ä–æ–±–æ–∫ - –≤ –æ–¥–Ω–æ–π –∏–∑ –Ω–∏—Ö –ø—Ä–∏–∑!';
    }

    // –í—ã–±–æ—Ä –∫–æ—Ä–æ–±–∫–∏ –≤ –º–∏–Ω–∏-–∏–≥—Ä–µ
    function chooseBox(box) {
      const boxNumber = parseInt(box.getAttribute('data-box'));
      const winBox = Math.floor(Math.random() * 3) + 1;
      
      // –°–∫—Ä—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
      document.getElementById('miniGameMsg').textContent = '';
      
      // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –∫–æ—Ä–æ–±–∫—É
      box.classList.add('win-box');
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—ã–∏–≥—Ä—ã—à
      if (boxNumber === winBox) {
        const winAmount = Math.floor(Math.random() * 5000) + 1000;
        balance += winAmount;
        updateUI();
        showMessage(`üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${winAmount} ‚ÇΩ!`);
        document.getElementById('miniGameMsg').innerHTML = `<span style="color:#4caf50;">–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${winAmount} ‚ÇΩ!</span>`;
      } else {
        document.getElementById('miniGameMsg').innerHTML = '<span style="color:#f44336;">–ù–µ –ø–æ–≤–µ–∑–ª–æ! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.</span>';
      }
      
      // –û—Ç–∫–ª—é—á–∞–µ–º –∫–ª–∏–∫–∏
      document.querySelectorAll('.box').forEach(b => b.style.pointerEvents = 'none');
    }

    // –ó–∞–ø—É—Å–∫ –º–∏–Ω–∏-–∏–≥—Ä—ã "–î–æ–∂–¥—å –º–æ–Ω–µ—Ç"
    function startCoinRainGame() {
      document.getElementById('coinRainOverlay').style.display = 'flex';
      document.getElementById('coinRainResult').style.display = 'none';
      document.getElementById('coinsCaught').textContent = '0';
      document.getElementById('timeLeft').textContent = '4';
      
      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–∞–Ω–≤—É
      const canvas = document.getElementById('coinRainCanvas');
      const ctx = canvas.getContext('2d');
      
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–∞–Ω–≤—ã
      canvas.width = canvas.offsetWidth;
      canvas.height = canvas.offsetHeight;
      
      // –ú–æ–Ω–µ—Ç—ã
      const coins = [];
      const coinSize = 20;
      let caughtCoins = 0;
      let timeLeft = 4;
      
      // –°–æ–∑–¥–∞–µ–º –º–æ–Ω–µ—Ç—ã
      function createCoin() {
        return {
          x: Math.random() * (canvas.width - coinSize),
          y: -coinSize,
          size: coinSize,
          speed: Math.random() * 3 + 2,
          caught: false
        };
      }
      
      // –†–∏—Å—É–µ–º –º–æ–Ω–µ—Ç—É
      function drawCoin(coin) {
        ctx.beginPath();
        ctx.arc(coin.x + coin.size/2, coin.y + coin.size/2, coin.size/2, 0, Math.PI * 2);
        ctx.fillStyle = '#ffd700';
        ctx.fill();
        ctx.strokeStyle = '#ff9800';
        ctx.lineWidth = 2;
        ctx.stroke();
        
        // –†–∏—Å—É–µ–º —Ç–µ–∫—Å—Ç –Ω–∞ –º–æ–Ω–µ—Ç–µ
        ctx.font = 'bold 10px Arial';
        ctx.fillStyle = '#000';
        ctx.textAlign = 'center';
        ctx.fillText('‚ÇΩ', coin.x + coin.size/2, coin.y + coin.size/2 + 3);
      }
      
      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π –º–æ–Ω–µ—Ç
      function updateCoins() {
        for (let i = coins.length - 1; i >= 0; i--) {
          coins[i].y += coins[i].speed;
          
          // –£–¥–∞–ª—è–µ–º –º–æ–Ω–µ—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —É–ø–∞–ª–∏ –Ω–∏–∂–µ —ç–∫—Ä–∞–Ω–∞
          if (coins[i].y > canvas.height) {
            coins.splice(i, 1);
          }
        }
      }
      
      // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
      function checkCollisions() {
        for (let i = coins.length - 1; i >= 0; i--) {
          if (coins[i].caught) continue;
          
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å–ª–∏ –º–æ–Ω–µ—Ç–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –æ–±–ª–∞—Å—Ç–∏ "–ª–æ–≤—É—à–∫–∏"
          if (coins[i].y > canvas.height - 100 && coins[i].y < canvas.height) {
            coins[i].caught = true;
            caughtCoins += 100;
            document.getElementById('coinsCaught').textContent = caughtCoins;
          }
        }
      }
      
      // –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –∏–≥—Ä—ã
      function gameLoop() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–µ –º–æ–Ω–µ—Ç—ã
        if (Math.random() < 0.1) {
          coins.push(createCoin());
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏ —Ä–∏—Å—É–µ–º –º–æ–Ω–µ—Ç—ã
        updateCoins();
        coins.forEach(drawCoin);
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è
        checkCollisions();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–π–º–µ—Ä
        if (timeLeft > 0) {
          timeLeft -= 0.01;
          document.getElementById('timeLeft').textContent = Math.ceil(timeLeft);
        } else {
          // –ó–∞–≤–µ—Ä—à–∞–µ–º –∏–≥—Ä—É
          endCoinRainGame();
          return;
        }
        
        requestAnimationFrame(gameLoop);
      }
      
      // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã
      function endCoinRainGame() {
        const winAmount = caughtCoins;
        balance += winAmount;
        updateUI();
        
        document.getElementById('coinRainResultText').textContent = `–í—ã –∑–∞—Ä–∞–±–æ—Ç–∞–ª–∏ ${winAmount} ‚ÇΩ!`;
        document.getElementById('coinRainResult').style.display = 'block';
      }
      
      // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä—É
      gameLoop();
    }

    // –°–∫—Ä—ã—Ç—å –º–∏–Ω–∏-–∏–≥—Ä—É "–î–æ–∂–¥—å –º–æ–Ω–µ—Ç"
    function hideCoinRain() {
      document.getElementById('coinRainOverlay').style.display = 'none';
    }

    // –°–∫—Ä—ã—Ç—å –≤—Å–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
    function hideAllModals() {
      document.querySelectorAll('.modal-bg, .mini-game-overlay').forEach(modal => {
        modal.style.display = 'none';
      });
    }

    // –ó–∞–ø—É—Å–∫ –±–æ—Ç-—á–∞—Ç–∞
    function startBotChat() {
      if (botChatInterval) clearInterval(botChatInterval);
      
      botChatInterval = setInterval(() => {
        updateBotChat();
      }, 5000);
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–æ—Ç-—á–∞—Ç–∞
    function updateBotChat() {
      const chat = document.getElementById('botChat');
      const message = botMessages[Math.floor(Math.random() * botMessages.length)];
      const now = new Date();
      const timeString = now.getHours().toString().padStart(2, '0') + ':' + 
                        now.getMinutes().toString().padStart(2, '0');
      
      chat.innerHTML += `<div class="bot-message">${timeString} ${message}</div>`;
      chat.scrollTop = chat.scrollHeight;
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    window.onload = initGame;
  </script>
</body>
</html>
